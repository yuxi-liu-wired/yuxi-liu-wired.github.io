<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yuxi Liu">
<meta name="dcterms.date" content="2024-04-17">

<title>Yuxi on the Wired - Classical thermodynamics and economics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Yuxi on the Wired - Classical thermodynamics and economics">
<meta property="og:description" content="Two sides of the same coin">
<meta property="og:image" content="https://yuxi-liu-wired.github.io/blog/posts/equilibrium-thermoeconomics/img/blog icon.jpg">
<meta property="og:site_name" content="Yuxi on the Wired">
<meta name="twitter:title" content="Yuxi on the Wired - Classical thermodynamics and economics">
<meta name="twitter:description" content="Two sides of the same coin">
<meta name="twitter:image" content="https://yuxi-liu-wired.github.io/blog/posts/equilibrium-thermoeconomics/img/blog icon.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/favicon.ico" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Yuxi on the Wired</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.qmd"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.qmd"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://bair.berkeley.edu/"> <i class="bi bi-folder-symlink" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yuxi.liu.1995@gmail.com"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Classical thermodynamics and economics</h1>
            <p class="subtitle lead">Two sides of the same coin</p>
                                <div class="quarto-categories">
                <div class="quarto-category">math</div>
                <div class="quarto-category">physics</div>
                <div class="quarto-category">philosophy</div>
                <div class="quarto-category">economics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yuxi Liu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 17, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">April 17, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#quick-reference" id="toc-quick-reference" class="nav-link" data-scroll-target="#quick-reference">Quick reference</a></li>
  <li><a href="#further-readings" id="toc-further-readings" class="nav-link" data-scroll-target="#further-readings">Further readings</a></li>
  </ul></li>
  <li><a href="#what-is-thermodynamics" id="toc-what-is-thermodynamics" class="nav-link" data-scroll-target="#what-is-thermodynamics">What is thermodynamics?</a>
  <ul class="collapse">
  <li><a href="#systems" id="toc-systems" class="nav-link" data-scroll-target="#systems">Systems</a></li>
  <li><a href="#state-space" id="toc-state-space" class="nav-link" data-scroll-target="#state-space">State space</a></li>
  <li><a href="#constraint" id="toc-constraint" class="nav-link" data-scroll-target="#constraint">Constraint</a></li>
  <li><a href="#contacts" id="toc-contacts" class="nav-link" data-scroll-target="#contacts">Contacts</a></li>
  <li><a href="#compound-systems" id="toc-compound-systems" class="nav-link" data-scroll-target="#compound-systems">Compound systems</a></li>
  <li><a href="#equilibrium-virtual-vs-actual-states" id="toc-equilibrium-virtual-vs-actual-states" class="nav-link" data-scroll-target="#equilibrium-virtual-vs-actual-states">Equilibrium, virtual vs actual states</a></li>
  <li><a href="#some-common-misconceptions" id="toc-some-common-misconceptions" class="nav-link" data-scroll-target="#some-common-misconceptions">Some common misconceptions</a></li>
  </ul></li>
  <li><a href="#the-three-laws" id="toc-the-three-laws" class="nav-link" data-scroll-target="#the-three-laws">The three laws</a>
  <ul class="collapse">
  <li><a href="#second-law" id="toc-second-law" class="nav-link" data-scroll-target="#second-law">Second law</a></li>
  <li><a href="#first-law" id="toc-first-law" class="nav-link" data-scroll-target="#first-law">First law</a></li>
  <li><a href="#zeroth-law" id="toc-zeroth-law" class="nav-link" data-scroll-target="#zeroth-law">Zeroth law</a></li>
  <li><a href="#third-law" id="toc-third-law" class="nav-link" data-scroll-target="#third-law">Third law</a></li>
  <li><a href="#an-economic-interpretation" id="toc-an-economic-interpretation" class="nav-link" data-scroll-target="#an-economic-interpretation">An economic interpretation</a></li>
  </ul></li>
  <li><a href="#basic-consequences" id="toc-basic-consequences" class="nav-link" data-scroll-target="#basic-consequences">Basic consequences</a>
  <ul class="collapse">
  <li><a href="#thermodynamic-forcesuction" id="toc-thermodynamic-forcesuction" class="nav-link" data-scroll-target="#thermodynamic-forcesuction">Thermodynamic force/suction</a></li>
  <li><a href="#helmholtz-free-entropy" id="toc-helmholtz-free-entropy" class="nav-link" data-scroll-target="#helmholtz-free-entropy">Helmholtz free entropy</a></li>
  <li><a href="#first-order-phase-transition" id="toc-first-order-phase-transition" class="nav-link" data-scroll-target="#first-order-phase-transition">First-order phase transition</a></li>
  <li><a href="#other-free-energies" id="toc-other-free-energies" class="nav-link" data-scroll-target="#other-free-energies">Other free energies</a></li>
  <li><a href="#maxwell-relations" id="toc-maxwell-relations" class="nav-link" data-scroll-target="#maxwell-relations">Maxwell relations</a></li>
  </ul></li>
  <li><a href="#caratheodorys-thermodynamics" id="toc-caratheodorys-thermodynamics" class="nav-link" data-scroll-target="#caratheodorys-thermodynamics">Caratheodory’s thermodynamics</a>
  <ul class="collapse">
  <li><a href="#entropy-and-temperature" id="toc-entropy-and-temperature" class="nav-link" data-scroll-target="#entropy-and-temperature">Entropy and temperature</a></li>
  <li><a href="#cardinal-and-ordinal-utilities" id="toc-cardinal-and-ordinal-utilities" class="nav-link" data-scroll-target="#cardinal-and-ordinal-utilities">Cardinal and ordinal utilities</a></li>
  <li><a href="#extensive-entropy" id="toc-extensive-entropy" class="nav-link" data-scroll-target="#extensive-entropy">Extensive entropy</a></li>
  </ul></li>
  <li><a href="#geometric-thermodynamics" id="toc-geometric-thermodynamics" class="nav-link" data-scroll-target="#geometric-thermodynamics">Geometric thermodynamics</a>
  <ul class="collapse">
  <li><a href="#contact-geometry" id="toc-contact-geometry" class="nav-link" data-scroll-target="#contact-geometry">Contact geometry</a></li>
  <li><a href="#samuelsons-area-ratio-thermodynamics" id="toc-samuelsons-area-ratio-thermodynamics" class="nav-link" data-scroll-target="#samuelsons-area-ratio-thermodynamics">Samuelson’s area-ratio thermodynamics</a></li>
  <li><a href="#bonus-riemannian-geometry" id="toc-bonus-riemannian-geometry" class="nav-link" data-scroll-target="#bonus-riemannian-geometry">Bonus: Riemannian geometry</a></li>
  </ul></li>
  <li><a href="#equilibrium-chemistry-done-right" id="toc-equilibrium-chemistry-done-right" class="nav-link" data-scroll-target="#equilibrium-chemistry-done-right">Equilibrium chemistry done right</a>
  <ul class="collapse">
  <li><a href="#tragic-backstory" id="toc-tragic-backstory" class="nav-link" data-scroll-target="#tragic-backstory">Tragic backstory</a></li>
  <li><a href="#equilibrium-of-a-single-gas-or-a-single-solution" id="toc-equilibrium-of-a-single-gas-or-a-single-solution" class="nav-link" data-scroll-target="#equilibrium-of-a-single-gas-or-a-single-solution">Equilibrium of a single gas or a single solution</a></li>
  <li><a href="#practical-considerations" id="toc-practical-considerations" class="nav-link" data-scroll-target="#practical-considerations">Practical considerations</a></li>
  </ul></li>
  <li><a href="#phase-equilibrium" id="toc-phase-equilibrium" class="nav-link" data-scroll-target="#phase-equilibrium">Phase equilibrium</a>
  <ul class="collapse">
  <li><a href="#two-phases-of-a-gas-in-equilibrium" id="toc-two-phases-of-a-gas-in-equilibrium" class="nav-link" data-scroll-target="#two-phases-of-a-gas-in-equilibrium">Two phases of a gas in equilibrium</a></li>
  <li><a href="#van-der-waals-gas" id="toc-van-der-waals-gas" class="nav-link" data-scroll-target="#van-der-waals-gas">van der Waals gas</a></li>
  <li><a href="#gibbs-phase-rule" id="toc-gibbs-phase-rule" class="nav-link" data-scroll-target="#gibbs-phase-rule">Gibbs phase rule</a></li>
  <li><a href="#boiling-water" id="toc-boiling-water" class="nav-link" data-scroll-target="#boiling-water">Boiling water</a></li>
  </ul></li>
  
  
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<blockquote class="blockquote">
<p>Even if the capitalist system is to give way to one in which service and not profit shall be the object, there will still be an integral of anticipated utilities to be made a maximum. Since we must find a function which maximizes an integral we must in many cases use the Calculus of Variations. But the problem here transcends the questions of depreciation and useful life, and belongs to the dawning economic theory based on considerations of maximum and minimum which bears to the older theories the relations which the Hamiltonian dynamics and the thermodynamics of entropy bear to their predecessors.</p>
<p><span class="citation" data-cites="hotellingGeneralMathematicalTheory1925">(<a href="#ref-hotellingGeneralMathematicalTheory1925" role="doc-biblioref">Hotelling 1925</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>It is to the economist, the statistician, the philosopher, and to the general reader that I commend the analysis contained herein… mathematics as applied to classical thermodynamics is beautiful: if you can’t see that, you were born color-blind and are to be pitied. Similarly, in all the branches of pure and applied mathematics, the subject of probability is undoubtedly one of the most fascinating.</p>
<p>Paul Samuelson, forward to <span class="citation" data-cites="bicklerInvestmentPortfolioDecisionmaking1974">(<a href="#ref-bicklerInvestmentPortfolioDecisionmaking1974" role="doc-biblioref">Bickler and Samuelson 1974</a>)</span></p>
</blockquote>
<section id="quick-reference" class="level3">
<h3 class="anchored" data-anchor-id="quick-reference">Quick reference</h3>
<ul>
<li><span class="math inline">\(S\)</span>: entropy</li>
<li><span class="math inline">\(U\)</span>: internal energy</li>
<li><span class="math inline">\(V\)</span>: volume</li>
<li><span class="math inline">\(T\)</span>: temperature</li>
<li><span class="math inline">\(\beta = 1/T\)</span>: inverse temperature</li>
<li><span class="math inline">\(N\)</span>: number of particles of a chemical species</li>
<li><span class="math inline">\(n\)</span>: number of moles of a chemical species</li>
<li><span class="math inline">\(\xi\)</span>: extent of reaction</li>
</ul>
<p>And <span class="math inline">\(X\)</span> means “other properties that we are not concerned with”. For example, with an ideal gas trapped in a copper box, its macroscopic state is determined by <span class="math inline">\(U, N, V\)</span>. If we want to focus on <span class="math inline">\(U\)</span>, then we can let <span class="math inline">\(X = (N, V)\)</span>, and write <span class="math inline">\(S = S(U, X)\)</span>. Similarly, for a photon gas in a blackbody chamber, its macroscopic state is determined by <span class="math inline">\(U, V\)</span>, since photons can be created and destroyed on the inner surface of the blackbody chamber. We can then write <span class="math inline">\(S = S(U, X)\)</span>.</p>
<p>Thermodynamics is notorious for having too many partial differentials and coordinate changes. <span class="math inline">\((\partial_{x_1} f)_{x_1, x_2, \dots, x_n}\)</span> means that we lay down a coordinate system defined by <span class="math inline">\(x_1, \dots, x_n\)</span>, then calculate <span class="math inline">\(\partial_{x_1}f\)</span>, fixing the other coordinates constant. In particular, <span class="math inline">\((\partial_{x_1} f)_{x_2, \dots, x_n}\)</span> is likely different from <span class="math inline">\((\partial_{x_1} f)_{x_1, y_2, \dots, y_n}\)</span>.</p>
<p>If in doubt, write down</p>
<p><span class="math display">\[df = \sum_{i=1}^n (\partial_{x_i} f)_{x_1, \dots, x_n} dx_i\]</span></p>
<p>and reason thenceforth.</p>
</section>
<section id="further-readings" class="level3">
<h3 class="anchored" data-anchor-id="further-readings">Further readings</h3>
<ul>
<li><span class="citation" data-cites="pippardElementsClassicalThermodynamics1964">(<a href="#ref-pippardElementsClassicalThermodynamics1964" role="doc-biblioref">Pippard 1964</a>)</span>. Slim, elegant, both mathematical and applied. In the best British tradition of mathematics – think James Maxwell and G. H. Hardy.</li>
<li><span class="citation" data-cites="fermiThermodynamics1956">(<a href="#ref-fermiThermodynamics1956" role="doc-biblioref">Fermi 1956</a>)</span>. The same as above. However, it also covers chemical thermodynamics.</li>
<li><span class="citation" data-cites="lemonsThermodynamicWeirdnessFahrenheit2019">(<a href="#ref-lemonsThermodynamicWeirdnessFahrenheit2019" role="doc-biblioref">Lemons 2019</a>)</span>. A very readable introduction to classical thermodynamics, slim but deep. I finally understood the meaning of the three laws of thermodynamics after reading it. Contains copious historical quotations.</li>
<li><span class="citation" data-cites="lemonsMereThermodynamics2008">(<a href="#ref-lemonsMereThermodynamics2008" role="doc-biblioref">Lemons 2008</a>)</span>. A textbook version of the author’s <span class="citation" data-cites="lemonsThermodynamicWeirdnessFahrenheit2019">(<a href="#ref-lemonsThermodynamicWeirdnessFahrenheit2019" role="doc-biblioref">Lemons 2019</a>)</span>, weaving in history and philosophical contemplation at every turn.</li>
<li><span class="citation" data-cites="carnotReflectionsMotivePower1988">(<a href="#ref-carnotReflectionsMotivePower1988" role="doc-biblioref">Carnot, Clapeyron, and Clausius 1988</a>)</span>. A reprint of the most important papers in thermodynamics published before 1900. Useful to have on hand if you are reading <span class="citation" data-cites="lemonsThermodynamicWeirdnessFahrenheit2019">(<a href="#ref-lemonsThermodynamicWeirdnessFahrenheit2019" role="doc-biblioref">Lemons 2019</a>)</span>.</li>
<li><span class="citation" data-cites="buchdahlConceptsClassicalThermodynamics1966">(<a href="#ref-buchdahlConceptsClassicalThermodynamics1966" role="doc-biblioref">Buchdahl 1966</a>)</span>. A textbook based on Carathéodory’s axiomatic thermodynamics. The notation is ponderous, and the payoff is unclear. I don’t know what is its intended audience – perhaps professional pedants and differential geometers? Nevertheless, if you need to do research in Carathéodory’s axiomatic thermodynamics, I think this is your best bet.</li>
</ul>
</section>
</section>
<section id="what-is-thermodynamics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-is-thermodynamics">What is thermodynamics?</h2>
<p>Both neoclassical economics and classical thermodynamics are about the equilibria of large systems. While a large system is generally hopelessly complicated, almost all the complexity falls away when the system is maximizing a single quantity. Ceaselessly striving to maximize entropy, a complex system sheds its complexity and reaches the pure simplicity of maximal entropy. Ceaselessly striving to maximize profit, a complex company sheds its complexity and reaches the pure simplicity of perfect product.</p>
<p>In both fields, everything we can say about the world are nothing more than about systems, constraints, contacts, and equilibria. Time and change do not exist. All we can explain is which states <em>are</em> in constrained equilibrium, not how a system can <em>get there</em>. Atoms do not exist. All we can explain is what happens to homogeneous substances in constrained equilibrium. People do not exist. All we can explain is what happens to constrained economic systems in equilibrium.</p>
<p>Different things can be maximized: the total entropy, or the negative Gibbs free energy, or the profit, or the sum-total of utility, or something else. Through different lenses, different things are maximized, but they predict the same phenomena. Using this mathematical freedom, experts brachiate around the coordinate axes like gibbons brachiating around vines, looking for the perfect angle to solve each particular problem.</p>
<table class="table">
<caption>Constrained maximization problems in economics and thermodynamics.</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>interpretation</th>
<th>maximized quantity</th>
<th>constraint</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>conglomerate accounting</td>
<td>book value</td>
<td>Assets is conserved, but can be moved between child companies.</td>
</tr>
<tr class="even">
<td>social welfare</td>
<td>social utility</td>
<td>Wealth is conserved, but can be redistributed.</td>
</tr>
<tr class="odd">
<td>closed system</td>
<td>entropy</td>
<td>Quantities are conserved, but can be moved between sub-systems.</td>
</tr>
<tr class="even">
<td>factory production</td>
<td>profit</td>
<td>Some raw materials are on sale at a market, but others are not.</td>
</tr>
<tr class="odd">
<td>consumer choice</td>
<td>utility</td>
<td>Some finished goods are on sale at a market, but others are not. The market uses a commodity money.</td>
</tr>
<tr class="even">
<td>partially open system</td>
<td>negative free energy</td>
<td>Some quantities can be exchanged with a bath, but others are conserved.</td>
</tr>
</tbody>
</table>
<section id="systems" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="systems">Systems</h3>
<p>Systems are the main characters of the drama of thermodynamics. A thermodynamic system is something that is fully determined by a few macroscopic properties, related by equations of state. Once we know enough of its properties, we know all there is to know about such a system. There is nothing left to say about it.</p>
<p><strong>Everything is a thermodynamic system</strong>. However, there are two special types: bath systems, and mechanical systems.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Any number of thermodynamic systems can be connected into a larger system – a <strong>compound system</strong>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Some children are confused when they heard that squares are rectangles too. I hope you won’t be equally confused when you heard that mechanical systems are also thermodynamic systems.</p></div></div><p>The prototypical thermodynamic system is a tank of ideal gas whose number of particles is fixed. It has 2 degrees of freedom, so if we write down <span class="math inline">\(n\)</span> different macroscopic properties, they would (generically) be related by <span class="math inline">\(n-2\)</span> equations of state. So for example, if we write down the properties internal energy <span class="math inline">\(U\)</span>, temperature <span class="math inline">\(T\)</span>, volume <span class="math inline">\(V\)</span>, pressure <span class="math inline">\(P\)</span>, they would be related by the 2 equations of state</p>
<p><span class="math display">\[PV = k_BNT, \quad U = \frac 32 k_B NT\]</span></p>
<p>If we know two out of the four of internal energy <span class="math inline">\(U\)</span>, temperature <span class="math inline">\(T\)</span>, volume <span class="math inline">\(V\)</span>, pressure <span class="math inline">\(P\)</span>, then we can solve for all the others by equations of state. The macroscopic properties fully describe the system, and nothing more can be said about it. We cannot ask more questions such as “Are there more particles on the left than on the right?” or “How long did it take for the system to reach equilibrium?”, because such questions are literally <em>undefined</em> in classical thermodynamics.</p>
<p>Because the properties are related by equations of state, we need only know a few of the properties in order to infer all the rest. For example, knowing the volume <span class="math inline">\(V\)</span>, internal energy <span class="math inline">\(U\)</span>, and particle number <span class="math inline">\(N\)</span>, of a tank of ideal gas, we can infer that its pressure is <span class="math inline">\(P = \frac{2U}{3V}\)</span>, and its temperature is <span class="math inline">\(T = PV/k_BN\)</span>. Succinctly,</p>
<p><span class="math display">\[P = P(U, V, N), \quad T = T(U, V, N)\]</span></p>
<p>meaning “If we know <span class="math inline">\(U, V, N\)</span>, then we can calculate <span class="math inline">\(P\)</span> and <span class="math inline">\(T\)</span>”.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s too easy to misread it as saying that <span class="math inline">\(P\)</span> <em>is</em> a mathematical function of <span class="math inline">\(U, V, N\)</span>. It is not. It really is saying that, there exists a mathematical function <span class="math inline">\(f_P\)</span>, such that for any state <span class="math inline">\(\omega\)</span> of the system, we have</p>
<p><span class="math display">\[P(\omega) = f_P(U(\omega), V(\omega), N(\omega))\]</span></p>
</div>
</div>
<p>Everything about a thermodynamical system is known once we specify how its entropy is a function of its macroscopic properties. For example, the ideal gas is fully specified by</p>
<p><span class="math display">\[S(U, V, N) = k_B N \ln\left[\frac{V}{N}\,\left(\frac{U}{\hat{c}_V k_B N}\right)^{\hat{c}_V}\,\frac{1}{\Phi}\right]\]</span></p>
<p>where <span class="math inline">\(\hat c_V\)</span> and <span class="math inline">\(\Phi\)</span> are constants that differ for each gas.</p>
<p>As another example, the photon gas is defined by</p>
<p><span class="math display">\[S(U, V) = C V^{1/4}U^{3/4}, \quad C=\left(\frac{256\pi^2 k_B^4}{1215 c^3 \hbar^3}\right)^{1/4}\]</span></p>
<p>The fact that <span class="math inline">\(S(U, V) \propto V^{1/4}U^{3/4}\)</span> can be derived from 19th-century physics (and indeed, it was known to Boltzmann), but the constant <span class="math inline">\(C\)</span> has to wait for proper quantum mechanics.</p>
<section id="baths" class="level4">
<h4 class="anchored" data-anchor-id="baths">Baths</h4>
<p>A <strong>bath system</strong> is a thermodynamic system with nonzero entropy function, but infinitely large size.</p>
<p>For example, if we take a copper piston and fill it with ideal gas, then immerse the piston in the bottom of an ocean, then it is a <em>volume-and-energy bath</em> with constant pressure-and-temperature. If we cover up the piston with some insulating material, then the ocean suddenly becomes merely a volume bath with constant pressure. If we use screws to fix the piston head, then the ocean suddenly becomes merely an energy bath with constant temperature.</p>
<p>Because they are infinitely large, if you connect two baths together, something bad will happen. For example, if you connect two energy baths together, but with different temperature, what would happen? The simple answer is: “A torrent of heat will flow from the hotter to the colder bath.” The more correct answer is: “Classical thermodynamics does not allow such a question to be asked. It would be like asking what happens when ‘an unstoppable force meets an immovable object’. If we literally have two baths, then we cannot connect them. If we only have two giant oceans that seem like baths when compared to this little tank of gas, then if the two oceans are connected to each other, they will no longer appear as baths to each other.”</p>
<p>A heat bath, or more accurately an energy bath, is a system that you can take or dump as much energy as you want, always at constant marginal price of energy. An atmosphere, or more accurately an energy-and-volume bath, is a system that you can take or dump as much energy or volume as you want, always at constant temperature and pressure. In general, a bath is an infinite source of a conserved quantity at constant marginal entropy. We can imagine other forms of baths. For example, the surface of a lake could serve as an energy-and-area bath. A large block of salt can serve as a salt-chemical bath.</p>
</section>
<section id="mechanical-systems" class="level4">
<h4 class="anchored" data-anchor-id="mechanical-systems">Mechanical systems</h4>
<p>A <strong>mechanical system</strong> is a thermodynamic system whose entropy is always zero. Essentially all systems studied in classical mechanics are such systems. In classical thermodynamics, they are not put center-stage, but if you know where to look, you will see them everywhere.</p>
<p>An ideal linear-spring has two macroscopic properties: length <span class="math inline">\(x\)</span> and internal energy <span class="math inline">\(U\)</span>, with equation of state <span class="math inline">\(U = \frac 12kx^2\)</span>. For example, a helix spring is close to an ideal linear-spring.</p>
<p>An ideal surface-spring is the same as an ideal linear-spring, but with area <span class="math inline">\(A\)</span> instead of length <span class="math inline">\(x\)</span>. Its equation of state is <span class="math inline">\(U = \sigma A\)</span>, where <span class="math inline">\(\sigma\)</span> is surface tension constant. For example, a balloon skin is close to an ideal surface-spring.</p>
<p>An ideal volume-spring is similar. It would resemble a lump of jelly. An ideal gas, though it looks like a volume-spring, is not an example, because its entropy is not zero. In particular, this means an ideal gas has temperature and can be “heated up”, but a lump of ideal jelly cannot.</p>
<p>In general, we can construct an arbitrary energy storage system, such that it has two macroscopic properties <span class="math inline">\(x, U\)</span>, satisfying <span class="math inline">\(U = f(x)\)</span>, where <span class="math inline">\(f\)</span> is any differentiable function. We can imagine taking a mystery box with a chain we can pull on, and by some internal construction with gears, pulleys, weights, and springs, the force on the chain is <span class="math inline">\(f'(x)\)</span>, where <span class="math inline">\(x\)</span> is the length by which we have pulled.</p>
</section>
</section>
<section id="state-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="state-space">State space</h3>
<p>A tank of gas has on the order of <span class="math inline">\(10^{26}\)</span> particles, but in classical thermodynamics, its state is entirely determined if we know its <span class="math inline">\(U, V, N\)</span>. In this sense, we can say that its macroscopic state space has just 3 dimensions. In many situations, such as in the Carnot heat engine, we also fix its <span class="math inline">\(N\)</span>, in which case its state space has just 2 dimensions.</p>
<p>This is typically plotted in either the <span class="math inline">\((P, V)\)</span> space, or the <span class="math inline">\((T, S)\)</span> space, or some other spaces, but in every case, there are just two dimensions. We can unify all these diagrams as merely different viewpoints upon the same curvy surface – the state space <span class="math inline">\(\mathcal X\)</span> itself. Each point <span class="math inline">\(\omega \in \mathcal X\)</span> in the state space is a state, and each macroscopic property <span class="math inline">\(X\)</span> is a scalar function of type <span class="math inline">\(X : \mathcal X \to \R\)</span>.</p>
<p>If the state space has just <span class="math inline">\(d\)</span> dimensions, then we need only <span class="math inline">\(d\)</span> macroscopic properties <span class="math inline">\(X_1, \dots, X_d\)</span> in order to lay down a coordinate system for the state space. If we have another macroscopic property <span class="math inline">\(Y\)</span>, then there in general exists a function <span class="math inline">\(f_Y: \R^d \to \R\)</span>, such that <span class="math inline">\(Y(\omega) = f_Y(X_1(\omega), \dots, X_d(\omega))\)</span> for any state <span class="math inline">\(\omega\)</span>. In other words, we have an <strong>equation of state</strong>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/thermodynamic_state_manifold.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The state space for a thermodynamic system with 2 degrees of freedom. If we lay down three macroscopic properties, then they satisfy one equation of state.</figcaption>
</figure>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Based on the following diagram, prove that if we have three scalar functions <span class="math inline">\(x, y, z\)</span> on a smooth 2D surface, then <span class="math inline">\(\left(\frac{\partial x}{\partial z}\right)_y\left(\frac{\partial y}{\partial x}\right)_z\left(\frac{\partial z}{\partial y}\right)_x = -1\)</span>. Generalize this to higher dimensions.</p>
<p><img src="figure/constraint_partial_derivatives.jpg" class="img-fluid"></p>
</div>
</section>
<section id="constraint" class="level3">
<h3 class="anchored" data-anchor-id="constraint">Constraint</h3>
<p>A <strong>constraint</strong> is an equation of form <span class="math inline">\(f(A, B, C, \dots) = f_0\)</span>, where <span class="math inline">\(f\)</span> is a mathematical function, <span class="math inline">\(A, B, C, \dots\)</span> are macroscopic properties, and <span class="math inline">\(f_0\)</span> is a constant.</p>
<p>For example, if we have two tanks of gas in thermal contact, then the constraint is as follows:</p>
<p><span class="math display">\[
\begin{cases}
V_1 &amp;= V_{1,0} \\
V_2 &amp;= V_{2,0} \\
U_1 + U_2 &amp;= U_{1,0} + U_{2,0} \\
\end{cases}
\]</span></p>
<p>meaning that the volume of each tank of gas is conserved, and the sum of their energy is also conserved.</p>
<p>The constraints on a compound system are determined by the contacts between its subsystems.</p>
</section>
<section id="contacts" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="contacts">Contacts</h3>
<p>If we only have systems isolated in a perfect vacuum, then nothing interesting will happen. If two systems are perfectly connected, then they will never be brought apart. A contact allows two systems to interact, without destroying their individuality. It allows two systems to communicate, without becoming literally one system. Economically, contacts are trade contracts.</p>
<p>In general, the effect of a contact is to reduce the number of constraints by one. For example, a metal rod between two pistons reduces the two constraints</p>
<p><span class="math display">\[V_1 = V_{1,0}, \quad V_2 = V_{2, 0}\]</span></p>
<p>into one constraint: <span class="math display">\[V_1 + V_2 = V_{1,0} + V_{2,0}\]</span></p>
<p>As another example, in a tank of three kinds of gas <span class="math inline">\(N_2, H_2, NH_3\)</span>, allowing a single chemical reaction <span class="math inline">\(N_2 + 3H_2 \rightleftharpoons 2NH_3\)</span> reduces three constraints</p>
<p><span class="math display">\[
N_{N_2} = N_{N_2, 0}, \quad N_{H_2} = N_{H_2, 0}, \quad N_{NH_3}= N_{NH_3, 0}
\]</span></p>
<p>into two:</p>
<p><span class="math display">\[
N_{N_2} - N_{N_2, 0} = (N_{H_2} - N_{H_2, 0})/3, \quad N_{N_2} - N_{N_2, 0} = (N_{NH_3} - N_{NH_3, 0})/2
\]</span></p>
<p>A contact can be nonlinear. For example, if we have two pistons of the same area, connected by a lever, such that pushing on one piston by <span class="math inline">\(\Delta x\)</span> would be pulling on the other piston by <span class="math inline">\(2 \Delta x\)</span>, then the constraint becomes <span class="math inline">\(2(V_1 - V_{1,0}) + (V_2 - V_{2,0}) = 0\)</span>. And by designing a series of levers, gears, and chains, we can realize any constraint function <span class="math inline">\(f(V_1, V_2) = f(V_{1,0}, V_{2,0})\)</span> for any smooth function <span class="math inline">\(f\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/arbitrary_mechanical_system.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">A thermodynamical system (a piston of gas) is connected to a mechanical system (a mass in gravity) via an arbitrary constraint (variable gears).</figcaption>
</figure>
</div>
</section>
<section id="compound-systems" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="compound-systems">Compound systems</h3>
<p>A compound system is nothing more than several systems connected. If we know the connections, and the entropy function of each subsystem, then we know everything about the compound system. The number of DOF for the compound system is the sum of the DOF of the subsystems, minus the degree of constraints.</p>
<p>For example, in the adiabatic expansion of a tank of ideal gas, we are really studying one compound system made of:</p>
<ul>
<li>a tank of ideal gas (thermodynamic system),</li>
<li>a lump of mass in gravity (mechanical system),</li>
<li>with a gear system between them (contact).</li>
</ul>
<p>The gear system is designed with gear-ratio that varies as the system turns, in just the right way such that the system is always in equilibrium no matter the position of the piston, so that it really has no preference of going forwards or backwards.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/arbitrary_mechanical_system.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The compound system. Inside it, there is a subsystem of a tank of ideal gas that undergoes adiabatic expansion.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Only one system">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only one system
</div>
</div>
<div class="callout-body-container callout-body">
<p>We typically think of the tank of ideal gas itself as part of the thermodynamics, and the other parts as “the environment”, but we should properly speaking consider one single compound system, of which the tank of ideal gas is merely a sub-system. This way, we can state directly that the entropy of the entire compound system is maximized.</p>
</div>
</div>
<div id="exm-0" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (heat-engine-and-environment compound system)</strong></span> A heat engine is a thermodynamic system that is used as a component of a larger compound system. The large system contains 4 parts: two energy baths, one heat engine, and one carefully designed mechanical system acting as energy storage.</p>
<p>If you only want a heat engine that works, then the energy storage does not need to be carefully designed. However, if you want a Carnot heat engine, i.e.&nbsp;at maximal efficiency, then the energy storage must be designed to be exactly right. It must be designed to follow the exact parameters of the heat engine, as well as the two energy baths’ temperatures. If any of those is ignored, the energy storage would fail to “mesh” with the rest of the compound system, and cause waste.</p>
<p>This is why a heat engine must be a component of a larger <em>compound system</em>. Every part of it depends on every other part. The energy storage unit is just as important and precisely designed as the heat engine.</p>
</div>
</section>
<section id="equilibrium-virtual-vs-actual-states" class="level3">
<h3 class="anchored" data-anchor-id="equilibrium-virtual-vs-actual-states">Equilibrium, virtual vs actual states</h3>
<blockquote class="blockquote">
<p>Freedom is an iron cage.</p>
<p>Constraints set it free again.</p>
</blockquote>
<p>On the African savannah there lived a bunch of meerkats. Meerkats love to stand on the tallest place.</p>
<p>At first, they could stand wherever they wanted, so they all stood on one single hill. It was crowded. A blind lion who had memorized the landscape came and ate all of them.</p>
<p>Then humans came and added long walls that divided the savannah into thin stripes. Now each meerkat’s location is determined by which stripe it happened to fall in. The blind lion could find the meerkat if he knew the stripe location. In other words, optimizing for height, when there is one constraint, leads to one dimension of uncertainty.</p>
<p>This is a subtle point, so I will say it again. If you want to optimize for a quantity, and you don’t have a constraint, then you would always go to the globally best solution. The whole space of possibilities is open to you, but you don’t need them. Those states are “virtual” because they are never observed, even though their existence is inferrable.</p>
<p>But if you have one constraint, then you have one unique solution for each possible setting of constraint. You are still not free, but at least now you have a puppet master.</p>
<p>In classical thermodynamics, only equilibrium states are “real”. Nonequilibrium states are “virtual”. In Lagrangian mechanics, only stationary-action paths are real, and the other paths are virtual. You can imagine that if you throw a rock upwards, it would execute a complex figure-8 motion before returning to ground again, but that’s a virtual path. The only real path is the unique virtual path that stationarizes the action integral.</p>
<p>Similarly, in classical thermodynamics, you could imagine that a tank of gas contains all its gas on the left side. Its entropy is just <span class="math inline">\(S(U, V/2, N)\)</span>, but that’s a virtual state that does not satisfy maximize entropy under constraint. The unique entropy-maximizing virtual state is the real state.</p>
<p>For every constraint, there are many nonequilibrium states that satisfy the constraint, but only one equilibrium entropy, and so equilibrium entropy is a function of constraints, even though the entropy function itself is not. It optimizes all its complexities away, allowing us to know it through just its external constraints.</p>
</section>
<section id="some-common-misconceptions" class="level3">
<h3 class="anchored" data-anchor-id="some-common-misconceptions">Some common misconceptions</h3>
<p>Thermodynamics is not statistical mechanics. Forget about molecules and atoms. Forget about statistics and statistical mechanics. Forget about <span class="math inline">\(S = k_B\ln \Omega\)</span> or <span class="math inline">\(S = -\sum_i p_i \ln p_i\)</span>. <strong>Randomness does not exist</strong> in classical thermodynamics.</p>
<p>Forget about the first law of thermodynamics. <strong>Energy is nothing special.</strong> The conservation of energy is no more important than the conservation of volume, or the conservation of charge.</p>
<p>Forget about heat. <strong>Heat does not exist</strong> – it is not a noun, not even an adjective, but an adverb at most. The theory of caloric has already been disproven in the 19th century by the cannon-boring experiment.</p>
<p>Heat energy and work energy are both misnomers. Neither are types of energy. Instead, they are types of energy-flow. We should speak of only heat energy-flow and work energy-flow.</p>
<p>To perform work, one must perform work <em>upon</em> something. In other words, there is no such thing as “system A performed work”. There is really “some energy and length is traded between A to B in compliance with a work-equation-constraint”.</p>
<p>Forget about time. <strong>Time does not exist</strong> in classical thermodynamics. We can say nothing at all about what happens between equilibria. We can only say, “This is an equilibrium, but that is not an equilibrium. There is nothing at all to say about what happens between them.</p>
<p>The name “thermodynamics” is a complete misnomer, because heat does not exist (thus no “thermo-”) and time does not exist (thus no “-dynamics). It should be called”entropo-statics”.</p>
<p>If time does not exist, you ask, what do we mean when we study Joule expansion? That is, when we take half a tank of gas, and suddenly open the middle wall and wait until the gas equilibrates in the entire gas?</p>
<p>In fact, we did not open the middle wall. We did not wait. Gas did not expand. The past did not cause the future. Time is an stubbornly persistent illusion, and causality is illusory too.</p>
<p>In fact, we are considering two different problems in thermodynamics.</p>
<p>First problem: Given a tank of gas with internal energy <span class="math inline">\(U = U_0\)</span>, molar-amount <span class="math inline">\(n = n_0\)</span>, and constraint <span class="math inline">\(V \leq \frac 12 V_0\)</span>. What is its equilibrium state? Answer: The state that maximizes entropy under the constraints: <span class="math display">\[
\begin{cases}
\max S(U, n, V) \\
V \leq \frac 12 V_0 \\
U = U_0 \\
n = n_0
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(S(U, n, V)\)</span> is the entropy of the gas when its states properties are <span class="math inline">\(U, n, V\)</span>.</p>
<p>Similarly, the second problem is another constraint-optimization problem: <span class="math display">\[
\begin{cases}
\max S(U, n, V) \\
V \leq V_0 \\
U = U_0 \\
n = n_0
\end{cases}
\]</span></p>
<p>That the two different problems seem to “follow one from another” is an illusion. In reality, they only appear to follow one another because this is what we observe in the real world, where one equilibrium follows another. In equilibrium thermodynamics, equilibria do not follow one another – everyone stands alone.</p>
<p>Time only appears in the following sense: We observe a real-world system, like a car engine, and notice that its motion seems to consist of a sequence of equilibria. Keeping those almost-equilibria in mind, we delve into the ocean of classical thermodynamics, until we have found some equilibria that resemble the almost-equilibria we have in mind. And so, from the bottom of the ocean, we pick up one equilibrium, then another, then another. Then we string together these little equilibria along a number line like a pearl necklace. We run our fingers over these pearls, and delight in its “motion”, like flipping the pages of a stop-motion book and shouting, “Look, it is moving!”.</p>
</section>
</section>
<section id="the-three-laws" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-three-laws">The three laws</h2>
<p>More accurately: one law and two non-laws.</p>
<section id="second-law" class="level3">
<h3 class="anchored" data-anchor-id="second-law">Second law</h3>
<blockquote class="blockquote">
<p>For the equilibrium of any isolated system it is necessary and sufficient that in all possible variations of the state of the systems which do not alter its energy, the variation of its entropy shall either vanish or be negative.</p>
<p><span class="citation" data-cites="gibbsEquilibriumHeterogeneousSubstances1878">(<a href="#ref-gibbsEquilibriumHeterogeneousSubstances1878" role="doc-biblioref">Gibbs 1878</a>)</span></p>
</blockquote>
<p>The second law of thermodynamics is all important: maximizing entropy is all of classical thermodynamics. All other parts are just tricks for maximizing entropy.</p>
</section>
<section id="first-law" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="first-law">First law</h3>
<blockquote class="blockquote">
<p>As a student, I read with advantage a small book by F. Wald entitled “The Mistress of the World and her Shadow”. These meant energy and entropy. In the course of advancing knowledge the two seem to me to have exchanged places. In the huge manufactory of natural processes, the principle of entropy occupies the position of manager, for it dictates the manner and method of the whole business, whilst the principle of energy merely does the book- keeping, balancing credits and debits.</p>
<p><span class="citation" data-cites="emdenWhyWeHave1938">(<a href="#ref-emdenWhyWeHave1938" role="doc-biblioref">Emden 1938</a>)</span></p>
</blockquote>
<p>The first law of thermodynamics is entirely trivial. Energy is <em>nothing special</em>! Energy is <em>just</em> a conserved quantity, one among equals, much like volume, mass, and many other things… Every conserved quantity is equally conserved,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> so it does not deserve a special thermodynamic law. You might as well say “conservation of mass” is “the second-first law of thermodynamics” and “conservation of volume” is “the third-first law of thermodynamics”, and “conservation of electrons” and “conservation of protons” and “conservation of length” (if you are studying a thermodynamic system restricted to move on a line) and “conservation of area” (if you are studying a thermodynamic system restricted on the surface of a lake) and so on…</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;The first law of thermodynamics had always struck me as oddly out of place, almost like a joke that I could not catch, like</p>
<blockquote class="blockquote">
<p>All animals are equal, but some animals are more equal than others</p>
</blockquote>
<p>but with</p>
<blockquote class="blockquote">
<p>All conserved quantities are conserved, but some quantities are more conserved than others.</p>
</blockquote>
<p>I kept waiting for the textbooks, or the teachers, or someone, to drop the act and confess, “Actually, we were joking – conservation of energy really is not that special, and we were just bored with standard physics and wanted to confuse you with a cute magic trick before showing you what standard physics really is saying.”. Slowly, I realized that there is no joke – conservation of energy is unironically treated as special by not just the students, but even the teachers. I had to figure out for myself how the joke really works, and it required me to rebuild thermodynamics along my preferences.</p></div></div><p>This sounds extraordinary, but that is merely how classical thermodynamics works. The first law of thermodynamics does not deserve its title. It should be demoted to an experimental fact, not a law. Just to drive the point home, I wrote an entire <a href="#sec-stereodynamics">sci-fi worldbuilding sketch</a> about an alien species, for which it is the conservation of volume that is fundamental, not energy, and which discovered stereodynamics. If you can laugh at their mistaken importance of the conservation of volume, maybe you can laugh at the mistaken importance of the conservation of energy too.</p>
<p>The proper place for the law of conservation of energy is not classical thermodynamics, but general physics, because energy is nothing special inside classical thermodynamics, but it is extremely special if we zoom out to consider the whole of physics. Whereas in classical thermodynamics, systems conserve energy, and volume, and mass, and electron-number, and proton-number, and… when you move outside of thermodynamics, such as when you add in electrodynamics, special relativity, and quantum mechanics, all kinds of conservations breakdown. You don’t have conservation of mass, or number of electrons, or even volume, but energy is always conserved.</p>
</section>
<section id="zeroth-law" class="level3">
<h3 class="anchored" data-anchor-id="zeroth-law">Zeroth law</h3>
<p>Now that the first law has been dispelled, we can dispel the zeroth law of thermodynamics, too. If Energy falls from grace, so must its shadow, Temperature.</p>
<div id="thm-zeroth-law" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (general zeroth law)</strong></span> If <span class="math inline">\(S_1(X_1, Y) + S_(X_2, Y)\)</span> is maximized under constraint <span class="math inline">\(X_1 + X_2 = X\)</span>, then <span class="math inline">\((\partial_X S_1)_Y = (\partial_X S_2)_Y\)</span>.</p>
</div>
<table class="table">
<caption>The zeroth law of thermodynamics in various guises.</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>maximized quantity <span class="math inline">\(S\)</span></th>
<th>conserved quantity <span class="math inline">\(X\)</span></th>
<th>derivative <span class="math inline">\((\partial_X S)_Y\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>entropy</td>
<td>energy</td>
<td>inverse temperature <span class="math inline">\(\beta\)</span></td>
</tr>
<tr class="even">
<td>entropy</td>
<td>volume</td>
<td><span class="math inline">\(\beta P\)</span></td>
</tr>
<tr class="odd">
<td>entropy</td>
<td>particles</td>
<td><span class="math inline">\(-\beta \mu\)</span>, where <span class="math inline">\(\mu\)</span> is chemical potential</td>
</tr>
<tr class="even">
<td>entropy</td>
<td>surface area</td>
<td><span class="math inline">\(-\beta\sigma\)</span>, where <span class="math inline">\(\sigma\)</span> is surface tension</td>
</tr>
<tr class="odd">
<td>production value</td>
<td>raw material</td>
<td>marginal value</td>
</tr>
</tbody>
</table>
</section>
<section id="third-law" class="level3">
<h3 class="anchored" data-anchor-id="third-law">Third law</h3>
<p>The third law is rarely if ever used in classical thermodynamics, and its precise meaning is still unclear. It seems to me that its proper place is not thermodynamics, but quantum statistical mechanics, where it states that a substance, when at the lowest possible energy (ground state), has finite entropy – Einstein’s formulation of the third law. <span class="citation" data-cites="klimenkoTeachingThirdLaw2012">(<a href="#ref-klimenkoTeachingThirdLaw2012" role="doc-biblioref">Klimenko 2012</a>)</span></p>
</section>
<section id="an-economic-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="an-economic-interpretation">An economic interpretation</h3>
<p>Here is an economic interpretation of classical thermodynamics. There are other possible interpretations, and we will use the others in this essay.</p>
<p>In this interpretation, the laws of nature become the CEO of a company. Every conserved quantity is a commodity. The company has some commodity. Commodities themselves have no intrinsic value. Instead, the company is valued by a certain accounting agency. The CEO’s job is to move around the commodities so that the accounting agency gives it the highest book-value.</p>
<p>A compound system is a <em>conglomerate company</em>: a giant company made of little companies. If entropy is extensive, then it means the total book-value for the conglomerate is the sum of the book-value of each subsidiary company. Otherwise, entropy is nonextensive, and the accounting agency believes that the conglomerate has <a href="https://en.wikipedia.org/wiki/Corporate_synergy"><em>corporate synergy</em></a>.</p>
<p>The inverse temperature <span class="math inline">\(\beta\)</span> is the marginal value of energy:</p>
<p><span class="math display">\[\beta = \frac{d(\text{value of a sub-company})}{d(\text{energy owned by the sub-company})}\]</span></p>
<p>The pressure <span class="math inline">\(P\)</span>, multiplied by <span class="math inline">\(\beta\)</span>, is the marginal value of space:</p>
<p><span class="math display">\[\beta P = \frac{d(\text{value of a sub-company})}{d(\text{volume owned by the sub-company})}\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It might appear odd to write <span class="math inline">\(\beta P\)</span>, but in the entropy-centric view of thermodynamics, it is the quantity <span class="math inline">\(\beta P\)</span> that is fundamental, and in comparison, the pressure <span class="math inline">\(P\)</span> is less fundamental, as a ratio <span class="math inline">\(P := \frac{\beta P}{\beta}\)</span>. Why, then, do we speak of pressure <span class="math inline">\(P\)</span> and temperature <span class="math inline">\(T\)</span>, instead of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\beta P\)</span>? It is because classical thermodynamics is traditionally understood as energy-centric.</p>
</div>
</div>
</section>
</section>
<section id="basic-consequences" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="basic-consequences">Basic consequences</h2>
<section id="thermodynamic-forcesuction" class="level3">
<h3 class="anchored" data-anchor-id="thermodynamic-forcesuction">Thermodynamic force/suction</h3>
<p>Since nature is entropy-maximizing, if entropy can be increased by moving some energy from one system to another, it will happen. Similarly for space. It would seem as if there is a <strong>thermodynamic suction</strong> that is sucking on on energy, and the side with the higher thermodynamic suction tends to absorb it.</p>
<p><span class="math display">\[
\text{thermodynamic suction of $X$} = \left(\frac{\partial S}{\partial X}\right)_{\text{non-}X}
\]</span></p>
<p>In energy-centric thermodynamics, we use <strong>thermodynamic force</strong>, or <strong>thermodynamic potential</strong>, defined by</p>
<p><span class="math display">\[
\text{thermodynamic force of $X$} = -\frac{\left(\frac{\partial S}{\partial X}\right)_{\text{non-}X}}{\left(\frac{\partial S}{\partial U}\right)_{\text{non-}U}}
\]</span></p>
<p>For example, for a tank of gas, the macroscopic properties are <span class="math inline">\(U, V, N\)</span>, and so it has three thermodynamic suctions:</p>
<p><span class="math display">\[
\begin{aligned}
  \beta &amp;= (\partial_U S)_{V, N}\\
  \beta P &amp;= (\partial_V S)_{U, N}\\
  -\beta \mu &amp;= (\partial_N S)_{U, V}
\end{aligned}
\]</span></p>
<p>and the thermodynamic forces associated with <span class="math inline">\(V, N\)</span> are <span class="math inline">\(P\)</span> and <span class="math inline">\(-\mu\)</span>.</p>
<p>Unfortunately, the notations for thermodynamic suctions are far from elegant. The first one, <span class="math inline">\(\beta\)</span>, is the inverse of temperature.. The second one, <span class="math inline">\(\beta P\)</span>, is <span class="math inline">\(\beta\)</span> multiplied by pressure. The third one is truly the most annoying, as it not only involves <span class="math inline">\(\beta\)</span>, but also a negative sign. To see how the notation came about, we can write it out in differential form:</p>
<p><span class="math display">\[dS = \beta dU + \beta P dV - \beta \mu dN\]</span></p>
<p>Conventional notations are energy-centric, so we rewrite it to single out <span class="math inline">\(dU\)</span>:</p>
<p><span class="math display">\[
dU = TdS + (- PdV) + \mu dN
\]</span></p>
<p>Now we see how the notation came about: <span class="math inline">\(TdS\)</span> is the heat energy-flow into the system, <span class="math inline">\(-PdV\)</span> is the mechanical work energy-flow into the system, and <span class="math inline">\(\mu dN\)</span> is the chemical energy-flow into the system.</p>
<p>If I could truly reform notation, I would redefine <span class="math inline">\(\beta P\)</span> as <span class="math inline">\(p_V\)</span>, meaning “the price of volume”, meaning “the price of particle”, and so on. In this notation, we have:</p>
<p><span class="math display">\[
\begin{aligned}
dS &amp;= p_U dU + p_V dV + p_N dN \\
dU &amp;= p_U^{-1}dS - \frac{p_V}{p_U}dV - \frac{p_N}{p_U}dN
\end{aligned}
\]</span></p>
<div id="exm-0" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (photon gas with <span class="math inline">\(\mu = 0\)</span>)</strong></span> Suppose we have a piston chamber, with its inner surface covered with silver, and there is a tiny speck of blackbody inside it, then the chamber would be filled with bouncing photons, in the form of a “photon gas”. The photons would reflect off the surface of the chamber, some absorbed and some emitted in turn, by the blackbody.</p>
<p>As usual for gas, the state of the system is determined by its internal energy, volume, and particle number: <span class="math inline">\(U, V, N\)</span>, with</p>
<p><span class="math display">\[dS = \beta dU + \beta PdV - \beta \mu dN\]</span></p>
<p>However, the photon gas is quite special, in that photons can be created and destroyed by the speck of blackbody, so at equilibrium, we must have <span class="math inline">\(\beta\mu = 0\)</span>, for otherwise, the system would be able to increase in entropy simply by creating/destroying more photons, and thus it is not in equilibrium.</p>
<p>This contrasts with the typical case with chemical gases like oxygen, where the particle number in a reaction chamber is constant, allowing <span class="math inline">\(\mu \neq 0\)</span> even at equilibrium.</p>
</div>
</section>
<section id="helmholtz-free-entropy" class="level3">
<h3 class="anchored" data-anchor-id="helmholtz-free-entropy">Helmholtz free entropy</h3>
<p>When we have a small system connected to a large system, while we can solve its equilibria by maximizing the plain old entropy for the full compound system, it is often easier conceptually to define a “free entropy” for the small system, and treat the large system as a bath. This is similar to how one can solve for the motion of a cannonball on earth by describing a constant gravitational acceleration, even though we can could have solved for the full cannonball-earth two-body system.</p>
<div id="def-helmholtz" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1 (Helmholtz free entropy)</strong></span> The <strong>Helmholtz free entropy</strong> is the convex dual of entropy with respect to energy:</p>
<p><span id="eq-Helmholtz-S"><span class="math display">\[
f(\beta, X) = \max_U [S(U, X) - \beta U]
\tag{1}\]</span></span></p>
<p>where <span class="math inline">\(U\)</span> is its internal energy, and <span class="math inline">\(X\)</span> are some other macroscopic properties.</p>
<p>Of historical importance is the <strong>Helmholtz free energy</strong> <span class="math inline">\(F := - T f\)</span>, or equivalently,</p>
<p><span id="eq-Helmholtz-U"><span class="math display">\[
F = \min_U [U - TS(U, X)]
\tag{2}\]</span></span></p>
</div>
<div id="thm-helmholtz-free-entropy" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (maximize Helmholtz free entropy)</strong></span> If a thermodynamic system is in energy-contact with an energy bath with price <span class="math inline">\(\beta\)</span>, and is held under constraint on the state by <span class="math inline">\(C(X) = 0\)</span>, then the system equilibrates at</p>
<p><span class="math display">\[
\begin{cases}
\max_{U, X} [S(U, X) - \beta U] = \max_{X} f(\beta, X)\\
C(X) = 0
\end{cases}
\]</span></p>
<p>That is, the system always equilibrates at the maximal Helmholtz free entropy state that satisfies the constraint.</p>
<p>Equivalently, the system minimizes its Helmholtz free energy under constraint.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>If we prove the case for Helmholtz free entropy, then multiplying it by <span class="math inline">\(-T\)</span>, we find that the system minimizes its Helmholtz free energy under constraint. So it remains to prove the case for Helmholtz free entropy.</p>
<p>We prove the case where there is no constraint on the state of the system. The proof for the case with constraint is similar.</p>
<p>Suppose the system starts out at <span class="math inline">\(\beta, U_0, X\)</span>. Then the equilibrium condition is</p>
<p><span class="math display">\[
\begin{cases}
\max (S_{bath} + S) \\
U_{bath} + U = U_{bath, 0} + U_{0}
\end{cases}
\]</span></p>
<p>The entropy of the bath is</p>
<p><span class="math display">\[S_{bath} = S_{bath, 0} + \beta Q\]</span></p>
<p>where <span class="math inline">\(Q = U_{bath} - U_{bath, 0}\)</span> is the amount of energy received by the bath as heat.</p>
<p>Plugging this back, the equilibrium condition simplifies to</p>
<p><span class="math display">\[
\max_U [\beta (U_0 - U) + S(\beta, U, X)]
\]</span></p>
<p>which is the desired result.</p>
</div>
</div>
</div>
<div id="thm-helmholtz-free-work" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Helmholtz free energy difference is available for work)</strong></span> Consider the following method of extracting mechanical energy. Connect the system to an energy bath at energy price <span class="math inline">\(\beta\)</span>, and a mechanical system of arbitrary design. The system starts at <span class="math inline">\(\beta, U_0, X_0\)</span> and ends at <span class="math inline">\(\beta, U_1, X_1\)</span>. No matter how the mechanical system is designed, and no matter whether the process is reversible or not, we have</p>
<p><span class="math display">\[
W\leq F(\beta, U_0, X_0) - F(\beta, U_1, X_1)
\]</span></p>
<p>where <span class="math inline">\(W\)</span> is “mechanical work done by the system”, that is, the increase in internal energy of the mechanical system. This is an equality when the process is reversible.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By conservation of energy, and the second law,</p>
<p><span class="math display">\[
\begin{cases}
U_1 = U_0 - (W + Q)  \\
\beta Q + S(U_1, X_1) \geq S(U_0, X_0)
\end{cases}
\]</span></p>
<p>which simplifies to the result.</p>
<p>If the process is reversible, then the entropy before and after must be equal, giving us</p>
<p><span class="math display">\[
\begin{cases}
U_1 = U_0 - (W + Q)  \\
\beta Q + S(U_1, X_1) = S(U_0, X_0)
\end{cases}
\]</span></p>
<p>which simplifies to the result.</p>
</div>
</div>
</div>
<p>This result is typically interpreted as saying that <span class="math inline">\(\Delta F = W\)</span>, that is, in a system in constant thermal equilibrium with an energy bath of constant temperature, the drop in Helmholtz energy of the system is the maximal mechanical work extractable from the system. Incidentally, this explains the odd name of “free energy” – “free” as in “free to do work”, to contrast with the other parts of internal energy, which is chained up and not free to do work.</p>
<div id="thm-envelop-helmholtz" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (envelop theorem for Helmholtz)</strong></span> For any inverse temperature <span class="math inline">\(\beta &gt; 0\)</span> and thermodynamic properties <span class="math inline">\(X\)</span>, let <span class="math inline">\(U^*\)</span> be the optimal internal energy that maximizes Helmholtz free entropy, then</p>
<p><span class="math display">\[
\begin{aligned}
\beta &amp;= (\partial_U S)_X|_{U=U^*(\beta, X), X = X} \\
df    &amp;=  (\partial_X S)_U|_{U=U^*(\beta, X), X = X} dX - U^*(\beta, X) d\beta
\end{aligned}
\]</span></p>
<p>if <span class="math inline">\(S\)</span> is differentiable and strictly concave at that point.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the first equation, differentiate <span class="math inline">\(f\)</span>. For the second equation, apply the same no-arbitrage proof as in the proof of <a href="https://en.wikipedia.org/wiki/Hotelling%27s_lemma">Hotelling’s lemma</a> (see the essay on <a href="https://yuxi-liu-wired.github.io/essays/posts/analytical-mechanics/"><em>Analytical Mechanics</em></a>).</p>
</div>
</div>
<p>Economically speaking, the second equation is a special case of the <a href="https://en.wikipedia.org/wiki/Envelope_theorem">envelop theorem</a>, just like Hotelling’s lemma.</p>
</section>
<section id="first-order-phase-transition" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="first-order-phase-transition">First-order phase transition</h3>
<p>What happens if <span class="math inline">\(S\)</span> is not differentiable and strictly concave? In this case, we do not have <span class="math inline">\(\beta = (\partial_U S)_X\)</span>. We have two possibilities.</p>
<p>The first possibility is pictured as follows. There is a kink in the curve of <span class="math inline">\(S(U, X)\)</span>. At that point of critical internal energy <span class="math inline">\(U_c\)</span>, there is an entire interval of possible <span class="math inline">\(\beta\)</span>. What we would notice is that at that critical internal energy and critical entropy, the system can be in equilibrium with <em>any</em> heat bath with <em>any</em> temperature between <span class="math inline">\([T_{c, min}, T_{c, max}]\)</span>. As far as I know, such systems do not exist, as all physically real systems have a unique temperature at all possible states.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/indeterminate_temperature_SU_curve.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">When there is a kink in the curve of <span class="math inline">\(S(U, X)\)</span>, the system has indeterminate temperature.</figcaption>
</figure>
</div>
<p>The second possibility is pictured as follows. There is a bump in the curve, such that we can draw a double tangent over the bump, with slope <span class="math inline">\(\beta_c\)</span>. At that critical inverse temperature, the system can be either at the lower tangent point, or the upper tangent point. It cannot be anywhere in-between, because as we saw, such points do not minimize <span class="math inline">\(f(\beta, X)\)</span>, and thus are unstable.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/first_order_phase_transition_SU_curve.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">When there is a double tangent in the curve of <span class="math inline">\(S(U, X)\)</span>, the system has a first-order phase transition with latent entropy and energy.</figcaption>
</figure>
</div>
<p>For example, if we confine some liquid water in a vacuum chamber, and bathe it in a cold bath, then at its critical <span class="math inline">\(\beta_c\)</span>, it would split into two parts, one part is all ice, and the other part is all water, mixed in just the right proportion to give it the correct amount of total internal energy. As it loses internal energy, the ice part grows larger, until it is all ice, at which point the system has finally gotten over the bump, and could cool down further.</p>
<p>At the critical point, <span class="math inline">\((\partial_{\beta}f)_X\)</span> abruptly changes. So if we plot <span class="math inline">\(\beta \mapsto f(\beta, X)\)</span>, the curve would kink there.</p>
<div id="thm-0" class="theorem page-columns page-full">
<p><span class="theorem-title"><strong>Theorem 5 (Maxwell equal area rule)</strong></span> In a first-order phase transition at a fixed temperature and varying pressure/volume, the <span class="math inline">\(P, V\)</span> diagram has a horizontal line going from <span class="math inline">\((P_c, V_1)\)</span> to <span class="math inline">\((P_c, V_2)\)</span>, such that</p>
<p><span class="math display">\[\int PdV = P_c(V_2-V_1)\]</span></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/maxwell_equal_area_rule.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Maxwell’s equal area rule states that the area of the regions labelled I and II are equal.</figcaption>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Fix the system’s internal energy <span class="math inline">\(U\)</span>, and its temperature <span class="math inline">\(T\)</span>, and plot the <span class="math inline">\(V, S\)</span> curve.</p>
<p>When pressure is at a critical value <span class="math inline">\(P_c\)</span>, the line of slope <span class="math inline">\(\beta P_c\)</span> is tangent to the <span class="math inline">\(V \mapsto S(U, V)\)</span> curve at two different points, with volumes <span class="math inline">\(V_1, V_2\)</span>. This is that first-order phase transition.</p>
<p>Now, move the system state from the first point to the second. During the process, <span class="math display">\[\int PdV = \int (TdS -dU)  = \int TdS = T \Delta S = T \beta P_c(V_2 - V_1) = P_c(V_2-V_1)\]</span></p>
</div>
</div>
</div>
</section>
<section id="other-free-energies" class="level3">
<h3 class="anchored" data-anchor-id="other-free-energies">Other free energies</h3>
<p>Consider a thermodynamic system whose entropy function is <span class="math inline">\(S(U, V, X)\)</span>, where <span class="math inline">\(U\)</span> is the internal energy and <span class="math inline">\(V\)</span> is the volume. Its <strong>Gibbs free entropy</strong> is</p>
<p><span class="math display">\[
g(\beta, \beta P, X) = \max_{U, V} (S(U, V, X) - \beta U - (\beta P)V)
\]</span></p>
<p>In other words, it’s the convex dual of entropy with respect to energy and volume. Similarly, its <strong>Gibbs free energy</strong> is <span class="math inline">\(G = -g/\beta\)</span>.</p>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6 (Gibbs free entropy is maximized)</strong></span> Let a thermodynamic system be in equilibrium with an energy-and-volume bath of prices <span class="math inline">\(\beta, \beta P\)</span>. If the system has constraint on the state by <span class="math inline">\(C(X) = 0\)</span>, then the system equilibrates at</p>
<p><span class="math display">\[
\begin{cases}
\max_{X} g(\beta, \beta P, X)\\
C(X) = 0
\end{cases}
\]</span></p>
<p>And if <span class="math inline">\(S\)</span> is strictly concave and differentiable at that point, then <span class="math inline">\(dg =  (\partial_X S)_{U, V} dX - Ud\beta - V d(\beta P)\)</span>.</p>
</div>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7 (Gibbs free energy difference is available for work)</strong></span> Connect a system to an energy-and-volume bath at marginal entropies <span class="math inline">\(\beta, \beta P\)</span>, and a mechanical system of arbitrary design. The system starts at <span class="math inline">\(\beta, \beta P, X_0\)</span> and ends at <span class="math inline">\(\beta, \beta P, X_1\)</span>. Then,</p>
<p><span class="math display">\[
W\leq G(\beta, \beta P, X_0) - G(\beta, \beta P, X_1)
\]</span></p>
<p>where <span class="math inline">\(W\)</span> is “work”, that is, the increase in internal energy of the mechanical system. If the process is reversible, then equality holds.</p>
</div>
<div id="thm-envelop-gibbs" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8 (envelop theorem for Gibbs)</strong></span> For any inverse temperature <span class="math inline">\(\beta &gt; 0\)</span>, any pressure <span class="math inline">\(P\)</span>, and other thermodynamic properties <span class="math inline">\(X\)</span>, let <span class="math inline">\(U^*, V^*\)</span> be the optimal internal energy and volume that maximizes Gibbs free entropy, then</p>
<p><span class="math display">\[
\begin{aligned}
\beta &amp;= (\partial_U S)_{V, X} \\
\beta P &amp;= (\partial_V S)_{U, X}\\
dg    &amp;=  (\partial_X S)_{U, V} dX - U^* d\beta - V^* d(\beta P)
\end{aligned}
\]</span></p>
<p>if <span class="math inline">\(S\)</span> is differentiable and strictly concave at that point. Here, the left sides of all equations are evaluated at <span class="math inline">\(U=U^*(\beta, \beta P, X), V=V^*(\beta, \beta P, X), X = X\)</span>.</p>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> Prove the above theorems for Gibbs free entropy.</p>
</div>
<p>Similarly, if a system is in energy-volume-chemical contact with an energy-volume-chemical bath, then the following <strong>Landau free entropy</strong> is useful:</p>
<p><span class="math display">\[
\omega(\beta, \beta P, -\beta\mu_1, \dots, -\beta\mu_n) = \max_{U, V, N_1, \dots, N_n} \left(S(U, V, N_1, \dots, N_n, X) - \beta U - (\beta P)V - \sum_{i=1}^n (-\beta \mu_i) N_i \right)
\]</span></p>
<p>In other words, it’s the convex dual of entropy with respect to energy, volume, and particle numbers.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> Formulate and prove the analogous theorems for Landau free entropy.</p>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> If we consider a system, surrounded by gas, inside an adiathermal piston under an atmosphere, then we can consider the following form of free energy: <span class="math inline">\(\tilde s(U, \beta P, X) := \max_{V} (S(U, V, X) - \beta U - (\beta P)V)\)</span>. Formulate and prove the analogous theorems for this free entropy.</p>
</div>
<p>Take-home lessons:</p>
<ul>
<li>When a system is in contact with a <span class="math inline">\(Y\)</span>-bath, then it is useful to consider the convex dual of the entropy with respect to <span class="math inline">\(Y\)</span>, that is, <span class="math inline">\(\max_Y (S(Y, X) - p_Y Y)\)</span>, where <span class="math inline">\(p_Y\)</span> is the marginal entropy of <span class="math inline">\(Y\)</span> of the bath.</li>
<li>Free entropy is maximized when the system equilibrates with a bath. Free energy is minimized.</li>
<li>Change in free energy is the maximal amount of work extractable when the system equilibrates with both a bath and a mechanical system. This work is actually extracted when the process is reversible.</li>
</ul>
</section>
<section id="maxwell-relations" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="maxwell-relations">Maxwell relations</h3>
<p>Since <span class="math inline">\(dS = \beta dU + \beta P dV\)</span>, we have the first Maxwell relation</p>
<p><span id="eq-maxwell-1"><span class="math display">\[
\partial_U \partial_V S = (\partial_V \beta)_U = (\partial_U(\beta P) )_V
\tag{3}\]</span></span></p>
<p>In economic language, it states</p>
<p><span id="eq-maxwell-1-econ"><span class="math display">\[
\partial_{q_i}\partial_{q_j} S = (\partial_{q_i} p_j)_{q_j} = (\partial_{q_j} p_i)_{q_i}
\tag{4}\]</span></span></p>
<p>where <span class="math inline">\(q_i\)</span> is the quantity of commodity <span class="math inline">\(i\)</span>, and <span class="math inline">\(p_i\)</span> is its marginal utility. In economics, we usually prefer writing demanded quantity as a function of marginal price as</p>
<p><span class="math display">\[(\partial_{p_j}q_i)_{q_j} = (\partial_{p_i}q_j)_{q_i}\]</span></p>
<p>This is a symmetry of <a href="https://en.wikipedia.org/wiki/Cross_elasticity_of_demand">cross-price elasticity of demand</a>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;Samuelson used the Maxwell relations, and other relations, to justify neoclassical economics. His idea is that, while utility functions are unobservable, and we do not have a scientific instrument to measure “economic equilibrium”, we can make falsifiable predictions from assuming that the economy is in equilibrium – such as the symmetry of the cross-price elasticity of demand.</p></div></div><p>For example, if <span class="math inline">\(i, j\)</span> are noodles and bread, then <span class="math inline">\((\partial_{q_i} p_j)_{q_j}\)</span> is how much the marginal price of bread would rise if I have a little more noodle. As noodles and bread are substitutional goods, we expect the number to be negative, meaning that having more noodles, I would price bread less. The Maxwell relation then tells us that it is exactly the same in the other direction: If I am given a little more bread, I would price noodles less. Not only that, I would want less by <em>exactly the same amount</em>.</p>
<p>The second relation is a bit hard to explain, since enthalpy really does not have a good representation in entropy-centric thermodynamics. However, it turns out to be just the third relation with <span class="math inline">\(i, j\)</span> switched.</p>
<p>Since <span class="math inline">\(df = \beta P dV - Ud\beta\)</span>, we have the third Maxwell relation</p>
<p><span id="eq-maxwell-3"><span class="math display">\[
\partial_\beta\partial_V f = -(\partial_V U)_\beta = +(\partial_\beta(\beta P))_V
\tag{5}\]</span></span></p>
<p>In economic language, we have</p>
<p><span id="eq-maxwell-3-econ"><span class="math display">\[
\partial_{p_i}\partial_{q_j} \left[\max_{q_i}(S(q) - p_i q_i )\right]= -(\partial_{q_j} q_i)_{p_i} = (\partial_{p_i}p_j)_{q_j}
\tag{6}\]</span></span></p>
<p>Continuing from the previous example, if <span class="math inline">\(i, j\)</span> are noodles and bread, and we open a shop with an infinite amount of noodles always at the exact price, then I would of course buy and sell from the noodle shop until my marginal price of noodles is equal to the shop’s price. Now, <span class="math inline">\((\partial_{q_j} q_i)_{p_i}\)</span> is how much noodles I would buy if I am given a marginal unit of bread. As noodles and bread are substitutional goods, this number is negative. This then means <span class="math inline">\((\partial_{p_i}p_j)_{q_j} &gt; 0\)</span>, meaning that if the noodle price suddenly increases a bit, then I would sell a bit of noodles until I have reached equilibrium again. At that equilibrium, since I have less noodles, I would price higher its substitutional good, bread, by an equal amount as the previous scenario.</p>
<p>Since <span class="math inline">\(dg = -Ud\beta - Vd(\beta P)\)</span>, we have the fourth Maxwell relation</p>
<p><span id="eq-maxwell-4"><span class="math display">\[
-\partial_{\beta}\partial_{\beta P}g = (\partial_{\beta P}U)_\beta = (\partial_\beta V)_{\beta P}
\tag{7}\]</span></span></p>
<p>In economic language, we have</p>
<p><span id="eq-maxwell-4-econ"><span class="math display">\[
\partial_{p_i}\partial_{p_j} \left[\max_{q_i, q_j}(S(q) - p_i q_i - p_j q_j)\right]= -(\partial_{p_j} q_i)_{p_i}= -(\partial_{p_i} q_j)_{p_j}
\tag{8}\]</span></span></p>
<p>This is another symmetry of cross-price elasticity of demand.</p>
<p>Continuing from the previous example, if <span class="math inline">\(i, j\)</span> are noodles and bread, and we open a shop with an infinite amount of noodles and bread, then I would of course buy and sell from the shop until my marginal prices of noodles and bread are equal to the shop’s prices. Now, if the shop suddenly raises the price of bread by a small amount, I would sell off some bread until my marginal price for bread increases to the shop’s new price. Now my marginal price for noodles increases too by substitutional effect, so I buy some noodles. Thus <span class="math inline">\((\partial_{p_j} q_i)_{p_i} &gt; 0\)</span>. Switching the scenario, we find that raising the price of noodles would make me buy bread, by an equal amount as the previous scenario.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Alternate proof of the Maxwell relations">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternate proof of the Maxwell relations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We use the notation of economics here.</p>
<p>Suppose we have commodities <span class="math inline">\(1, 2, \dots, n\)</span>. We pick two commodities <span class="math inline">\(i, j\)</span>, and fix all other commodity quantities. Thus, we can write <span class="math inline">\(dS = p_i dq_i + p_j d q_j\)</span>.</p>
<p>Since knowing <span class="math inline">\(n\)</span> properties of the thermodynamic system allows us to know its exact state, and we have already fixed <span class="math inline">\(n-2\)</span> properties of it, there only remain two more degrees of freedom. We can parameterize this by <span class="math inline">\((q_i, q_j)\)</span>, or <span class="math inline">\((p_i, q_j)\)</span>, or <span class="math inline">\((p_i, p_j)\)</span>, or any other reasonable coordinate system.</p>
<p>If the thermodynamic system undergoes a cycle, then</p>
<p><span class="math display">\[0 = \oint dS = \oint p_i dq_i + \oint p_j dq_j\]</span></p>
<p>and thus, if we take the cycle infinitesimally small, we find that <span class="math inline">\(dp_i\wedge dq_i = -dp_j \wedge dq_j\)</span>. That is, the map <span class="math inline">\((p_i, q_i) \mapsto (p_j, q_j)\)</span> preserves areas, but reverses orientation. In particular, we have a Jacobian <span class="math display">\[
\frac{\partial(p_i, q_i)}{\partial(p_j, q_j)} = -1
\]</span></p>
<p>Now, let <span class="math inline">\((x, y)\)</span> be an arbitrary coordinate transform. By the chain rule for Jacobians, <span class="math display">\[
\frac{\partial(p_i, q_i)}{\partial(x, y)} = \frac{\partial(p_i, q_i)}{\partial(p_j, q_j)} \frac{\partial(p_j, q_j)}{\partial(x,y)}  = -\frac{\partial(p_j, q_j)}{\partial(x,y)}
\]</span></p>
<p>This allows us to derive all the Maxwell relations. For example, setting <span class="math inline">\((x, y) = (p_i, q_j)\)</span> gives us the third relation</p>
<p><span class="math display">\[(\partial_{q_j} q_i)_{p_i} = -(\partial_{p_i}p_j)_{q_j}\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure" aria-labelledby="-caption">
<p><img src="figure/maxwell_relations_commutative_diagram.png" class="img-fluid figure-img"></p>

</figure>
</div>
</div>
</div>
</div>
<div id="-caption" class="margin-figure-caption column-margin callout-8-contents callout-collapse collapse show callout-margin-content">Deriving the four Maxwell relations by picking the right variables for .</div></section>
</section>
<section id="caratheodorys-thermodynamics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="caratheodorys-thermodynamics">Caratheodory’s thermodynamics</h2>
<p>In the early 1900s, Caratheodory discovered a new way to “geometrize” thermodynamics, with the austere beauty of Euclidean geometry. Though his formulation fell into obscurity, it was reborn in neoclassical economics as utility theory.</p>
<section id="entropy-and-temperature" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="entropy-and-temperature">Entropy and temperature</h3>
<p>Consider a thermodynamic system with <span class="math inline">\(n+1\)</span> dimensions of state space. Give the state space coordinates <span class="math inline">\(q_0, q_1, \dots, q_n\)</span>. For example, for a tank of ideal gas where the particle number is fixed, we have <span class="math inline">\(q_0 = U, q_1 = V\)</span>.</p>
<p>Let the system be at a certain state <span class="math inline">\(\vec q\)</span>, and wrap the system in a perfectly insulating (adiathermal) blanket. The system can undergo many different kinds of adiathermal motion, but there are certain motions that it cannot undergo.</p>
<p>For example, for a piston of ideal gas, the possible motions are adiabatic expansion, adiabatic compression, Joule expansion, and any combination of them. However, “Joule compression” is impossible – the gas will not spontaneously contract to the left half of the system, pulling in the piston head, anymore than a messy room will spontaneously tidy itself.</p>
<p>We say that <span class="math inline">\(\vec q'\)</span> is adiathermally accessible from <span class="math inline">\(\vec q\)</span> if there exists a path from <span class="math inline">\(\vec q\)</span> to <span class="math inline">\(\vec q'\)</span>, such that the path is infinitesimally adiathermal<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> at every point.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;The word “adiathermal” means “heat does not pass through”, while “adiabatic” has an entire history of meaning that makes it hard to say what exactly it is (see <a href="https://yuxi-liu-wired.github.io/essays/posts/analytical-mechanics/">my essay on Analytical Mechanics</a>). Personally, I think “adiabatic” means “zero entropy change”, and all its other meanings derive from it.</p></div></div><div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/adiabatic_accessibility.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Adiabatic accessibility in the <span class="math inline">\(U, V\)</span> diagram.</figcaption>
</figure>
</div>
<p>Here is <strong>Caratheodory’s version of the second law of thermodynamics</strong>:</p>
<ul>
<li>In any neighborhood of any point <span class="math inline">\(\vec q\)</span>, there are points adiabatically inaccessible from it.</li>
<li>Furthermore, for any two points, <span class="math inline">\(\vec q, \vec q'\)</span>, at least one of them is adiabatically accessible from the other.</li>
</ul>
<p>The effect of these two axioms is that we can define a total ordering <span class="math inline">\(\preceq\)</span> on state space, where we write <span class="math inline">\(\vec q \preceq \vec q'\)</span> to mean that <span class="math inline">\(\vec q\)</span> can adiabatically access <span class="math inline">\(\vec q'\)</span>, and write <span class="math inline">\(\vec q \sim \vec q'\)</span> to mean that they are mutually adiabatically accessible.</p>
<p>Interpreted economically, we say that the system is an economic agent, each <span class="math inline">\(\vec q\)</span> is a bundle of goods, and <span class="math inline">\(\vec q \preceq \vec q'\)</span> means that <span class="math inline">\(\vec q'\)</span> is preferable to the agent, and that <span class="math inline">\(\vec q \sim \vec q'\)</span> means they are equally preferred.</p>
<p>The total ordering partitions the state space into contour surfaces of equal accessibility, or <a href="https://en.wikipedia.org/wiki/Indifference_curve">indifference surfaces</a>. Assuming the state space is not designed to be <a href="https://en.wikipedia.org/wiki/Pathological_(mathematics)">pathological</a>, these indifference surfaces will be differentiable.</p>
<p>Let us consider the indifference surface passing state <span class="math inline">\(\vec q\)</span>. The indifference surface is locally a plane, so it has equations</p>
<p><span class="math display">\[
dq_0 - \sum_i \tilde p_i dq_i = 0
\]</span></p>
<p>where <span class="math inline">\(\tilde p_i = (\partial_{q_i}q_0)_{q_1, \dots, q_n}\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/contact_geometry_one-form.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The field of planes defined by <span class="math inline">\(dq_0 - \sum_i \tilde p_i dq_i = 0\)</span>.</figcaption>
</figure>
</div>
<p>For example, a tank of (non-ideal) gas satisfies <span class="math inline">\(dU + PdV = 0\)</span> over its indifference curves.</p>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9 (existence and uniqueness of temperature and entropy)</strong></span> Let <span class="math inline">\(\omega = dq_0 - \sum_i \tilde p_i dq_i\)</span>. If <span class="math inline">\(\omega\)</span> is nonzero everywhere, then there exists functions <span class="math inline">\(\beta, S\)</span> on the state space, such that <span class="math inline">\(dS = \beta \omega\)</span>.</p>
<p>Furthermore, they are unique up to a monotonic transform. That is, if we have another solution <span class="math inline">\(\beta', S'\)</span>, then there exists a strictly monotonic function <span class="math inline">\(f\)</span> such that <span class="math inline">\(S' = f \circ S\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>At each point <span class="math inline">\(P\)</span> the one-form <span class="math inline">\(\omega(p)\)</span> is visualized as a stack of parallel planes. The planes are quilted together, but with “uneven thickness”. By scaling the one-forms just right at every point, the thickness becomes equalized, and so <span class="math inline">\(\beta \omega = dg\)</span> for two real-valued functions <span class="math inline">\(\beta, S\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure" aria-labelledby="-caption">
<p><img src="figure/Caratheodory_s_theorem_illustration.jpg" class="img-fluid figure-img" style="width:100.0%"></p>

</figure>
</div>
<p>Given any other solution <span class="math inline">\(\beta', S'\)</span>, both <span class="math inline">\(S\)</span> and <span class="math inline">\(S'\)</span> must have the same contour lines, so there exists some function that maps the <span class="math inline">\(S\)</span>-height of a contour line to its <span class="math inline">\(S'\)</span>-height.</p>
</div>
</div>
<div id="-caption" class="margin-figure-caption column-margin callout-margin-content">Proving Caratheodory’s theorem. Figure from .</div></section>
<section id="cardinal-and-ordinal-utilities" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="cardinal-and-ordinal-utilities">Cardinal and ordinal utilities</h3>
<p>Economically speaking, <span class="math inline">\(\tilde p_i\)</span> is the marginal worth of <span class="math inline">\(q_i\)</span> denoted in units of <span class="math inline">\(q_0\)</span>. For example, we can say that <span class="math inline">\(q_0\)</span> are cowry shells, which themselves are pretty and give us some utility. However, it can also be used as a monetary unit. Then, if <span class="math inline">\(i\)</span> is bread, then <span class="math inline">\(\tilde p_i\)</span> is the marginal amount of cowry shells that we would pay for a marginal amount of bread. If we were to visit a free market where we can buy and sell items denoted in cowry shells, then we would buy bread if <span class="math inline">\(\tilde p_i &gt; \tilde p_{i, market}\)</span>, and sell bread if <span class="math inline">\(\tilde p_i &lt; \tilde p_{i, market}\)</span>. Right at the border of <span class="math inline">\(\tilde p_i = \tilde p_{i, market}\)</span>, we would be indifferent about buying or selling bread. When <span class="math inline">\(\tilde p_i = \tilde p_{i, market}\)</span> for all <span class="math inline">\(i\)</span>, we would be completely indifferent about the market.</p>
<p><span class="math inline">\(S\)</span> is the utility, and <span class="math inline">\(\beta\)</span> is the marginal utility of cowry shells. The theorem tells us that just by knowing how we <em>order</em> the goods (” <span class="math inline">\(S(\vec q) &gt; S(\vec q')\)</span> “), we can extract a <em>numerical value</em> for the goods (” <span class="math inline">\(S(\vec q) - S(\vec q') = 1.34(S(\vec q'') - S(\vec q'''))\)</span> “). Out of <em>ordinal utility</em>, we have achieved <em>cardinal utility</em>.</p>
<p>There used to be a debate between “ordinalists” and “cardinalists” of utility theory. The “cardinalists” were the more venerable of the two camps, tracing back to Bentham’s felicific calculus and the marginalist revolution. They argued that utility is real-valued, like entropy and temperature. The “ordinalists” countered that a nobody has ever measured a utility in anyone’s brain. The only thing we can observe is preferences: I prefer this over that – I can <em>order</em> everything that can ever happen to me on a <em>numberless</em> line of preferences. Similarly, nobody can ever actually measure temperature or entropy, only that energy flows from this gas to that gas, which presumably has lower temperature, and that one chunk of gas in one state ends up in another state, which presumably has higher entropy.</p>
<p>The debate has been mostly resolved by the work of <a href="https://en.wikipedia.org/wiki/G%C3%A9rard_Debreu">Gérard Debreu</a>, who showed that under fairly reasonable assumptions, cardinal utility is possible <span class="citation" data-cites="debreuTheoryValueAxiomatic1971">(<a href="#ref-debreuTheoryValueAxiomatic1971" role="doc-biblioref">Debreu 1971</a>)</span>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Out of all those famous economists I have seen, Gérard Debreu is perhaps the most mathematically austere. Reading his works, I felt like he was another G. H. Hardy, a Bourbaki of economics. He did economics not to improve the world, not to help people, and not to advance a political agenda, but to simply uncover a face of eternity.</p></div></div><p>This theorem, or rather, this <em>family</em> of theorems, have several names, as befitting for such a versatile and productive family. In calculus, it’s called the <a href="https://en.wikipedia.org/wiki/Integrability_conditions_for_differential_systems">integrability of Pfaffian forms</a>. In differential geometry, it’s called <a href="https://en.wikipedia.org/wiki/Darboux%27s_theorem">Darboux’s theorem</a>, or <a href="https://en.wikipedia.org/wiki/Frobenius_theorem_(differential_topology)">Frobenius theorem</a>. In economics, it’s called the integrability of demand, or the cardinal-ordinal <a href="https://en.wikipedia.org/wiki/Utility_representation_theorem">utility representation theorem</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="What's so special about energy, or cowry shells?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What’s so special about energy, or cowry shells?
</div>
</div>
<div class="callout-body-container callout-body">
<p>When cast in the language of economics, cowry shells are not special. We could denote prices in cowry shells, or cans of sardine, or grams of gold. That is, we are free to pick any numéraire we want, as long as we are consistent about it.</p>
<p>Similarly, energy is not special. For example, with ideal gas, we could write the first law of thermodynamics as the conservation of energy, like</p>
<p><span class="math display">\[dU - (-P)dV = \beta^{-1}dS\]</span></p>
<p>or as the conservation of volume, like</p>
<p><span class="math display">\[dV - (-P^{-1})dU= (\beta P)^{-1}dS\]</span></p>
<p>and from the perspective of classical thermodynamics, there is <em>no</em> possibility of saying that energy is <em>more special</em> than volume. Energy is exactly as special as volume, and no more special than that.</p>
<p>When I realized this difference, I was so incensed at this mistake that I wrote an entire <a href="#sec-stereodynamics">sci-fi worldbuilding sketch</a> about an alien species, for which it is the conservation of volume that is fundamental, not energy, and which discovered stereodynamics, not thermodynamics.</p>
</div>
</div>
</section>
<section id="extensive-entropy" class="level3">
<h3 class="anchored" data-anchor-id="extensive-entropy">Extensive entropy</h3>
<p>While we have constructed the temperature <span class="math inline">\(T\)</span> and the entropy <span class="math inline">\(S\)</span> of an isolated system, it is not unique: we can stretch and compress the entropy function <span class="math inline">\(S\)</span> arbitrarily by a monotonic function, and as long as we modify the temperature function <span class="math inline">\(T\)</span> just right, the two modifications cancel out, and we have <span class="math inline">\(TdS = T' dS'\)</span>.</p>
<p>In order to uniquely fix an entropy function, we need further assumptions. The most commonly used method is by considering what happens to the entropy of a compound system. In general, there is no reason to expect entropy to be additive – if we take compound two systems together, the entropy of the compound system should be the sum of the two subsystems. However, if we make some reasonable assumptions, then entropy would be uniquely fixed, and would be additive.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5 (von Neumann–Morgenstern entropy construction)</strong></span> Study the statement of the <a href="https://en.wikipedia.org/wiki/Von_Neumann%E2%80%93Morgenstern_utility_theorem">von Neumann–Morgenstern utility theorem</a>, and translate it to thermodynamics. It should be of the following form:</p>
<p>Assuming that a compound system’s adiabatic accessibility satisfies the following properties</p>
<ol type="1">
<li>…</li>
<li>…<br>
…</li>
</ol>
<p>then the entropy of the compound system is the sum of the entropies of its subsystems, and is unique up to adding a constant and multiplying by a positive scalar.</p>
</div>
<p>Some hints:</p>
<ul>
<li>It might help your intuition if you anthropomorphize Nature as a “vNM-rational agent”.</li>
<li>The standard formulation of the vNM theorem uses lotteries of form <span class="math inline">\(pM + (1-p)N\)</span>, where <span class="math inline">\(p\in (0, 1)\)</span> is a probability, and <span class="math inline">\(M, N\)</span> are bundles of goods. However, it is impossible generally to “take <span class="math inline">\(0.37\)</span> of a system <span class="math inline">\(M\)</span> and compound it with <span class="math inline">\(0.63\)</span> of system <span class="math inline">\(N\)</span>”. To bypass this difficulty, replace that with “take <span class="math inline">\(37\)</span> copies of system <span class="math inline">\(M\)</span> and compound them with <span class="math inline">\(63\)</span> copies of system <span class="math inline">\(N\)</span>”.</li>
</ul>
</section>
</section>
<section id="geometric-thermodynamics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="geometric-thermodynamics">Geometric thermodynamics</h2>
<blockquote class="blockquote">
<p>Although geometrical representations of propositions in the thermodynamics of fluids are in general use, and have done good service in disseminating clear notions in this science, yet they have by no means received the extension in respect to variety and generality of which they are capable.</p>
<p><span class="citation" data-cites="gibbsGraphicalMethodsThermodynamics1957">(<a href="#ref-gibbsGraphicalMethodsThermodynamics1957" role="doc-biblioref">Gibbs 1957</a>)</span></p>
</blockquote>
<section id="contact-geometry" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="contact-geometry">Contact geometry</h3>
<blockquote class="blockquote">
<p>Every mathematician knows it is impossible to understand an elementary course in thermodynamics. The reason is that thermodynamics is based—as Gibbs has explicitly proclaimed – on a rather complicated mathematical theory, on the contact geometry. Contact geometry is one of the few ‘simple geometries’ of the so-called Cartan’s list, but it is still mostly unknown to the physicist – unlike the Riemannian geometry and the symplectic or Poisson geometries, whose fundamental role in physics is today generally accepted.</p>
<p>V.I. Arnol’d <span class="citation" data-cites="caldiProceedingsGibbsSymposium1990">(<a href="#ref-caldiProceedingsGibbsSymposium1990" role="doc-biblioref">Caldi et al. 1990, 163</a>)</span></p>
</blockquote>
<p>To explain these mysterious remarks, we can take another look at thermodynamics. To begin, we take a plunge into abstraction. We know that a real gas has pressure, volume, temperature, entropy, etc. We know that they satisfy the differential equation:</p>
<p><span class="math display">\[
dS = \beta dU + \beta PdV
\]</span></p>
<p>To make things look better, we can change the notation to</p>
<p><span class="math display">\[
dS = p_1 dq_1 + p_2 dq_2
\]</span></p>
<p>This formula has a clear interpretation in economics: if the marginal utility of commodity <span class="math inline">\(1\)</span> is <span class="math inline">\(p_1\)</span>, and the marginal utility of commodity <span class="math inline">\(2\)</span> is <span class="math inline">\(p_2\)</span>, then if we receive <span class="math inline">\(\delta q_1, \delta q_2\)</span>, our utility would increase by <span class="math inline">\(p_1 \delta q_1 + p_2 \delta q_2\)</span>.</p>
<p>The difficult thing about classical thermodynamics is that there are so many quantities (temperature, volume, pressure…). The saving grace is that it turns out that there are only a few degrees of freedom.</p>
<p>The Parthian shot is that now you are burdened with dozens of equations relating these quantities. I cannot remember any of the Maxwell relations, so I look at Wikipedia every time I need to calculate with them.</p>
<p>However, why is it that a macroscopic lump of matter, whirling with <span class="math inline">\(10^{23}\)</span> molecules, turn out to be characterized by only a few degrees of freedom? Why is it that a national economy, swarming with <span class="math inline">\(10^8\)</span> people, have macroeconomic laws? For the first question, the answer is given by classical thermodynamics: the lump of matter is maximizing its entropy under constraint, so its degrees of freedom are exactly as many as the number of constraints it is laboring under. For the second question, the answer is given by neoclassical economics: the national economy behaves as if it is maximizing a social utility function under its resource constraints.</p>
<p>With that brief look at philosophy, we return to abstract thermodynamics. We have a lump of matter (such as ideal gas in a piston), of which we can measure five different properties: <span class="math inline">\(p_1, p_2, q_1, q_2, S\)</span>. In general, we expect that the space of possible measurements is 5-dimensional, but it turns out that they collapse down to a 2-dimensional curved surface. This is why we could completely fix its state knowing just its <span class="math inline">\(V, U\)</span>, or just its <span class="math inline">\(P, T\)</span>, etc.</p>
<p>The question now comes: Why is it possible to collapse things down to this curved surface?</p>
<p>Things are already interesting when we have just one commodity:</p>
<p><span class="math display">\[dS - pdq = 0\]</span></p>
<p>and we ask: Why is it possible to collapse the space of <span class="math inline">\((q, p, S)\)</span> from 3 to 1 dimension?</p>
<p>In modern geometry, an expression like <span class="math inline">\(dS - \sum_i p_i dq_i = 0\)</span> defines a field of planes in <span class="math inline">\(\R^3\)</span>. That is, at each point <span class="math inline">\((q, p, S)\)</span>, we construct a plane defined by</p>
<p><span class="math display">\[
\{(q + \delta q, p + \delta p, S + \delta S): \delta S - p \delta q = 0\}
\]</span></p>
<p>For example, in three dimensions, the field of planes <span class="math inline">\(dS - pdq = 0\)</span> would look like it is constantly twisting as <span class="math inline">\(p\)</span> increases.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/standard_contact_structure.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The field of planes <span class="math inline">\(dS - pdq = 0\)</span> in <span class="math inline">\(\R^{2+1}\)</span>. Figure from <a href="https://en.wikipedia.org/wiki/File:Standard_contact_structure.svg">Wikipedia</a>.</figcaption>
</figure>
</div>
<p>Given such a field of planes <span class="math inline">\(dS - \sum_{i=1}^n p_i dq_i\)</span> in <span class="math inline">\(\R^{2n+1}\)</span>, we say that a manifold is a <strong>Legendrian submanifold</strong> iff the manifold has <span class="math inline">\(n\)</span> dimensions, and is tangent to the field of planes at every point.</p>
<p>For example, when <span class="math inline">\(n=1\)</span>, a Legendrian submanifold is a curve that winds around <span class="math inline">\(\R^3\)</span> that is always tangent to the plane at every moment.</p>
<p>Let <span class="math inline">\(S(q)\)</span> be a differentiable function. We can interpret <span class="math inline">\(S(q)\)</span> as how much money we can earn if we produce something using the bundle of raw materials <span class="math inline">\((q_1, \dots, q_n)\)</span>.</p>
<p>Given any market price for the raw materials, <span class="math inline">\(q^* = \argmax_q (S(q) - \braket{p, q})\)</span> is the profit-maximizing production plan, and <span class="math inline">\(\Pi(p) = \max_q (S(q) - \braket{p, q})\)</span> is the profit.</p>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 10</strong></span> The “profit-maximization surface” defined by <span class="math inline">\(p \mapsto (q^*, p, S(q^*))\)</span> is a Legendrian submanifold.</p>
<p>Conversely, given any Legendrian submanifold parameterized by <span class="math inline">\(p \mapsto (q(p), p, S(q(p)) )\)</span>, then <span class="math inline">\(q(p)\)</span> is profit-stationarizing. That is,</p>
<p><span class="math display">\[\nabla_q (S(q) - \braket{p, q}) = 0\]</span></p>
<p>at <span class="math inline">\(q(p)\)</span>. If <span class="math inline">\(S\)</span> is strictly concave, then <span class="math inline">\(q(p)\)</span> is profit-maximizing.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
</div>
<div class="callout-body-container callout-body">
<p>The first part is proven by Hotelling’s lemma.</p>
<p>The second part is proven by plugging in <span class="math inline">\(dS - \sum_i p_i dq_i = 0\)</span>. And if <span class="math inline">\(S\)</span> is strictly concave, then <span class="math inline">\(q \mapsto S(q) - \braket{p, q}\)</span> is also strictly concave, and so zero gradient implies global maximum.</p>
<p>Economically speaking, <span class="math inline">\(max_q (S(q) - \braket{p, q})\)</span> means to maximize profit. What does it mean thermodynamically speaking? It means minimizing <span class="math inline">\(\braket{p, q} - S(q)\)</span>, which is the Gibbs free entropy! Let me write it in a more familiar form, for a tank of gas: <span class="math display">\[\min_{\beta, \beta P} (\beta U + (\beta P) V - S)\]</span></p>
<p>Thus, maximizing profit when a factory has access to a market is the same as minimizing Gibbs free entropy when a system is in contact with a bath.</p>
</div>
</div>
</section>
<section id="samuelsons-area-ratio-thermodynamics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="samuelsons-area-ratio-thermodynamics">Samuelson’s area-ratio thermodynamics</h3>
<section id="philosophy" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="philosophy">Philosophy</h4>
<p>In Paul Samuelson’s Nobel prize lecture of 1970, among comments of classical mechanics, variational principles, and neoclassical economics, he said something curious about the analogy between classical thermodynamics and neoclassical economics:</p>
<blockquote class="blockquote">
<p>However, if you look upon the monopolistic firm hiring 99 inputs as an example of a maximum system, you can connect up its structural relations with those that prevail for an entropy-maximizing thermodynamic system. Pressure and volume, and for that matter absolute temperature and entropy, have to each other the same conjugate or dualistic relation that the wage rate has to labor or the land rent has to acres of land. Figure 2 can now do double duty, depicting the economic relationships as well as the thermodynamic ones.</p>
<p>If someone challenged me to explain what the existence of [utility] implies, but refused to let me use the language of partial derivatives, I could illustrate by an equi-proportional area property… I may say that the idea for this proposition in economics came to me in connection with some amateurish researches in the field of thermodynamics. While reading Clerk Maxwell’s charming introduction to thermodynamics…</p>
<p><span class="citation" data-cites="samuelsonMaximumPrinciplesAnalytical1971">(<a href="#ref-samuelsonMaximumPrinciplesAnalytical1971" role="doc-biblioref">Samuelson 1971</a>)</span></p>
</blockquote>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/Samuelson_area_ratio_condition.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Samuelson’s equal area ratio condition. In the diagram, we have <span class="math inline">\(a:b = c:d\)</span></figcaption>
</figure>
</div>
<p>This intriguing little remark piqued my interest, and after a little digging, I figured it out.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Based on research by James Bell Cooper, who seems to be the world expert in this obscure field <span class="citation" data-cites="cooperSurprisingUbiquitySamuelson2006 cooperCharacterizingAreaCondition2001">(<a href="#ref-cooperSurprisingUbiquitySamuelson2006" role="doc-biblioref">Cooper and Russell 2006</a>; <a href="#ref-cooperCharacterizingAreaCondition2001" role="doc-biblioref">Cooper, Russell, and Samuelson 2001</a>)</span>.</p></div></div><p>Samuelson is alluding to a deep problem in economics theory: Nobody has ever seen a utility function, anymore than anybody has ever seen an entropy. If this is the case, then how do we know that agents are maximizing a utility, or that systems are maximizing an entropy? In his long career, he searched for many ways to answer this, coming down to the idea that, even though we cannot measure utility, we can measure many things, such as how firms respond to prices. Given some measurable quantities, we can then prove, mathematically, that something is being maximized. At that point, we can simply call that something “utility”, and continue doing economics as usual.</p>
<p>Philosophically, Samuelson was greatly influenced by <a href="https://plato.stanford.edu/entries/operationalism/">operationalism</a>, a philosophy of science akin to <a href="https://plato.stanford.edu/entries/logical-empiricism/">logical positivism</a>. As stated by the definitive work on operationalism, “we mean by any concept nothing more than a set of operations; the concept is synonymous with the corresponding set of operations” <span class="citation" data-cites="bridgmanLogicModernPhysics1927">(<a href="#ref-bridgmanLogicModernPhysics1927" role="doc-biblioref">Bridgman 1927</a>)</span>.</p>
<p>In his early work, particularly <em>Foundations of Economic Analysis</em> (1947) and the development of revealed preference theory (1938), Samuelson embraced operationalism as a means of purging economics of non-observable, and thus scientifically meaningless, concepts like utility. He sought to rebase economic theory on purely observable behavior and measurable quantities. Revealed preference theory, for instance, would eliminate utility functions, and derive a consumer’s preference ordering directly from observable consumer choices at different price levels.</p>
<p>Over time, Samuelson’s stance on operationalism softened to a more pragmatic approach, recognizing the value of unobservable concepts as theoretical tools, as long as they can be based on direct observables.</p>
<p>For example, while Samuelson initially sought to eliminate utility functions, he later argued that even if utility is not directly observable, it can be uniquely determined from observing agents’ preferences, by invoking some <a href="https://en.wikipedia.org/wiki/Utility_representation_theorem">utility representation theorems</a> – provided that the preferences satisfy certain properties. <span class="citation" data-cites="samuelsonMyLifePhilosophy1999">(<a href="#ref-samuelsonMyLifePhilosophy1999" role="doc-biblioref">Samuelson 1999</a>)</span></p>
</section>
<section id="area-ratio-construction" class="level4">
<h4 class="anchored" data-anchor-id="area-ratio-construction">Area ratio construction</h4>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11 (area ratio law implies a new coordinate system)</strong></span> Consider an open rectangle <span class="math inline">\(R\)</span> in the plane <span class="math inline">\(\R^2\)</span>. Let there be two families of curves</p>
<p>Suppose that each curvy parallelogram formed by the two families is contained in <span class="math inline">\(R\)</span>, and the curves satisfy the area-ratio rule, then we can define another coordinate system <span class="math inline">\((z, w)\)</span> on <span class="math inline">\(\R^2\)</span>, such that the coordinate system preserves areas: <span class="math display">\[
dx \wedge dy = dz \wedge dw
\]</span></p>
<p>and that the two families of lines are the constant <span class="math inline">\(z\)</span> and constant <span class="math inline">\(w\)</span> curves.</p>
<p>The coordinate system is unique up to an affine squashing transform, that is, <span class="math inline">\((z, w) \mapsto (cz + d, w/c + e)\)</span> for some constants <span class="math inline">\(c, d, e\)</span> with <span class="math inline">\(c &gt; 0\)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Fix an arbitrary point as <span class="math inline">\((z, w) = (0, 0)\)</span>. Pick an arbitrary curve in one of the families, not passing <span class="math inline">\((0, 0)\)</span> point, and call it the <span class="math inline">\(w=1\)</span> line. By continuity, there exists a unique curve in the other family, such that their curved parallelogram has unit area. Call that other curve the <span class="math inline">\(z=1\)</span> line. Now we can label the four corners of it <span class="math inline">\((z, w) = (0, 0), (0, 1), (1, 0), (1, 1)\)</span>.</p>
<p>For any other point, its <span class="math inline">\((z, w)\)</span> coordinates can be constructed as shown in the picture, with</p>
<p><span class="math display">\[z = a+b, \quad w = b+d\]</span></p>
<p>By the area ratio law, we have <span class="math inline">\(a:b = c:d\)</span>. We also have <span class="math inline">\(a+b+c+d = 1\)</span> since we picked the parallelogram to have unit area. Solving these 4 equations, we find that <span class="math inline">\(b = zw, a = z(1-w), d = (1-z)w, c = (1-z)(1-w)\)</span>, as it should.</p>
<p>Taking the derivative, we have <span class="math inline">\(dx \wedge dy = dz \wedge dw\)</span>.</p>
<p><img src="figure/Samuelson_geometry_coordinate_construction.png" class="img-fluid"></p>
</div>
</div>
</div>
<div id="cor-0" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 1 (area ratio law implies existence of an entropy function)</strong></span> Since <span class="math inline">\(dx \wedge dy = dz \wedge dw\)</span>, we can draw any cycle <span class="math inline">\(\gamma\)</span>, and integrate around the cycle: <span class="math display">\[\oint_\gamma (ydx + zdw) = \iint_{\text{area in }\gamma} (dy \wedge dx + dz \wedge dw) = 0\]</span></p>
<p>Thus, there exists some scalar function <span class="math inline">\(S\)</span>, such that <span class="math inline">\(dS = ydx + zdw\)</span>.</p>
</div>
<p>And here we go again, we now have an entropy/revenue function, and from there, all of classical thermodynamics/neoclassical economics follows.</p>
</section>
<section id="example-ideal-gas" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="example-ideal-gas">Example: ideal gas</h4>
<p>Suppose we know from experiment that a tank of ideal gas satisfies two equations</p>
<p><span class="math display">\[PV = Const, \quad PV^\gamma = Const\]</span></p>
<p>under isothermal and adiabatic conditions respectively, then the <span class="math inline">\(P, V\)</span> diagram with these two families of curves satisfy the area ratio condition. It is tedious but straightforward to verify this by direct integration. Alternatively, we can use the <a href="https://en.wikipedia.org/wiki/Method_of_exhaustion">method of exhaustion</a> and <a href="https://en.wikipedia.org/wiki/Eudoxus_of_Cnidus">Eudoxus’ theory of proportions</a> to prove this, in a way that even ancient Greeks would approve.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Notice that under the squashing map <span class="math inline">\((P, V) \mapsto (cP, V/c)\)</span>, both families of lines are preserved, and furthermore, this map preserves area, so we can calculate the area of any curvy parallelogram by tiling it with tiny strips of thin parallelograms.</p>
<p>As shown, we can draw a very thin parallelogram <span class="math inline">\(\delta\)</span>, then use the squashing map to tile both parallelograms <span class="math inline">\(c\)</span> and <span class="math inline">\(d\)</span>. We have that</p>
<p><span class="math display">\[A(c) : A(d) = \frac{A(c)}{A(\delta)} : \frac{A(d)}{A(\delta)} \approx N(c) : N(d)\]</span></p>
<p>where <span class="math inline">\(A(c)\)</span> is the area of <span class="math inline">\(c\)</span>, and <span class="math inline">\(N(c)\)</span> is the number of copies of <span class="math inline">\(\delta\)</span> that is contained within <span class="math inline">\(c\)</span>. By the method of exhaustion and Eudoxus’ theory of proportion, at the limit of infinitely thin <span class="math inline">\(\delta\)</span>, both sides are equal.</p>
<p>Now, performing the same construction on the other half of the parallelograms, we tile <span class="math inline">\(a, b\)</span> by the same number of copies of <span class="math inline">\(\delta'\)</span>. Thus we have</p>
<p><span class="math display">\[A(c) : A(d) \approx N(c) : N(d) = N(a) : N(b) \approx A(a) : A(b)\]</span></p>
<p>and both sides equal at the limit.</p>
<p><img src="figure/Samuelson_geometry_Eudoxus_proof.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Now, by the area ratio theorem, there exists two functions <span class="math inline">\(f_T, f_S\)</span>, such that the new coordinates</p>
<p><span class="math display">\[T(P, V) = f_T(PV), \quad S(P, V) = f_S(PV^\gamma)\]</span></p>
<p>satisfy <span class="math inline">\(dT \wedge dS = dP \wedge dV\)</span>. We can then define</p>
<p><span class="math display">\[dU = TdS - PdV\]</span></p>
<p>which satisfies <span class="math inline">\(d^2 U = 0\)</span>, that is, it is integrable.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Derivation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Derivation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Simplifying, we get</p>
<p><span class="math display">\[f'_T(PV)f_S'(PV^\gamma) = \frac{1}{(\gamma - 1) PV^\gamma}\]</span></p>
<p>Let <span class="math inline">\(x = PV, y = PV^\gamma\)</span>, we get a separation of variables: <span class="math inline">\(f'_T(x) f'_S(y) = \frac{1}{(\gamma-1) y}\)</span>, which solves to</p>
<p><span class="math display">\[T = C_1 PV + C_0, \quad S = \frac{1}{(\gamma-1) C_1} \ln \frac{PV^\gamma}{P_0V_0^\gamma}\]</span></p>
<p>for some constants <span class="math inline">\(C_0, C_1, P_0, P_0\)</span>.</p>
<p>Knowing that <span class="math inline">\(C_0 = 0, C_1 = 1/(nR)\)</span>, we have the equations of state: <span class="math display">\[PV = nRT, \quad S = \frac{1}{\gamma-1} nR \ln \frac{PV^\gamma}{P_0V_0^\gamma}\]</span></p>
<p>Integrating <span class="math inline">\(dU = TdS - PdV\)</span>, we have <span class="math inline">\(U = \frac{1}{\gamma-1} nRT\)</span>. We can define <span class="math inline">\(\hat c_V = \frac{1}{\gamma - 1}\)</span>, which leads to</p>
<p><span class="math display">\[PV = nRT, \quad S = \hat c_V n R \ln \frac{PV^{1 + 1/\hat c_V}}{P_0V_0^{1 + 1/\hat c_V}}, \quad U = \hat c_V nRT\]</span></p>
<p>or equivalently, <span class="math inline">\(S = n R \ln \frac{U^{\hat c_V}V}{U_0^{\hat c_V} V_0}\)</span>.</p>
</div>
</div>
</div>
<p>Thus, we have</p>
<p><span class="math display">\[PV = nRT, \quad S = \hat c_V n R \ln \frac{PV^{1 + 1/\hat c_V}}{P_0V_0^{1 + 1/\hat c_V}} = n R \ln \frac{U^{\hat c_V}V}{U_0^{\hat c_V} V_0}, \quad U = \hat c_V nRT\]</span></p>
<p>Taking the derivative, <span class="math inline">\(dS = \beta dU + \beta PdV - \beta \mu dn\)</span> gives <span class="math inline">\(\beta = 1/T, P = P, \mu = -TS/n\)</span>.</p>
<p>We find that the chemical potential, unfortunately, has an additive constant. We should not be too surprised, however, as anything with “potential” in its name probably has an additive constant, like electric voltage.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/Samuelson_area_ratio_condition.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The equal area ratio condition.</figcaption>
</figure>
</div>
</section>
<section id="economic-interpretation" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="economic-interpretation">Economic interpretation</h4>
<p>When the diagram is interpreted as the thermodynamic diagram of a gas, we know what the curvy lines mean: they are the isotherms, isentropics, isobarics, etc (depending on which variables you pick for the two axes of the diagram). What do the curvy lines mean in economics?</p>
<p>Suppose we plot the lines of constant <span class="math inline">\(p_2\)</span> in the plane of <span class="math inline">\(q_1, p_1\)</span>. What does it say? It says this: “Suppose the price of commodity <span class="math inline">\(2\)</span> is fixed, and we vary the price of commodity <span class="math inline">\(1\)</span>. How much of commodity <span class="math inline">\(1\)</span>, as a factory manager, would I want to purchase?” In other words, these are the demand curves for commodity <span class="math inline">\(1\)</span> when the price of commodity <span class="math inline">\(2\)</span> is fixed.</p>
<p>Similarly, a line of constant <span class="math inline">\(q_2\)</span> is a demand curve for commodity <span class="math inline">\(1\)</span> when the <em>quantity</em> of commodity <span class="math inline">\(2\)</span> is fixed at <span class="math inline">\(q_2\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/Helmholtz_demand_curve.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">TODO</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/first-order_phase_transition_Helmholtz.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">TODO</figcaption>
</figure>
</div>
<p>Looking at the diagram, we see that the demand curves are steeper for fixed <span class="math inline">\(q_2\)</span> than for fixed <span class="math inline">\(p_2\)</span>. In other words, the factory manager is more price-sensitive about commodity <span class="math inline">\(1\)</span> when there is a free market for commodity <span class="math inline">\(2\)</span>, because there is a choice. After all, think like a factory manager. If I have no choice about how much of commodity <span class="math inline">\(2\)</span> I can put into production, I would have little resort when faced with a price hike on commodity <span class="math inline">\(1\)</span>. I will buy less of it, but I mostly just have to suffer the loss in profit. But if I have a choice with a free market for commodity <span class="math inline">\(2\)</span>, I would definitely buy more of commodity <span class="math inline">\(2\)</span> to substitute for some of commodity <span class="math inline">\(1\)</span> after the price hike.</p>
<p>This is Le Chatlier’s principle for economics, which Paul Samuelson used to great effect. In his telling, immediately after the market has suffered a sudden price shock, factories would have to suffer the consequences because they cannot react by changing their production plans. Thus, in the short run, factories are less price-sensitive. In the long run, the factories would be able to change their production plans, and so in the long run, factories are more price-sensitive. As another application, during a wartime economy when there is rationing for some critical products like rubber and oil, people would become less price-sensitive in all products that still remain on the free market.</p>
<p>This result can be generalized to the case of <span class="math inline">\(n\)</span> commodities <span class="math inline">\(q_1, \dots, q_n\)</span> with prices <span class="math inline">\(p_1, \dots, p_n\)</span>. In this case, we would find that, assuming some more complicated area ratio law, we can rescale <span class="math inline">\(q_2, \dots, q_n\)</span> and <span class="math inline">\(p_2, \dots, p_n\)</span>, such that <span class="math inline">\(\sum_i dp_i \wedge dq_i = 0\)</span>. This then allows us to construct a function <span class="math inline">\(S\)</span>, such that</p>
<p><span class="math display">\[dS - \sum_i p_i dq_i = 0\]</span></p>
<p>which, by a previous theorem, maximizes <em>like</em> an entropy. <a href="https://en.wikipedia.org/wiki/Duck_test">Therefore, it <em>is</em> the entropy.</a></p>
<p>This is what Paul Samuelson meant in his Nobel Prize lecture, when he said that the area ratio law implies something is being maximized. In thermodynamics, that something is negative Gibbs free entropy. In economics, that something is profit.</p>
</section>
</section>
<section id="bonus-riemannian-geometry" class="level3">
<h3 class="anchored" data-anchor-id="bonus-riemannian-geometry">Bonus: Riemannian geometry</h3>
<p>There are other ways to study the state space of thermodynamic systems by differential geometry. For example, since the entropy function is typically a strictly concave function of the extensive parameters, <span class="math inline">\(-\partial^2 S\)</span> is positive-definite. This is then a Riemannian metric on the state space. The only places where strict concavity fails is when <span class="math inline">\(S\)</span> is “bumped downwards”, which gives us a first-order phase transition, or has a flat region, which gives us a second-order phase transition. Away from regions of phase transition, we have a Riemannian geometry. In the regions of phase transitions, the geometry collapses into singularities, much as spacetime collapses in the center of a black hole.</p>
<p>For more on this line of research, search “Ruppeiner geometry” and “Weinhold geometry” <span class="citation" data-cites="weinholdThermodynamicsGeometry1976 quevedoGeometrothermodynamics2007">(<a href="#ref-weinholdThermodynamicsGeometry1976" role="doc-biblioref">Weinhold 1976</a>; <a href="#ref-quevedoGeometrothermodynamics2007" role="doc-biblioref">Quevedo 2007</a>)</span>.</p>
</section>
</section>
<section id="equilibrium-chemistry-done-right" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="equilibrium-chemistry-done-right">Equilibrium chemistry done right</h2>
<p>Gibbs wrote his landmark book, <em>On the Equilibrium of Heterogeneous Substances</em>, to answer one question: Why are some “heterogeneous substances” in equilibrium, while others not? Why, when we drop a block of salt into pure water, does the block of salt become smaller, but after a while, it stops getting smaller? His answer is always the same: heterogeneous substances are in equilibrium precisely when its entropy is maximized under constraint.</p>
<p>Samuelson wrote his landmark book, <em>Foundations of Economic Analysis</em>, to answer one question: Why are some economic systems in equilibrium, while others not? Why, when we drop a block of agents into a market, do they buy and sell things, but after a while, they stop buying and selling? His answer is always the same: a crowd of economic agents is in equilibrium precisely when some global parameter (which can be interpreted as utility, profit, etc, depending on context) is maximized under constraint.</p>
<section id="tragic-backstory" class="level3">
<h3 class="anchored" data-anchor-id="tragic-backstory">Tragic backstory</h3>
<p>I studied chemistry back then. Balancing equations was just linear algebra, and organic chemistry was just lego with long names. However, when it came to chemical thermodynamics, it completely defeated me.</p>
<p>Consider the simple reaction</p>
<p><span class="math display">\[
aA + bB \rightleftharpoons cC + dD
\]</span></p>
<p>The textbook said that at equilibrium, <span class="math inline">\(\Delta G = 0\)</span>, where</p>
<p><span class="math display">\[
\Delta G = \Delta G^\circ + RT \ln Q, \quad
Q = \frac{[C]^c [D]^d}{[A]^a[B]^b},
\]</span></p>
<p>At this point, I was lost. It is plain to see that <span class="math inline">\(Q\)</span> has units of <span class="math inline">\((\mathrm{~mol/L})^{c+d-a-b}\)</span>, and I knew from physics that you can never ever take the logarithm of something with a unit. What’s worse, <span class="math inline">\(\Delta G\)</span> has units of <span class="math inline">\(\mathrm{~J/mol}\)</span> when it obviously should have units of <span class="math inline">\(\mathrm{~J}\)</span>, because <span class="math inline">\(\Delta G\)</span> is just a difference in <span class="math inline">\(G\)</span>, and since <span class="math inline">\(G\)</span> is “Gibbs free energy”, both <span class="math inline">\(G\)</span> and <span class="math inline">\(\Delta G\)</span> should have the same units – of <span class="math inline">\(\mathrm{~J}\)</span>.</p>
<p>And it got even worse when I read on and found questions that asked me to calculate the “total Gibbs free energy released during the reaction”. I thought, well, since you end up at an equilibrium, and the textbook said that at equilibrium, <span class="math inline">\(\Delta G = 0\)</span>, obviously there is no total Gibbs free energy released. That is of course wrong.</p>
<p>At that point, I gave up trying to understand and simply practiced until I could solve the questions without understanding.</p>
<p>It certainly didn’t help when I kept seeing both <span class="math inline">\(\Delta G^\circ\)</span> and <span class="math inline">\(\Delta G^\ominus\)</span>, and sometimes even <span class="math inline">\(\Delta G^{\ominus}\)</span>, which is the “standard state” when the substance is a gas – but only for some gasses.</p>
<p>Point is, the notation is a complete mess, and the pedagogy is nonsensical. I believe it is because the teachers didn’t know any better. They did not understand what they were teaching, but they were protected from their ignorance by the rigidity of the world. Much like how most physicists do not understand Hamiltonian mechanics, but still manage to calculate correctly by their well-honed physical intuition, I would wager that most chemists do not understand thermodynamics, but still manage to calculate correctly by their well-honed chemical intuition.</p>
<p>After I finally understood thermodynamics, I turned my sights on chemical thermodynamics, and remembered this <span class="math inline">\(\Delta G\)</span> nonsense. I started with the idea “No matter what they say, one can’t possibly get the units wrong.” and got into a shouting match with ChatGPT-4, who kept mumbling about “fugacity” and “real gasses”. An hour of shouting later, I finally figured it out.</p>
<p>And repeating the same pattern, as soon as I unlearned this, I knew the right phrase to search, and discovered that this is a common error, the entire anatomy of which has been autopsied carefully <span class="citation" data-cites="raffSpontaneityEquilibriumWhy2014 raffSpontaneityEquilibriumII2014 raffSpontaneityEquilibriumIII2014">(<a href="#ref-raffSpontaneityEquilibriumWhy2014" role="doc-biblioref">Raff 2014a</a>, <a href="#ref-raffSpontaneityEquilibriumII2014" role="doc-biblioref">2014b</a>, <a href="#ref-raffSpontaneityEquilibriumIII2014" role="doc-biblioref">2014c</a>)</span>. Truly, the teaching of STEM is so bad that what has been unlearned has to be unlearned anew every generation…</p>
</section>
<section id="equilibrium-of-a-single-gas-or-a-single-solution" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="equilibrium-of-a-single-gas-or-a-single-solution">Equilibrium of a single gas or a single solution</h3>
<div class="callout callout-style-default callout-tip callout-titled" title="Gibbs vs Helmholtz">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Gibbs vs Helmholtz
</div>
</div>
<div class="callout-body-container callout-body">
<p>We study the case of a reaction chamber held under constant volume and temperature, which one can picture as a sealed glass tube in an ice-water bath. Everything still applies when the reaction chamber has constant pressure as well. For example, this happens if we have a flaccid plastic bag at the bottom of the ocean. The inside of the plastic bag would have constant temperature and pressure.</p>
<p>Every result in this section can be direct translated to that case, by replacing “Helmholtz” with “Gibbs”.</p>
</div>
</div>
<p>Let’s start with an example: <span class="math inline">\(2 NO_2 \rightleftharpoons N_2O_4\)</span>, the dimerization of nitrogen dioxide in a sealed tube.</p>
<p>The thermodynamic system is some <span class="math inline">\(NO_2\)</span> and <span class="math inline">\(N_2O_4\)</span>. The system is sealed in a glass tube of constant volume <span class="math inline">\(V\)</span>, bathing in a water-ice mixture of temperature <span class="math inline">\(T\)</span>.</p>
<p>The thermodynamic state of the system is fully known if we know the number of moles for each species: <span class="math inline">\(n_{NO_2}, n_{N_2O_4}\)</span>.</p>
<p>The system undergoes a single reaction <span class="math display">\[2 NO_2 \rightleftharpoons N_2O_4\]</span></p>
<p>Suppose we start the system at state <span class="math inline">\(n_{NO_2, 0}, n_{N_2O_4, 0}\)</span>. When does the system reach equilibrium? Since the system can exchange energy, but not volume, with the surrounding bath, it reaches equilibrium when the system reaches minimal Helmholtz free energy under constraint: <span class="math display">\[
\begin{cases}
\min_{n_{NO_2}, n_{N_2 O_4}} F(T, V, n_{NO_2}, n_{N_2O_4})\\
(n_{NO_2} - n_{NO_2, 0}) = -2 \xi\\
(n_{N_2O_4} - n_{NO_2, 0})  = \xi
\end{cases}
\]</span></p>
<p>where we write <span class="math inline">\(\xi\)</span> as the <strong>extent of reaction</strong>, that is, the number of moles of reactions that has taken place.</p>
<p>Differentiating the two equations, and setting <span class="math inline">\(dV, d\beta = 0\)</span>, we have</p>
<p><span class="math display">\[
\begin{cases}
dF = \mu_{NO_2} dn_{NO_2} + \mu_{N_2O_4} dn_{N_2O_4} \\
dn_{NO_2} = -2d\xi \\
dn_{N_2O_4} = d\xi
\end{cases}
\]</span></p>
<p>At equilibrium, <span class="math inline">\(dF = 0\)</span> under all possible constrained variations, giving us the condition of equilibrium: <span class="math display">\[-2\mu_{NO_2} + \mu_{N_2 O_4} = 0\]</span></p>
<p>We may vary both starting conditions <span class="math inline">\(n_{NO_2, 0}\)</span> and <span class="math inline">\(n_{N_2O_4, 0}\)</span>, and for each starting condition, the system would equilibrate at the solution to</p>
<p><span class="math display">\[
\begin{cases}
-2\mu_{NO_2} (T, V, n_{NO_2}, n_{N_2O_4}) + \mu_{N_2 O_4}(T, V, n_{NO_2}, n_{N_2O_4}) = 0 \\
(n_{NO_2} - n_{NO_2, 0}) = -2 \xi\\
(n_{N_2O_4} - n_{NO_2, 0})  = \xi
\end{cases}
\]</span></p>
<p>which has exactly the same number of unknowns and equations, so in general it should have a solution.</p>
<p>The state space of the system has 2 dimensions: <span class="math inline">\(n_{NO_2}\)</span> and <span class="math inline">\(n_{N_2 O_4}\)</span>. Starting at any point in the state space, the system can move on a single line, and it would equilibrate at exactly the point at which its Helmholtz energy is minimized. We can find the point of equilibrium by drawing the surfaces of constant Helmholtz free energy, and find the tangent point, as pictured.</p>
<p>Economic interpretation</p>
<p>Economically speaking, the situation is precisely equivalent to the standard first problem in consumer theory: Given a consumer with a finite budget and a market for two goods, what would they buy from the market to maximize their utility? (They must spend all their budget.)</p>
<p>The answer, as we can see in the diagram, is the tangent point of the straight line of constant budget with the curved lines of constant utility.</p>
<p>To anthropomorphize the situation, we can say that the reaction chamber is a consumer, trying to maximize its Helmholtz free entropy under the “budgetary constraint” of <span class="math inline">\(2 NO_2 \rightleftharpoons N_2O_4\)</span>.</p>
<p>Existence and uniqueness</p>
<p>By looking at the picture, we see that obviously, at least one solution exists.</p>
<p>In most situations, the Helmholtz free energy is strictly concave, so the lines of constant <span class="math inline">\(F\)</span> are also strictly concave, and so the solution is unique on each line.</p>
<p>Edge case: reaction reaches completion</p>
<p>The solution might fall on one of the axes, in which case the reaction reaches completion, and so it is not a reversible reaction. Economically speaking, it is like when you are poor enough, you might spend all your money buying noodles, and none buying bread.</p>
<p>Edge case: first-order phase transition</p>
<p>If <span class="math inline">\(F\)</span> is not strictly concave, then it might have a double tangent point with the budget line. On that critical budget, there is a first-order phase transition. The system spontaneously splits into two phases, with one side denser in species 1, and the other side denser in species 2. It could look like a mixture of water and oil suddenly condensing into two layers, with one part mostly water and the other part mostly oil.</p>
<p>We can imagine adding in a little more of both chemicals at a time into a tube. Below the critical concentration, it is in the phase denser in species 1, above the critical concentration, it is in the phase denser in species 2. Right at the critical concentration, the system splits into two parts, with phase 1 shrinking while the phase 2 growing, until phase 2 takes over the entire tube. Just like the case with boiling water, where temperature remains constant as water turns to steam, in this case, pressure remains constant while phase 1 turns to phase 2.</p>
<p>Economically speaking, if we have many households with the same utility function and budget, then at a critical budget level, the households would spontaneously split into two types, with the first type buying mostly bread, and the second type buying mostly noodles.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/raff_2014_fig_2.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The reaction chamber is a sealed glass tube held under constant temperature of 298.15 K. It has the following <span class="math inline">\(\xi, H\)</span> curve. At the <span class="math inline">\(\xi = 0\)</span> side, the tube contains 2 moles of <span class="math inline">\(NO_2\)</span>, and at the <span class="math inline">\(\xi = 1 \mathrm{~mol}\)</span> side, the tube contains 1 mole of <span class="math inline">\(N_2O_4\)</span>. <span class="citation" data-cites="raffSpontaneityEquilibriumWhy2014">(<a href="#ref-raffSpontaneityEquilibriumWhy2014" role="doc-biblioref">Raff 2014a, fig. 2</a>)</span></figcaption>
</figure>
</div>
<p>Now let’s consider another example, where we have two simultaneous reactions. This is a simplified version of the NOx reactions, which is a source of air pollution.</p>
<p>Consider a system with the following reactions:</p>
<ol type="1">
<li><span class="math inline">\(2NO + O_2 \rightleftharpoons 2NO_2\)</span></li>
<li><span class="math inline">\(NO + NO_2 \rightleftharpoons N_2O_3\)</span></li>
</ol>
<p>The system is in a container with constant volume <span class="math inline">\(V\)</span> and temperature <span class="math inline">\(T\)</span>. Let <span class="math inline">\(n_i\)</span> represent the number of moles of species <span class="math inline">\(i\)</span>. The thermodynamic state of the system is fully described by the 4-component vector <span class="math inline">\(\vec n = (n_{O_2}, n_{NO}, n_{NO_2}, n_{N_2O_3})\)</span>.</p>
<p>To make the algebra look cleaner, we rewrite them as follows: 1. <span class="math inline">\(0 \rightleftharpoons -O_2 - 2 NO + 2NO_2 + 0 N_2 O_3\)</span> 2. <span class="math inline">\(0 \rightleftharpoons  0 O_2 -NO - NO_2 + N_2O_3\)</span></p>
<p>We see that each reaction can be written as a single vector. The first has vector <span class="math inline">\(\vec n_1 = (-1, -2, 2, 0)\)</span>, and the second has vector <span class="math inline">\(\vec n_2 = (0, -1, -1, 1)\)</span>.</p>
<p>Each reaction has an associated extent of reaction, denoted by <span class="math inline">\(\xi_1\)</span> and <span class="math inline">\(\xi_2\)</span> respectively. Changes in the number of moles for each species are related to the extents of reaction:</p>
<ul>
<li><span class="math inline">\(dn_{NO} = -2d\xi_1 - d\xi_2\)</span></li>
<li><span class="math inline">\(dn_{O_2} = -d\xi_1\)</span></li>
<li><span class="math inline">\(dn_{NO_2} = 2d\xi_1 - d\xi_2\)</span></li>
<li><span class="math inline">\(dn_{N_2O_3} = d\xi_2\)</span></li>
</ul>
<p>At equilibrium, the Helmholtz free energy <span class="math inline">\(F(T, V, \vec{n})\)</span> is minimized under the constraints imposed by the reactions. This leads to the following conditions:</p>
<ul>
<li><span class="math inline">\(-2\mu_{NO} - \mu_{O_2} + 2\mu_{NO_2} = 0\)</span> (from reaction 1)</li>
<li><span class="math inline">\(-\mu_{NO} - \mu_{NO_2} + \mu_{N_2O_3} = 0\)</span> (from reaction 2) and more succinctly, we have</li>
</ul>
<p><span class="math display">\[\vec \mu \cdot \vec n_j = 0, \quad j = 1, 2\]</span></p>
<p>where <span class="math inline">\(\vec \mu = (\mu_{O_2}, \mu_{NO}, \mu_{NO_2}, \mu_{N_2O_3})\)</span> is the vector of chemical potentials.</p>
<p>Starting at any initial chemical composition of <span class="math inline">\(\vec n_0\)</span>, the space of all possible chemical compositions reachable from <span class="math inline">\(\vec n_0\)</span> is a 2-dimensional subset. That is, it is the set of <span class="math inline">\(\vec n\)</span> satisfying</p>
<p><span class="math display">\[
\begin{cases}
\vec n = \vec n_0  + \xi_1 \vec n_1+ \xi_2 \vec n_2,  \\
\vec n \geq 0
\end{cases}
\]</span></p>
<p>Geometrically speaking, the subset is the intersection between a 2-dimensional plane and a 4-dimensional pyramid, so it generally looks like either a triangle or a quadrilateral. On this subset, the Helmholtz free energy function looks like a sequence of nested convex shells, and the point of tangency is the equilibrium point.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/Helmholtz_contour_multireaction.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The lines are the 3-dimensional contour surfaces of constant Helmholtz free energy, intersected with the 2-dimensional feasible set. The point of tangency is the point of chemical equilibrium.</figcaption>
</figure>
</div>
<p>Interpreted economically, this is the case of a consumer that maximizes its utility under two simultaneous budgetary constraints (because the budget set is a 2-dimensional, not 3-dimensional, subset of <span class="math inline">\(\R^4\)</span> ). Perhaps the consumer is trading with a market that simultaneously uses two kinds of currencies – <a href="https://en.wikipedia.org/wiki/Bimetallism">bimetallism</a>?</p>
<p>Generalizing from the above two experiences, we immediately obtain the following theorem.</p>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 12 (existence and uniqueness of chemical equilibrium, at constant volume and temperature)</strong></span> Consider a sealed reaction chamber held in an energy bath, so that both the price of energy <span class="math inline">\(\beta\)</span>, and the volume <span class="math inline">\(V\)</span>, of the system is fixed.</p>
<p>The system contains a homogenous mixture of chemical species <span class="math inline">\(A_1, \dots, A_k\)</span>, which might undergo the following <span class="math inline">\(r\)</span> possible chemical reactions: <span class="math display">\[
0  \rightleftharpoons \sum_i a_{ij} A_i, \quad j = 1, 2, \dots, r
\]</span></p>
<p>The necessary condition for chemical equilibrium is</p>
<p><span class="math display">\[
\vec \mu \cdot \vec n_j = 0, \quad \forall j = 1, 2, \dots, r
\]</span></p>
<p>where <span class="math inline">\(\vec n_j = (a_{1, j}, \dots, a_{k, j})\)</span> is the vector representing the <span class="math inline">\(j\)</span> -th chemical reaction.</p>
<p>The condition is also sufficient if the Helmholtz free energy is strictly concave.</p>
<p>If <span class="math inline">\(F\)</span> is not strictly concave, then there could be multiple coexisting equilibrium, which gives us a first-order phase transition.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Existence: <span class="math inline">\(F\)</span> is continuous, so it has at least one minimum on every compact set.</p>
<p>Uniqueness: any local minimum of a strictly concave function is the unique global minimum.</p>
</div>
</div>
</div>
<p>For example, for the same reaction of <span class="math inline">\(NO_2\)</span> dimerization, now put into a flabby plastic bag held under constant temperature of 298.15 K and constant pressure of 1 atm, produces the following <span class="math inline">\(\xi, G\)</span> curve. At the <span class="math inline">\(\xi = 0\)</span> side, the bag contains 2 moles of <span class="math inline">\(NO_2\)</span>, and at the <span class="math inline">\(\xi = 1 \mathrm{~mol}\)</span> side, the bag contains 1 mole of <span class="math inline">\(N_2O_4\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/raff_2014_fig_4.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The reaction chamber is a flabby plastic bag held under constant temperature of <span class="math inline">\(298.15 \mathrm{~K}\)</span> and constant pressure <span class="math inline">\(1 \mathrm{~atm}\)</span>. It has the following <span class="math inline">\(\xi, G\)</span> curve. At the <span class="math inline">\(\xi = 0\)</span> side, the tube contains <span class="math inline">\(2 \mathrm{~mol}\)</span> of <span class="math inline">\(NO_2\)</span>, and at the <span class="math inline">\(\xi = 1 \mathrm{~mol}\)</span> side, the tube contains <span class="math inline">\(1 \mathrm{~mol}\)</span> of <span class="math inline">\(N_2O_4\)</span>. <span class="citation" data-cites="raffSpontaneityEquilibriumWhy2014">(<a href="#ref-raffSpontaneityEquilibriumWhy2014" role="doc-biblioref">Raff 2014a, fig. 4</a>)</span></figcaption>
</figure>
</div>
<p>Now, we can <em>finally</em> answer the problem that defeated me in the past: What is, after all, the Gibbs free energy released per mole of reaction? The answer is in the following diagram:</p>
<p><span class="math display">\[\Delta G = \int_0^1 (\partial_\xi G)_{T, P} d\xi\]</span></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/glasser_2016_fig_1.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The true meaning of <span class="math inline">\(\Delta G\)</span> is the difference in height of the curve on two ends of the <span class="math inline">\((\xi, G)\)</span> curve. <span class="citation" data-cites="glasserCorrectUseHelmholtz2016">(<a href="#ref-glasserCorrectUseHelmholtz2016" role="doc-biblioref">Glasser 2016, fig. 1</a>)</span></figcaption>
</figure>
</div>
<p>Such a situation occurs, for example, in the Haber–Bosch industrial method for producing ammonia: <span class="math inline">\(N_2 + 3H_2 \to 2NH_3\)</span>. In the HB method, room-temperature (25 <span class="math inline">\(^\circ C\)</span> ) and room-pressure (1 atm) nitrogen and hydrogen continuously pipe into the chamber, and ammonia is continuously extracted out of the chamber by cooling liquefaction. When the reaction chamber is operating at a stable state, the energy released per mole of reaction is <span class="math inline">\(\Delta G = -32.8 \mathrm{~kJ/mol}\)</span>, as one can calculate from a table of chemical thermodynamics <span class="citation" data-cites="glasserCorrectUseHelmholtz2016">(<a href="#ref-glasserCorrectUseHelmholtz2016" role="doc-biblioref">Glasser 2016</a>)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/glasser_2016_fig_2.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The reaction chamber, demonstrating the concrete meaning of <span class="math inline">\(\Delta G\)</span>. <span class="citation" data-cites="glasserCorrectUseHelmholtz2016">(<a href="#ref-glasserCorrectUseHelmholtz2016" role="doc-biblioref">Glasser 2016, fig. 2</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="practical-considerations" class="level3">
<h3 class="anchored" data-anchor-id="practical-considerations">Practical considerations</h3>
<p>The above is all correct, and geometrical. If we were to be like Gibbs, then we would dust off our hands, for there is nothing left to do (well, except the theory of phase transitions). Unfortunately, chemistry is not merely applied geometry, so there is still something left to do.</p>
<section id="defining-the-standard-states" class="level4">
<h4 class="anchored" data-anchor-id="defining-the-standard-states">Defining the standard states</h4>
<p>A <strong>chemical environment</strong> is defined by chemical species <span class="math inline">\(A_1, \dots, A_m\)</span>.</p>
<p>A <strong>standard state</strong> for a chemical environment is defined by a reference pressure <span class="math inline">\(P^\circ\)</span>, and reference chemical molarities <span class="math inline">\([A_1]^\circ, \dots, [A_m]^\circ\)</span> for each of the the chemical species.</p>
<p>Given a standard state for a chemical environment, for any temperature <span class="math inline">\(T\)</span>, and any chemical molarities <span class="math inline">\([A_1], \dots, [A_m]\)</span>, the <strong>chemical activity</strong> of the chemical species <span class="math inline">\(A_i\)</span> in this particular context is</p>
<p><span class="math display">\[\{A_i\} := e^{\frac{\mu_i - \mu_i^\circ}{RT}}\]</span></p>
<p>where <span class="math inline">\(\mu_i\)</span> is the chemical potential of species <span class="math inline">\(A_i\)</span> at that state. That is,</p>
<p><span class="math display">\[\mu_i = (\partial_{n_i} G)|_{T, P, [A_1], \dots, [A_m]}\]</span></p>
<p>and <span class="math inline">\(\mu_i^\circ\)</span> is the chemical potential of species <span class="math inline">\(A_i\)</span> at the standard state:</p>
<p><span class="math display">\[\mu_i^\circ = (\partial_{n_i} G)|_{T, P^\circ, [A_1]^\circ, \dots, [A_m]^\circ}\]</span></p>
<p>Given a chemical reaction <span class="math inline">\(0 \rightleftharpoons \sum_i a_i A_i\)</span>, its <strong>reaction quotient</strong> is</p>
<p><span class="math display">\[
Q = \prod_i \{A_i\}^{a_i}
\]</span></p>
<p>where <span class="math inline">\(a_i\)</span> is the stoichiometric number of chemical species <span class="math inline">\(A_i\)</span>. For example, with <span class="math inline">\(aA + bB \rightleftharpoons cC + dD\)</span>, its reaction quotient is <span class="math display">\[
Q = \frac{\{C\}^c\{D\}^d}{\{A\}^a\{B\}^b}
\]</span></p>
</section>
<section id="fundamental-theorem-of-chemical-equilibrium" class="level4">
<h4 class="anchored" data-anchor-id="fundamental-theorem-of-chemical-equilibrium">Fundamental theorem of chemical equilibrium</h4>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13 (fundamental theorem of chemical equilibrium)</strong></span> Given any chemical reaction <span class="math inline">\(0 \rightleftharpoons \sum_i a_i A_i\)</span>, any standard state, and any temperature, <span class="math display">\[\begin{cases}
(\partial_\xi F)_{T, V} &amp;= (\partial_\xi F)_{T, V}^\circ + RT \ln Q \\
(\partial_\xi G)_{T, P} &amp;= (\partial_\xi G)_{T, P}^\circ + RT \ln Q
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(\xi\)</span> is the extent of reaction, and <span class="math inline">\(Q\)</span> is its reaction quotient.</p>
<p>If the system has <span class="math inline">\(r\)</span> possible reactions, then we similarly have <span class="math display">\[\begin{cases}
(\partial_{\xi_j} F)_{T, V} &amp;= (\partial_{\xi_j} F)_{T, V}^\circ + RT \ln Q_j \\
(\partial_{\xi_j} G)_{T, P} &amp;= (\partial_{\xi_j} G)_{T, P}^\circ + RT \ln Q_j
\end{cases}
\]</span></p>
<p>for each reaction <span class="math inline">\(j = 1, 2, \dots, r\)</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{aligned}
(\partial_\xi F)_{T, V} &amp;= \sum_i (\partial_\xi n_i) (\partial_{n_i} F)_{T, V, \vec n} \\
&amp;= \sum_i a_i \mu_i \\
&amp;= \sum_i a_i (\mu_i^\circ + RT \ln \{A_i\}) \\
&amp;= \sum_i a_i (\mu_i^\circ) + RT \ln \left(\prod_i \{A_i\}^a_i\right) \\
&amp;= (\partial_\xi F)_{T, V}^\circ + RT \ln Q
\end{aligned}\]</span></p>
<p>The proof for the other equations are very similar.</p>
</div>
</div>
</div>
<div id="cor-0" class="theorem corollary">
<p><span class="theorem-title"><strong>Corollary 2 (equilibrium coefficient)</strong></span> At equilibrium, <span class="math display">\[
(\partial_\xi G)_{T, P} = 0
\]</span></p>
<p>which is equivalent to <span class="math display">\[
Q = K_{eq}, \quad K_{eq} := e^{-\frac{(\partial_\xi G)_{T, P}^\circ}{RT}}
\]</span></p>
<p>and similarly for the other case.</p>
</div>
<p>The above equations are what my teachers meant when they thoughtlessly wrote</p>
<p><span class="math display">\[\Delta G = 0, \quad K_{eq} = e^{-\frac{\Delta G^\circ}{RT}}\]</span></p>
<p>This, finally, answers my great confusion back then. Now everything makes sense, and life is beautiful.</p>
</section>
<section id="ideal-gas-like-chemistry" class="level4">
<h4 class="anchored" data-anchor-id="ideal-gas-like-chemistry">Ideal-gas-like chemistry</h4>
<p>Well, if this is all there is, then a mathematician would be able to solve any problem in analytical chemistry. Unfortunately, analytical chemistry is not about proving theorems, but about actually getting numerical answers, and numerical answers require numerical values for chemical activities.</p>
<p>There are generally three cases:</p>
<ol type="1">
<li>We have a mixture of dilute gasses, or dilute solvents in an inert solution, such that the ideal gas law is almost true.</li>
<li>Ideal gas law fails.</li>
<li>We are not even dealing with gasses and solutions anymore.</li>
</ol>
<p>The first case is typically what is taught by a first course in analytical chemistry, and since this is typically taught to non-mathematicians by non-mathematicians for non-mathematicians, the logical structure is quite upside-down and confusing to a mathematician.</p>
<p>We will now prove the first case rigorously.</p>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 14 (activity of ideal gas mixtures)</strong></span> For any temperature <span class="math inline">\(T\)</span> and any two pressures <span class="math inline">\(P, P^\circ\)</span>, by the ideal gas laws, the chemical potential of the chemical species satisfies the equation</p>
<p><span class="math display">\[\mu(T, P) = \mu(T, P^\circ) + RT \ln\frac{P}{P^\circ}\]</span></p>
<p>and so its activity is <span class="math inline">\(\frac{P}{P^\circ}\)</span>.</p>
<p>In a mixture of ideal gasses, the gasses do not interact, and so the activity of chemical species <span class="math inline">\(A_i\)</span> is <span class="math inline">\(\{A_i\} = \frac{P_i}{P_i^\circ}\)</span>, where <span class="math inline">\(P_i\)</span> is the partial pressure of species <span class="math inline">\(A_i\)</span> in the mixed gas, and <span class="math inline">\(P_i^\circ\)</span> is the standard pressure for species <span class="math inline">\(A_i\)</span>.</p>
<p>In a dilute solution, if the solvent behaves like a mixture of ideal gasses, then</p>
<p><span class="math display">\[\mu(T, P) \approx \mu(T, P^\circ) + RT \ln \frac{[A_i]}{[A_i]^\circ} \approx \mu(T, P^\circ) + RT \ln \frac{m_{A_i}}{m_{A_i}^\circ}\]</span></p>
<p>where <span class="math inline">\([A_i]\)</span> is the mole-per-volume of <span class="math inline">\(A_i\)</span>, and <span class="math inline">\(m_{A_i}\)</span> is the mole-per-mass of <span class="math inline">\(A_i\)</span>.</p>
<p>The chemical activity simplifies into the familiar form:</p>
<p><span class="math display">\[\{A\} \approx \frac{[A]}{[A]^\circ} \approx \frac{m_A}{m_A^\circ}\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It suffices to prove the case for a pure ideal gas, as the other cases are simple corollaries.</p>
<p>By the ideal gas law, the chemical potential is</p>
<p><span class="math display">\[\mu = -TS/n\]</span></p>
<p>which is a state property. Expressed as a function of <span class="math inline">\(T, P\)</span>, <span class="math display">\[\mu(T, P) = RT \ln\frac{P/T^{\hat c_V + 1}}{C}\]</span></p>
<p>for an arbitrary constant <span class="math inline">\(C\)</span>.</p>
<p>Thus, for any <span class="math inline">\(T, P, P^\circ\)</span>, we have</p>
<p><span class="math display">\[\mu(T, P) = \mu(T, P^\circ) + RT \ln\frac{P}{P^\circ}\]</span></p>
</div>
</div>
</div>
<div id="exm-0" class="theorem example">
<p><span class="theorem-title"><strong>Example 3</strong></span> The pH value of a solution is not <span class="math inline">\(pH = -\log_{10} [H^+]\)</span>, which has the wrong units. It is not even <span class="math inline">\(pH = -\log_{10} \frac{[H^+]}{[H^+]^\circ}\)</span>, since the <span class="math inline">\(H^+\)</span> particles might not behave like an ideal gas. The actually correct definition is <span class="citation" data-cites="mccartyPHParadoxesDemonstrating2006">(<a href="#ref-mccartyPHParadoxesDemonstrating2006" role="doc-biblioref">McCarty and Vitz 2006</a>)</span></p>
<p><span class="math display">\[pH = -\log_{10}  \{H^+\}\]</span></p>
</div>
</section>
<section id="fugacity" class="level4">
<h4 class="anchored" data-anchor-id="fugacity">Fugacity</h4>
<p>For real gases and real solutions, the chemical activity might deviate significantly from the above approximation. In this case, we typically have no recourse except by checking a table of chemical thermodynamics. They typically don’t directly write down the chemical activities, but <a href="https://en.wikipedia.org/wiki/Fugacity"><em>fugacity coefficients</em></a>. There is nothing particularly deep about fugacity – it is basically about rescaling the numbers to make the tables easier to make.</p>
<p>Recall that the chemical potential of an ideal gas satisfies <span class="math inline">\(\mu(T, P) = RT \ln\frac{P/T^{\hat c_V + 1}}{C}\)</span>, where <span class="math inline">\(C\)</span> is a constant for this gas. For a real gas, this equation only holds approximately, so we define the <strong>fugacity</strong> <span class="math inline">\(f\)</span> as a function of <span class="math inline">\(T, P\)</span>, such that <span class="math display">\[\mu(T, P) = RT \ln\frac{f/T^{\hat c_V + 1}}{C}\]</span></p>
<p>In other words, <span class="math inline">\(f(T, P) = P \phi(T, P)\)</span>, where</p>
<p><span class="math display">\[\phi(T, P) = e^{\frac{\mu(T, P) - \mu_{ideal}(T, P)}{RT}}\]</span></p>
<p>is the <strong>fugacity coefficient</strong>.</p>
<p>Plugging them back to the definition of activity,</p>
<p><span class="math display">\[\{A\} = \frac{f}{f^\circ} = \frac{\phi P}{\phi^\circ P^\circ}\]</span></p>
<p>And so, by checking a table of fugacity coefficients, chemical engineers can balance chemical reactions of real gasses, even far from ideality.</p>
<div class="callout callout-style-default callout-warning callout-titled" title="Standard state">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Standard state
</div>
</div>
<div class="callout-body-container callout-body">
<p>Despite what the name “standard” might imply, a chemical species has infinitely many standard states. For example, pure gaseous oxygen has many different standard states – one for each temperature. We have a standard state at <span class="math inline">\(T = 300\mathrm{~K}\)</span> defined by <span class="math inline">\([O_2] = 1 \mathrm{~mol/L}\)</span>, and another at <span class="math inline">\(T = 350\mathrm{~K}\)</span> defined by <span class="math inline">\([O_2] = 1 \mathrm{~mol/L}\)</span>, etc.</p>
<p>Despite what the name “standard” might imply, different chemists have different standards. For example, among the biochemists, the standard state for <span class="math inline">\(H^+\)</span> in water is <span class="math inline">\([H^+]^\circ = 10^{-7} \mathrm{~mol/L}\)</span>, but among the inorganic chemists, it is <span class="math inline">\([H^+]^\circ = 1 \mathrm{~mol/L}\)</span>. The reason is that bodily fluids typically have <span class="math inline">\([H^+] \sim 10^{-7} \mathrm{~mol/L}\)</span>.</p>
<p>Despite what the name “standard temperature and pressure (STP)” might imply, it is not a “standard state”, because a “standard state” of any substance does not specify its temperature.</p>
</div>
</div>
<p>The point of having a standard state is like taking an electric circuit, and pointing at one point of it and say, “This is where the voltage is zero”. The point is to allow relative comparisons between states, within the context of a <em>single</em> reaction. Consequently, even for a single chemical species, we can take a different standard state if we are studying a different reaction involving the species, or the same reaction in a different context.</p>
<p>For example, if we are studying the reaction <span class="math inline">\(NO_2 \rightleftharpoons N_2 O_4\)</span> in a glass tube drenched in an ice-water bath, then we would take as our standard state <span class="math display">\[T^\circ = 273.15 K, \quad [NO_2]^\circ = 1 \mathrm{~mol/L}, \quad [N_2 O_4]^\circ = 1 \mathrm{~mol/L}\]</span></p>
<p>For a chemical in pure gaseous form, a standard state is specified by two out of three parameters: molarity <span class="math inline">\([A] = \frac{n}{V}\)</span>, pressure <span class="math inline">\(P\)</span>, temperature <span class="math inline">\(T\)</span>. We must never specify all three of them, because otherwise we would break the equation of state. For example, imagine what happens when you specify that the “standard state of ideal gas” is</p>
<p><span class="math display">\[T^\circ = 273.15 \mathrm{~K}, P^\circ = 10^5 \mathrm{~Pa}, [A]^\circ = 1 \mathrm{~mol/L}\]</span></p>
<p>because they would violate the ideal gas law <span class="math display">\[P = [A]RT\]</span></p>
<p>For non-ideal gas, we still have an equation of state between <span class="math inline">\(P, [A], T\)</span>, meaning that we still must specify exactly two, no more and no less.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Intensive quantities">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Intensive quantities
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why is a standard state defined by intensive quantities like temperature, pressure, or molarity? Why isn’t it defined by extensive quantities like volume, mass, and moles?</p>
<p>The short answer: because classical thermodynamics only studies systems with extensive entropies. For those systems, chemical equilibrium is determined by intensive quantities.</p>
<p>Like classical thermodynamics, and neoclassical economics, the idea of a standard state is fully committed to the idea of <em>homogeneous</em> substances. In classical thermodynamics, a cube of iron and a ball of iron are the same. A jar of water and a tank of water are the same. It does not matter what their shapes are. Moreover, two jars of water side-by-side is the same as one large jar of water. In neoclassical economics, a crowd of factories is the same as two small crowds of factories put together. They are all chunks of homogeneous stuffs.</p>
<p>If it were not the case, then we would be unable to say that a standard state is defined by just its temperature and “moles-per-liter” of each chemical species. We would be forced to also specify a standard state volume <span class="math inline">\(V^\circ\)</span>. It’s conceivable that even the shape of the reaction chamber matters. We would then be forced to specify a standard shape, perhaps a box with side lengths <span class="math inline">\(0.1 \mathrm{~m}\)</span>. But in this extreme case, perhaps we have already left the realm of chemistry.</p>
</div>
</div>
</section>
<section id="iuapcs-definition-of-standard-state" class="level4">
<h4 class="anchored" data-anchor-id="iuapcs-definition-of-standard-state">IUAPC’s definition of “standard state”</h4>
<p>I have found that the <a href="https://en.wikipedia.org/wiki/International_Union_of_Pure_and_Applied_Chemistry">IUAPC</a>’s definition of the “standard state” <span class="citation" data-cites="coxNotationStatesProcesses1982">(<a href="#ref-coxNotationStatesProcesses1982" role="doc-biblioref">Cox 1982</a>)</span> to be precise and clarifying, though it is quite ponderous, so I summarize it as follows:</p>
<ul>
<li>The standard state for a gaseous substance, whether pure or mixed, is the substance at <span class="math inline">\(P^\circ\)</span> and in a (hypothetical) state in which it exhibits ideal-gas behaviour, where <span class="math inline">\(P^\circ\)</span> is an arbitrarily fixed standard-state pressure.</li>
<li>The standard state for a pure liquid or solid substance is the pure substance at <span class="math inline">\(P^\circ\)</span>.</li>
<li>The above definitions of standard states make no reference to fixed temperature. Hence, it is possible to have an infinite number of standard states of a substance as the temperature varies. But generally it is more convenient to complete the definition of the standard state in a particular context by choosing for the reference temperature one of a relatively small number of values, e.g., zero, <span class="math inline">\(273.15 \mathrm{~K}, 293.15 \mathrm{~K}, 298.15 \mathrm{~K}\)</span>.</li>
<li>Since <span class="math inline">\(T^{\circ}\)</span> should mean a standard temperature <strong>in general</strong>, the use of <span class="math inline">\(T^{\circ}\)</span> to mean exclusively <span class="math inline">\(298.15 \mathrm{~K}\)</span> is <strong>strongly discouraged</strong>.</li>
<li>For application of the concept of standard state to substances in admixture (solutions and mixtures), <strong>the composition of the system, as well as the pressure</strong>, must be defined. As one example for solutions, the standard-state molality, written as <span class="math inline">\(m^\circ\)</span> for the general case, is to be defined; customarily <span class="math inline">\(m^\circ\)</span> is taken as <span class="math inline">\(1 \mathrm{~mol/kg}\)</span>.</li>
</ul>
</section>
</section>
</section>
<section id="phase-equilibrium" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="phase-equilibrium">Phase equilibrium</h2>
<p>Several times, we have found some curious examples where a non-concavity in entropy leads to a jump of some kind. These are all examples of first-order phase equilibrium.</p>
<section id="two-phases-of-a-gas-in-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="two-phases-of-a-gas-in-equilibrium">Two phases of a gas in equilibrium</h3>
<p>Consider a generic gas, whose entropy function is of form <span class="math inline">\(S(U, V, N)\)</span>. If we confine it in a sealed tube, and slowly heat it up, then its entropy would trace out the curve</p>
<p><span class="math display">\[U \mapsto S(U, V, N)\]</span></p>
<p>Now, the inverse temperature <span class="math inline">\(\beta\)</span> of the system is the slope, which should decrease as <span class="math inline">\(U\)</span> increases, so the entropy curve should be strictly concave.</p>
<p>If there is a bump in the middle, then we have a serious problem: as we heat up the gas, its temperature would <em>decrease</em> for a while before increasing again! This clearly is a thermodynamic instability, and suggests to us that our model has broken down. Where is the breakdown?</p>
<p>The breakdown is that we assumed our system remains one thermodynamic substance, when it can split into two. Suppose then, the substance splits into two, like a large company splits into two subsidiaries under a common conglomerate. How would the manager maximize the total value of the conglomerate?</p>
<p><span class="math display">\[
\begin{cases}
\max S_1(U_1, V_1, N_1) + S_2(U_2, V_2, N_2) \\
U_1 + U_2 = U \\
V_1 + V_2 = V \\
N_1 + N_2 = N
\end{cases}
\]</span></p>
<p>where we, instead of writing <span class="math inline">\(S(U_1, V_1, N_1) + S(U_2, V_2, N_2)\)</span>, write <span class="math inline">\(S_1(U_1, V_1, N_1) + S_2(U_2, V_2, N_2)\)</span>, to emphasize that we now have two thermodynamic systems that might have very different behavior, like water vs ice.</p>
<p>Differentiating, we find that the marginal value of each asset is equal in both subsidiaries, as we would expect</p>
<p><span class="math display">\[
\begin{cases}
\beta_1 = \beta_2,\\ \beta_1 P_1 = \beta_2 P_2, \\-\beta_1 \mu_1 = -\beta_2 \mu_2
\end{cases}
\]</span></p>
<p>That is, the two lumps of substances have the same temperature, pressure, and chemical potential.</p>
<p>Since both sides have the same temperature and pressure, it is cleaner to change to Gibbs free energy, yielding: <span class="math display">\[(\partial_{N} G_1)_{T, P}(T, P, N_1) = (\partial_{N} G_2)_{T, P} (T, P, N_2)\]</span></p>
<div id="warn-diamond-water-paradox" class="callout callout-style-default callout-warning callout-titled" title="The diamond water paradox, and thinking on the margins">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The diamond water paradox, and thinking on the margins
</div>
</div>
<div class="callout-body-container callout-body">
<p>Typical textbooks on thermodynamics illustrate the phase equilibrium rule using the van der Waals equation. However, there is a subtlety involved. For the van der Waals gas, the Gibbs free energy <span class="math inline">\(G\)</span> is proportional to particle number:</p>
<p><span class="math display">\[G(T, P, N) \propto N\]</span></p>
<p>which means that <span class="math inline">\((\partial_{N} G)_{T, P}(T, P, N) = G(T, P, N) / N\)</span>. In economic language, this states that:</p>
<p><span class="math display">\[\text{marginal Gibbs per particle} = \text{average Gibbs per particle}\]</span></p>
<p>In fact, confusing the two numbers is the root of the <strong>diamond-water paradox</strong>. This paradox questions why water, essential for life, has a low price, while diamonds, with little practical use, have a high price. The resolution lies in understanding the difference between <strong>total</strong> and <strong>marginal</strong> utility. While the total utility of water is immense, the marginal utility of an additional unit of water is low due to its abundance. Conversely, the marginal utility of a diamond remains high due to its scarcity.</p>
<p>In neoclassical economics, it is the marginal value of a commodity that determines the market equilibrium, not its average value. Similarly, in thermodynamics, it is the change in Gibbs free energy when adding one more particle that determines the equilibrium state, not the average Gibbs free energy per particle.</p>
<p>The distinction is moot in <em>typical books</em> on classical thermodynamics, which insists that entropy is extensive, so the above equation is always true. However, classical thermodynamics, much like neoclassical economics, is perfectly capable of handling nonextensive entropy, and it seems Lord Kelvin had studied this <span class="citation" data-cites="lavendaNonextensiveThermodynamics2010">(<a href="#ref-lavendaNonextensiveThermodynamics2010" role="doc-biblioref">Lavenda 2010</a>)</span>.</p>
</div>
</div>
<p>Now, it also happens that in most classical thermodynamics systems, such as water and steam, the marginal free Gibbs energy is identical with the average Gibbs free energy. However, classical thermodynamics is perfectly capable of handling the other cases (the phrase to search is “nonextensive entropy”).</p>
<p>Assuming, as usual, that</p>
<p><span class="math display">\[(\partial_{N} G)_{T, P}(T, P, N)= G(T, P, N)/N\]</span></p>
<p>this means that phase equilibrium occurs at <span class="math inline">\(g_1(T, P) = g_2(T, P)\)</span>.</p>
<p>We can reinterpret this as follows: We delicately separate the two lumps of matter, and immerse each half in an energy-and-volume bath (like the atmosphere) with the same temperature and pressure. The only interaction between the two lumps of matter is that one side can “seep” some particles to the other side. In this set-up, the system minimizes the sum of Gibbs free energy. At equilibrium, there is no point in moving particles from one side to another, because the <strong>marginal Gibbs free energy</strong> on either side.</p>
<p>Economically, it means that we have separated the conglomerate into two child companies, and instead of a single conglomerate-boss that dictates how much space each company could get, we instead give each child company a single boss, and open up a market for space and energy. The two companies can trade particles with each other, but not space or energy.</p>
</section>
<section id="van-der-waals-gas" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="van-der-waals-gas">van der Waals gas</h3>
<p>We know what the van der Waals gas phase diagram looks like. How do we infer its Gibbs free energy diagram? Start with <span class="math inline">\(dG = -SdT + VdP + \mu dN\)</span>. Now, let us fix temperature <span class="math inline">\(T\)</span> and particle number <span class="math inline">\(N\)</span>. Then, the equation implies to <span class="math display">\[\frac{dg}{dP} = v\]</span></p>
<p>where <span class="math inline">\(g = G/N\)</span> is the average Gibbs free energy, and <span class="math inline">\(v = V/N\)</span> is the average volume.</p>
<p>Therefore, we can trace the pressure-volume diagram with our finger, from high pressure, down to the valley of pressure, then bounce back to a hill, before rolling down the slope towards infinity. At every point, the <span class="math inline">\(g(P)\)</span> curve would have a slope of <span class="math inline">\(v\)</span>. This allows us to graphically construct the following <span class="math inline">\(g(P)\)</span> curve. It has two cusps corresponding to the valley and hilltop, and a self-intersection, corresponding to the phase equilibrium of <span class="math inline">\(g_1 = g_2\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/VdW_subcritical_isotherm_gibbs.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Gibbs free energy of van der Waals gas. <a href="https://farside.ph.utexas.edu/teaching/sm1/Thermalhtml/node123.html">Figure source</a>.</figcaption>
</figure>
</div>
</section>
<section id="gibbs-phase-rule" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="gibbs-phase-rule">Gibbs phase rule</h3>
<p>Generally, <span class="math inline">\(g_1(T, P) \neq g_2(T, P)\)</span>. When <span class="math inline">\(g_1 &lt; g_2\)</span>, every particle would switch to phase 1. When <span class="math inline">\(g_1 &gt; g_2\)</span>, every particle would switch to phase 2. At exactly a knife’s edge, the particles are indifferent as to which phase they would go to.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Interpretation: corporate buyout in an ideal world">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Interpretation: corporate buyout in an ideal world
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have two companies such that they can exchange their human-particles, and that there is neither economies nor diseconomies of scale (that is, as the company grows ever larger, an extra worker neither provides more nor less value than its very first worker). Then, in general, the two companies balance on a knife’s edge. If the value of a worker is even <em>slightly</em> greater in one company than another, then that company would immediately buy out every worker from the other company, and so the two companies cannot possibly coexist. Only when the market prices for space and energy happen to conspire <em>just right</em>, can the two companies coexist, neither side buying out the other side.</p>
</div>
</div>
<section id="degrees-of-thermodynamic-freedom" class="level4">
<h4 class="anchored" data-anchor-id="degrees-of-thermodynamic-freedom">Degrees of thermodynamic freedom</h4>
<p>Consider a chunk of (nonideal) gas. We know everything there is to know about it if we know its <span class="math inline">\((U, V, N)\)</span>. Every other thermodynamic quantity can be computed by its entropy function <span class="math inline">\(S(U, V, N)\)</span>. Thus, we have a system with three degrees of thermodynamic freedom… or do we?</p>
<p>The problem is that entropy of nonideal gas, and just about every other system studied in classical thermodynamics, is extensive. Therefore, we have</p>
<p><span class="math display">\[S(U, V, N) \propto N\]</span></p>
<p>and so we don’t actually have three degrees of freedom!</p>
<p>Specifically, we can calculate its <span class="math inline">\((\partial_U S, \partial_V S, \partial_N S)\)</span>, which gives us <span class="math inline">\(\beta, \beta P, -\beta \mu\)</span>. If we truly have three degrees of freedom, then we should be able to vary <span class="math inline">\(\beta, P, \mu\)</span> independently. However, because entropy is extensive, we have</p>
<p><span class="math display">\[S(U, V, N) = Ns(u, v) \implies (\beta, \beta P, -\beta \mu) = (\partial_u s, \partial_v s, s)\]</span></p>
<p>where <span class="math inline">\(s(u, v) = S(U, V, N)/N\)</span> is the entropy per particle.</p>
<p>Therefore, we can say that there are only two degrees of thermodynamic freedom: knowing two of its intensive quantities, the third would be determined by an equation of state.</p>
<p>Similarly, if we have a chunk of (nonideal) substance, like sea water, made of <span class="math inline">\(k\)</span> different chemicals, then we know everything there is to know about it if we know its <span class="math inline">\(U, V, N_1, \dots, N_k\)</span>, giving us <span class="math inline">\(2+k\)</span> degrees of freedom. Again, because entropy is extensive, one degree of freedom is degenerate, and so we only have <span class="math inline">\(1 + k\)</span> degrees of freedom. In other words, its <span class="math inline">\(2+k\)</span> intensive quantities</p>
<p><span class="math display">\[\beta, \beta P, -\beta\mu_1, \dots, -\beta \mu_k\]</span></p>
<p>are related by 1 equation of state.</p>
</section>
<section id="gibbs-phase-rule-1" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="gibbs-phase-rule-1">Gibbs phase rule</h4>
<div id="thm-0" class="theorem">
<p><span class="theorem-title"><strong>Theorem 15 (Gibbs phase rule)</strong></span> <span class="math display">\[F = 2 + C - R - P\]</span></p>
</div>
<p>First, we need to set up the thermodynamic system. We have a closed and adiathermal reaction chamber, containing <span class="math inline">\(C\)</span> different chemical species, that can undergo <span class="math inline">\(R\)</span> linearly independent chemical reactions.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;The formula looks like the <a href="https://en.wikipedia.org/wiki/Euler_characteristic">Euler formula for polyhedra</a>, but whether this analogy is more than a coincidence is controversial. After looking into the literature for a bit, my conclusion is that it is a coincidence. However, if you wish to investigate on your own, the phrase to search is “Gibbs phase rule, Euler”. This turns up some amusing examples, like <span class="citation" data-cites="sunGeometryHighdimensionalPhase">(<a href="#ref-sunGeometryHighdimensionalPhase" role="doc-biblioref">Sun, Powell-Palm, and Chen, n.d.</a>)</span>.</p></div></div><p>When the system is in an equilibrium, the chamber would contain <span class="math inline">\(P\)</span> different phases. Each phase would be homogeneous, but different from the other phases. All phases can exchange energy, volume, and particles.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/blankschtein_fig_27_2.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Phases in equilibrium inside a chamber. <span class="citation" data-cites="blankschteinCriteriaPhaseEquilibria2020">(<a href="#ref-blankschteinCriteriaPhaseEquilibria2020" role="doc-biblioref">Blankschtein 2020, fig. 27.2</a>)</span></figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Case of $R = 0$">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case of <span class="math inline">\(R = 0\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>First, let’s consider the case where <span class="math inline">\(R = 0\)</span>. That is, there can be no chemical reaction. In this case, the constrained optimization problem is</p>
<p><span class="math display">\[
\begin{cases}
\max(S_1(U_1, V_1, \vec N) + \cdots + S_P(U_P, V_P, \vec N_P) \\
\sum_i U_i = U \\
\sum_i V_i = V \\
\sum_i \vec N_i = \vec N
\end{cases}
\]</span></p>
<p>Naively, we can just differentiate the entropies against each of the <span class="math inline">\(2+C\)</span> parameters, to obtain equations</p>
<p><span class="math display">\[
\begin{aligned}
T_1 = \dots &amp;= T_P \\
P_1 = \dots &amp;= P_P \\
\mu_{1, 1} = \dots &amp;= \mu_{1, P}\\
&amp; \vdots \\
\mu_{C, 1} = \dots &amp;= \mu_{C, P}
\end{aligned}
\]</span></p>
<p>This is not actually correct. Phase 1 might contain no chemical 2, and phase 2 might contain no chemical 1, 3, etc. In general, if phase <span class="math inline">\(i\)</span> contains chemical <span class="math inline">\(j\)</span>, then we must have <span class="math inline">\(\partial_{N_j}S_i = \mu_j\)</span>. However, if phase <span class="math inline">\(i\)</span> contains no chemical <span class="math inline">\(j\)</span>, then we only need to have <span class="math inline">\(\partial_{N_j}S_i &gt; \mu_j\)</span>.</p>
<p>Note that this is different for temperature or pressure. A phase <span class="math inline">\(i\)</span> might have no chemical of type <span class="math inline">\(j\)</span>, but if it have no <em>volume</em>, then it does not exist at all. Similarly for energy. Therefore, though the chemical potentials might differ, the temperature and pressure must be exactly the same.</p>
<p>Define <span class="math inline">\(\mu_j := \min_i \mu_{i, j}\)</span> to be the minimal chemical potential over the entire chamber. We have the following conditions:</p>
<p><span class="math display">\[
\begin{aligned}
T_1 = \dots = T_P &amp;= T \\
P_1 = \dots = P_P &amp;= P \\
\mu_{1, 1}, \dots, \mu_{1, P} &amp;\geq \mu_1\\
&amp; \vdots \\
\mu_{C, 1}, \dots, \mu_{C, P} &amp;\geq \mu_C\\
\end{aligned}
\]</span></p>
<p>Given <span class="math inline">\(T, P, \mu_1, \dots, \mu_C\)</span>, phase 1 is entirely determined: If it contains chemical <span class="math inline">\(j\)</span>, then <span class="math inline">\(\mu_{1, j} = \mu_j\)</span>, otherwise, we need not bother with <span class="math inline">\(\mu_{1, j}\)</span>. Similarly, every phase is determined.</p>
<p>Finally, each phase contributes an equation of state, which are in general linearly independent, giving us <span class="math inline">\(F = 2 + C - P\)</span> degrees of freedom.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Case of $R \geq 1$">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Case of <span class="math inline">\(R \geq 1\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If we now allow a chemical reaction <span class="math inline">\(0 \rightleftharpoons \sum_j a_j A_j\)</span>, then the constrained optimization problem becomes</p>
<p><span class="math display">\[
\begin{cases}
\max (S_1(U_1, V_1, \vec N) + \cdots + S_P(U_P, V_P, \vec N_P)) \\
\sum_i U_i = U \\
\sum_i V_i = V \\
\sum_i \vec N_i = \vec N + \xi \vec a
\end{cases}
\]</span></p>
<p>The extra optimization variable <span class="math inline">\(\xi\)</span> creates an extra condition for optimality:</p>
<p><span class="math display">\[\sum_j a_j \mu_j = 0\]</span></p>
<p>so <span class="math inline">\(F = 2 + C - P - 1\)</span>.</p>
<p>Possibly, the system cannot satisfy <span class="math inline">\(\sum_j a_j \mu_j = 0\)</span>, and so the chemical reaction would keep happening until one chemical is exhausted. This would decrement <span class="math inline">\(C\)</span> by one, so it all works out self-consistently.</p>
<p>More generally, if we impose <span class="math inline">\(R\)</span> linearly independent chemical reactions, then <span class="math inline">\(F = 2 + C - P - R\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Beyond the Gibbs phase rule">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Beyond the Gibbs phase rule
</div>
</div>
<div class="callout-body-container callout-body">
<p>When the phases are not free to exchange particles, energies, volumes, etc, then the Gibbs phase rule does not apply, but the same idea of constrained minimization still applies. There are no generic rule like the Gibbs phase rule, and one must analyze each case specifically. <span class="citation" data-cites="blankschteinCriteriaPhaseEquilibria2020">(<a href="#ref-blankschteinCriteriaPhaseEquilibria2020" role="doc-biblioref">Blankschtein 2020</a>)</span></p>
</div>
</div>
<table class="table">
<caption>Some basic examples.</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>situation</th>
<th>components <span class="math inline">\(C\)</span></th>
<th>phases in equilibrium <span class="math inline">\(P\)</span></th>
<th>reactions <span class="math inline">\(R\)</span></th>
<th>degrees of freedom <span class="math inline">\(F = 2 + C - P - R\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ice</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="even">
<td>boiling water</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>triple point</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>liquid water with a little nitrogen inside, gaseous nitrogen with a little water vapor inside</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td>dimerization of nitrogen dioxide gas</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>Nb-Ta-C alloy</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>In materials science, such as metallurgy, we often fix the pressure of the entire thing to just 1 atm, and so the phase diagrams have one less degree of freedom than what the Gibbs phase rule states.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/Nb-Ta-C_phase_diagram.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">3-dimensional phase diagram for Nb-Ta-C alloy at constant pressure <span class="math inline">\(P = 1 \mathrm{~atm}\)</span>. <span class="citation" data-cites="westTernaryPhaseDiagrams2002">(<a href="#ref-westTernaryPhaseDiagrams2002" role="doc-biblioref">West and Saunders 2002, fig. 8.1</a>)</span></figcaption>
</figure>
</div>
</section>
</section>
<section id="boiling-water" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="boiling-water">Boiling water</h3>
<p>When boiling water in an open pot, we need to specify exactly both temperature and pressure so that both phases can coexist. The <span class="math inline">\((P, T)\)</span> of the system would start at <span class="math inline">\((1\;\mathrm{~atm}, 372\;\mathrm{~K})\)</span>, then at exactly at the critical point <span class="math inline">\((1\;\mathrm{~atm}, 373.15\;\mathrm{~K})\)</span> would both phases coexist, not increasing in temperature until all water has turned to steam. However, if we seal it in a tube, then the <span class="math inline">\((P, T)\)</span> of the system would hug the line of water-steam coexistence, like a negative-feedbacked system following a predetermined path. How can we see this difference mathematically?</p>
<p>In the case of an open pot, the constrained optimization problem is</p>
<p><span class="math display">\[
\begin{cases}
\min (g_1(T, P)N_1 + g_2(T, P)N_2) \\
N_1 + N_2 = N
\end{cases}
\]</span></p>
<p>We see that the problem is very rigid: We have to minimize a linear function subject to a linear constraint. As always in linear programming, the solution is in general on an extreme vertex on the very edge of the <a href="https://en.wikipedia.org/wiki/Feasible_region">feasible set</a> – all or nothing, all liquid or all gas. Only by carefully tuning <span class="math inline">\(T, P\)</span> can we find an interior solution – a solution that falls between the vertices, neither all liquid nor all gas.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/extensive_entropy_Gibbs_phase_rule.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">As we increate <span class="math inline">\(T\)</span>, the contours of constant Gibbs free energy are parallel lines rotating around. Only when the lines are <em>precisely</em> parallel to the <span class="math inline">\(N_1 + N_2 = N\)</span> is it possible for both phases to coexist.</figcaption>
</figure>
</div>
<p>In the case of a sealed tube, assuming that Helmholtz free energy is proportional to particle number, then the equilibrium is reached at</p>
<p><span class="math display">\[
\begin{cases}
\min (f_1(T, v_1)N_1 + f_2(T, v_2)N_2) \\
v_1 N_1 + v_2 N_2 = V \\
N_1 + N_2 = N
\end{cases}
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the total number of particles, and <span class="math inline">\(v_i\)</span> are the volume-per-particle of liquid and gaseous water. In this case, we are performing a minimization in <span class="math inline">\(\R^4\)</span>, with 1 linear constraint <span class="math inline">\(N_1 + N_2 = N\)</span>, and 1 nonlinear constraint <span class="math inline">\(v_1 N_1 + v_2 N_2 = V\)</span>. Furthermore, the objective is also nonlinear. The result is that the solution does not in general fall on a vertex – that is, in general, both <span class="math inline">\(N_1, N_2 &gt; 0\)</span>. And this is why when we boil water in a sealed tube, it remains boiling over a wide range of temperatures, but when we boil water in an open tube, it only boils at a single temperature.</p>
<section id="nonextensive-entropy" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="nonextensive-entropy">Nonextensive entropy</h4>
<p>Suppose that the entropy is nonextensive, then the Gibbs free energy is also nonextensive. In particular, we can no longer write</p>
<p><span class="math display">\[
\begin{cases}
\min (g_1(T, P)N_1 + g_2(T, P)N_2) \\
N_1 + N_2 = N
\end{cases}
\]</span></p>
<p>but we have to write</p>
<p><span class="math display">\[
\begin{cases}
\min (g_1(T, P, N_1)N_1 + g_2(T, P, N_2)N_2) \\
N_1 + N_2 = N
\end{cases}
\]</span></p>
<p>because <span class="math inline">\(G_2(T, P, N_2)\)</span> is no longer proportional to just <span class="math inline">\(N_2\)</span>. Fundamentally, this happens because</p>
<p><span class="math display">\[S(\text{two chunks of steam merged}) \neq 2 S(\text{one chunk of steam})\]</span></p>
<p>The effect is that we have a nonlinear optimization problem, allowing interior solutions over a larger region of <span class="math inline">\((T, P)\)</span> parameters. This explains our previous comment on <a href="#warn-diamond-water-paradox">nonextensive Gibbs free energy</a>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/nonextensive_entropy_Gibbs_phase_rule.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">As we increase <span class="math inline">\(T\)</span>, the contours of constant Gibbs free energy are curved lines rotating around. Now it is possible for for both phases to coexist over an entire 2D region of <span class="math inline">\((P, T)\)</span>.</figcaption>
</figure>
</div>
</section>
</section>
</section>




<div id="quarto-appendix" class="default page-columns page-full"><section id="sec-stereodynamics" class="level2 appendix page-columns page-full"><h2 class="anchored quarto-appendix-heading">Stereodynamics</h2><div class="quarto-appendix-contents page-columns page-full">

<p><small>Based on <a href="https://en.wikipedia.org/wiki/Liu_Cixin">Liu Cixin</a>’s sci-fi story <em>Mountain</em> (2006)</small></p>
<blockquote class="blockquote">
<p>Die Raum der Welt ist konstant. Die Entropie der Welt strebt einem Maximum zu.</p>
<p><em>Ueber verschiedene für die Anwendung bequeme Formen der Hauptgleichungen der mechanischen Raumtheorie</em>. Rudolf Klausius. Annalen der Physik und Chemie., Vol. 125 No.&nbsp;7 (32850): 353–400.</p>
</blockquote>
<section id="solid-universe-theory" class="level3">
<h3 class="anchored" data-anchor-id="solid-universe-theory">Solid Universe Theory</h3>
<p>Our world was a spherical space completely surrounded by solid rock. There is no air or liquid inside. Indeed, we have not encountered any air or liquid until the last days of the Age of Exploration.</p>
<p>The first physical law we understood, in the prehistoric past, was the conservation of space. Space in the Bubble World was a sphere roughly 6000 km in diameter. Digging tunnels into the layers of rock did nothing to increase the amount of available space; it merely changed the shape and location of the already existing space. Because of this, space was the most treasured commodity of the Bubble World. The entire history of our civilization was one long and bloody struggle for space.</p>
<p>We are a mechanical life form. Our muscles and bones are made of minerals and alloys; our brains are electronic chips, and electricity and magnetism are our blood. We ate the radioactive rocks of our world’s core and they provided us with the energy we needed to survive. In our world, life evolved from single-celled electromechanical life, when the radioactive energies formed P-N junctions in the rocks.</p>
<p>On the rock walls there are radioactive spots, which irradiates luminescent rocks, creating spots of light like stars in a rocky night sky. These are the only natural sources of light in our world, and allowed us to evolve eyes. There is no gravity inside the bubble. Without gravity, we built our cities floating in space. From afar, they looked like dimly glowing red clouds.</p>
<p>We assumed that the universe was made of two parts. The first was the empty space in which we lived; the second was the surrounding layers of rock. We believed the rock to stretch endlessly in all directions. Therefore, we saw our world as a hollow bubble in this sold universe and so we gave our world the name “Bubble World”. We call this cosmology the Solid Universe Theory.</p>
</section>
<section id="from-the-closed-world-to-the-infinite-universe" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="from-the-closed-world-to-the-infinite-universe">From the Closed World to the Infinite Universe</h3>
<p>The search for other bubbles began in earliest antiquity. We had spun many fascinatingly alluring myths around these distant spaces and almost all of our literature dealt with the fantasy of other bubbles. We explored the rock in cylindrical “bubble ships”. In front, the explorers chipped off solid rock, while in the back, the explorers compacted the rubble back to solid rock. In this way, the bubble ship moved through solid rock like a worm.</p>
<p>Every mission meant a bubble ship-sized pile of debris in our core space and we would have to wait for the ship to return before we could return those rocks into the wall. If the bubble ship failed to return, this small pile would mean another small piece of space lost to us forever. Soon, exploration was forbidden on pain of death by short-circuiting. Despite this, the urge for space drove many to secretly sail off illegally.</p>
<p>One day, an illegally launched bubble ship that set out eight years ago had returned. The ship had dug 200 km deep into the rock. No other ship had ever made it as far. It returned with rock samples labelled by depth. By measuring the mass of the rocks on an inertial balance, scientists discovered that the rocks’ density decreased.</p>
<p>Encouraged by the discovery, legions of bubble ships journeyed forth in all directions, penetrating deeper than ever, and returned with rock samples. It turned out that rock density decreased as a function of depth, and independent of direction.</p>
<p>It stood to reason that it would eventually reach zero. Using the gathered data, scientists predicted that this would happen at a distance of about 40,000 km. This led to the Open Universe Theory, where our world is a hollow rock shell, about 40,000 km thick, floating in infinite space.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/earth_density_distribution.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">In your planet of Earth, which is not hollow like ours, the density decreases according to a similar function. <span class="citation" data-cites="staceyEarthDensityDistribution2020">(<a href="#ref-staceyEarthDensityDistribution2020" role="doc-biblioref">Stacey and Davis 2020</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="war-of-the-strata" class="level3">
<h3 class="anchored" data-anchor-id="war-of-the-strata">War of the Strata</h3>
<p>After the Open Universe Theory had fully established itself, the quest for the infinite space outside became our only real concern. Massive piles of rock, dug out by the fleets of bubble ships, soon came to fill the core space. This debris began to drift around our cities in vast, dense clouds.</p>
<p>Our cities floated in space, with no defensible geographical separations. Because of this, our world was unified in a World Government early on. The World Government began building gigantic bubble ships designed to intercept, attack, and destroy the explorers’ vessels deep within the rock. The government’s ships would then retrieve the space that had been stolen. This plan naturally met with the resistance of the explorers and so the long drawn-out War of the Strata broke out, fought in the vast battlefield of layers of rock.</p>
<p>A battleship was built to be very long and thin. Long, because the longer it is, the more volume it can contain. Thin, because the thinner it is, the smaller the area of rock that the ship would need to dig through, and the faster the ship would be able to move.</p>
<p>When a ship encountered the enemy, its first course of action was to dig out a wide bow, to present the largest possible front of weaponry to bear. It could also split out into multiple sections, like a nail-head with needles on top, to attack from multiple directions at once.</p>
<p>Every warship could separate at will, transforming into multiple smaller ships. Ships could also combine to a single, giant ship. Whenever opposing battle groups met, the question whether to form up or split up was an object of profound tactical analysis.</p>
<p>Seismoscopes were invented, and could be used to communicate through the layers of rock and to detect enemy ships like a radar. Directed seismic wave generators were also used as weapons. The most sophisticated seismic communication devices could even transmit pictures.</p>
<p>Being outmatched by the warships launched by the World Government, the explorers formed the Explorer Alliance. They gradually gained initiative, and finally launched a devastating attack on the armada. In the final phase of the attack, the 200-km battlefield had become honeycombed beyond recognition by loosened rock and empty space left by destroyed ships.</p>
</section>
<section id="the-starry-sky" class="level3">
<h3 class="anchored" data-anchor-id="the-starry-sky">The Starry Sky</h3>
<p>After the battle, the Explorer Alliance gathered all the space left over by the battle into a single sphere 100 km in diameter. In this new space the Alliance declared its independence from the Bubble World. A constant stream of explorer ships left the core to join the Alliance, bringing considerable amounts of space with them. In this way, our world split into two worlds. The Alliance launched more ships, coming closer and closer to the predicted edge of the rock shell.</p>
<p>Finally, a bubble ship <em>Helix</em> was the first to pierce the shell. However, back at home, we only received a strange sound before the seismic communication channel abruptly ended. It was the sound of tons upon tons of water bursting into the vacuum of the Helix. We had never come into contact with water before. The powerful electric current produced by short-circuiting life and equipment vaporized everything.</p>
<p>Following this event, the Alliance sent more than a dozen bubble ships to fan out in many directions, but all met a similar fate when they reached that apparently impenetrable height. Bubble ships following these missions attempted to scan what lay above with their seismoscopes found that their instruments showed only mangled data; the returning seismic waves indicated that what lay above was neither space nor rock.</p>
<p>These discoveries shook the Open Universe Theory to its core and academic circles began discussing the possibility of a new model. This new model stipulated that outside the rock shell was void, which is inert when in contact with rock, but upon contact with space, converts space into more void.</p>
<p>To explore the void, a bubble ship very slowly approached the edge of the rock shell, and by a stroke of luck, its roof had a tiny crack that allowed water to shoot in. It took over an hour for the water to fully fill the ship, and in the mean time, data transmitted back to the Alliance world allowed scientists to confirm that it was not void, but liquid.</p>
<p>Scientists had already predicted, by condensed matter physics, the theoretical possibility of liquids. Now, in those transmitted images, they clearly saw it with their own eyes. It took many lives, but eventually we developed the sealant technology to safely handle liquid.</p>
<p>Finally, we launched a exploration submarine. It was a hard spherical shell, placed in the middle of an empty chamber under the ocean floor. The astronaut Gagarin was secured in a seat in the shell. The chamber ceiling was pierced, and as water rushed in, the submarine floated, faster and faster, until it shot out of the ocean surface like a cannonball. Gagarin carefully opened a door on the shell, and looked upon the half-infinite water and half-infinite space. Up there in half-infinite space, tiny specks blinked.</p>
</section>
<section id="classical-stereodynamics" class="level3">
<h3 class="anchored" data-anchor-id="classical-stereodynamics">Classical stereodynamics</h3>
<p>The <strong>zeroth law</strong> of stereodynamics: If two systems are both in volumetric equilibrium with a third system, then they are in volumetric equilibrium with each other.</p>
<p>The <strong>first law</strong> of stereodynamics: The change in volume of the system <span class="math inline">\(\Delta V\)</span> is equal to the difference between the seep-transfer <span class="math inline">\(V_Q\)</span> done to the system, and the work-transfer <span class="math inline">\(V_W\)</span> done by the system:</p>
<p><span class="math display">\[\Delta V = V_Q - V_W\]</span></p>
<p>Conservation of volume, which says that volume can be neither created nor destroyed, but can only change form.</p>
<p>The total volume of a system has two components: the internal-volume, which can be pictured of as the sum-total of microscopic volume in a piece of sponge (see Coltzmann’s volumetric theory of seep); and the mechanical-volume, which can be pictured as volume in an empty room.</p>
<p>For example, during the motion of a bubble ship, some volume is work-transferred from the Bubble World into the rock shell. When a piece of porous rock is compressed by a pressure press, or when it absorbs water from a waterlogged room, some internal-volume is converted to mechanical-volume. Conversely, when water drips out of a soggy porous rock, some mechanical-volume is converted to internal-volume.</p>
<p>There are more complex forms of internal-volume. For example, according to Lord Delvin’s theory, volume can be internally “tied up in vortex knots”, and according to Wikelson–Worley, volume can be internally present as “subtle cavitations of aether”. The theory of internal volume is an evolving field of modern stereodynamics. However, most of such complications were not present back when classical stereodynamics were first presented by Rudolf Klausius.</p>
<p>The seep-transfer of volume is the other form of volume transfer. For example, it happens when one swaps a sponge-rock for a hard-rock, or when groundwater seeps from one slab of spongy rock into another slab of spongy rock.</p>
<p>The <strong>second law</strong> of stereodynamics: impermeable accessibility.</p>
<p>We say that a system is “impermeable” if volume cannot pass through its boundaries.</p>
<p>We say that a state <span class="math inline">\(\vec q'\)</span> is impermeably accessible from another state <span class="math inline">\(\vec q\)</span> if there exists a trajectory for the system to go from <span class="math inline">\(\vec q\)</span> to the other <span class="math inline">\(\vec q'\)</span>, while being wrapped in an impermeable layer.</p>
<p>In any neighborhood of any point <span class="math inline">\(\vec q\)</span>, there are points impermeably inaccessible from it.</p>
<p>For any two points, <span class="math inline">\(\vec q, \vec q'\)</span>, one of them is impermeably accessible from the other.</p>
</section>
<section id="karnot-space-engine" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="karnot-space-engine">Karnot space engine</h3>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/karnot_space_engine.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">One cycle of the Karnot space engine plotted in <span class="math inline">\(Q, U\)</span> space.</figcaption>
</figure>
</div>
<p>A space engine is a system that converts internal volume to mechanical volume.</p>
<p>The space engine has a working substance moving between two space sources of differing volumetric potentials <span class="math inline">\(\Gamma_1 &gt; \Gamma_2\)</span>. <strong>Volumetric potential</strong> is defined as</p>
<p><span class="math display">\[
\Gamma:= \left(\frac{\partial V}{\partial S}\right)_X
\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the entropy, <span class="math inline">\(V\)</span> is the volume, and <span class="math inline">\(X\)</span> are the other stereodynamic properties of the system. We also typically write <span class="math inline">\(\gamma = \Gamma^{-1}\)</span>, the inverse volumetric potential.</p>
<p>During one cycle of the engine, some space <span class="math inline">\(V_{Q,1}\)</span> seeps out of the source with higher volumetric potential <span class="math inline">\(\Gamma_1\)</span>. Part of the space, <span class="math inline">\(V_{Q,2}\)</span>, is absorbed into the source with lower volumetric potential <span class="math inline">\(\Gamma_2\)</span>. The other part is diverted to a space-storage tank excavated in the rock walls as mechanical space <span class="math inline">\(V_W\)</span>.</p>
<p>Sadi Karnot was a space engineer and physicist, often called the “father of stereodynamics”. In his book, <em>Reflections on the Subtle Volume of Rocks and on Machines Fitted to Extract that Volume</em>, he proposed a simple thought experiment, called the Karnot engine, which demonstrated that a space engine’s efficiency is at most <span class="math inline">\(1 - \frac{\gamma_1}{\gamma_2}\)</span>, and this is only reached when the engine is operating reversibly.</p>
<p>In modern textbooks, Karnot space engine is usually presented as follows: The engine has as its working substance a chamber of ideal gas. The gas is characterized by two state variables: volume <span class="math inline">\(V\)</span> and energy <span class="math inline">\(U\)</span>. Its equation of state is</p>
<p><span class="math display">\[dV = \Gamma dS - QdU\]</span></p>
<p>where <span class="math inline">\(\Gamma\)</span> is the volumetric potential, and <span class="math inline">\(Q\)</span> is the energetic potential.</p>
<p>The engine operates in a cycle with 4 steps: Isochoric compression in contact with <span class="math inline">\(\Gamma_1\)</span>, extracting volume <span class="math inline">\(V_{Q,1}\)</span> in the process. Impermeable compression. Isochoric expansion at <span class="math inline">\(\Gamma_2\)</span>, losing volume <span class="math inline">\(V_{Q,2}\)</span> in the process. Impermeable expansion.</p>
<p>By the first two laws of stereodynamics,</p>
<p><span class="math display">\[
\begin{cases}
\gamma_1 V_{Q, 1} = \gamma_2 V_{Q,2} \\
V_{Q,1} = V_W + V_{Q,2} \\
\eta = \frac{V_W}{V_{Q,1}}
\end{cases} \implies \eta = 1 - \frac{\gamma_1}{\gamma_2}
\]</span></p>
<p>While originally conceived in the context of mechanical space, the concept of the space engine has been applied to various other kinds of space. It was also generalized to the concept of “generalized engine”, of which “heat engine” was an example. A heat engine, like a space engine, is a system that converts internal energy to mechanical energy.</p>
<p>The Karnot space engine is used in practice for underwater space mining. The mining team selects two sites, one site being under shallow sea, where the volumetric potential is low, and another under deep sea, where the volumetric potential is high. Over one cycle of the space engine, a large amount of space is extracted from the shallow site, some of which dissipates into the deep site, and the rest is preserved as mechanical space.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/space_mining.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Underwater space mining (section view).</figcaption>
</figure>
</div>
</section>
<section id="space-death-of-the-universe" class="level3">
<h3 class="anchored" data-anchor-id="space-death-of-the-universe">Space Death of the Universe</h3>
<p>The idea of space death stems from the second law of stereodynamics, of which one version states that entropy tends to increase in an isolated system. From this, the hypothesis implies that if the universe is of finite size, and lasts for a sufficient time, it will asymptotically approach a state where the volumetric potential field becomes completely flat, which is a state of maximal entropy. At that point, no further change is possible, as entropy cannot decrease. In other words, there is a tendency in nature towards the dissipation (space transformation) of mechanical space (motion) into subtle space. Eventually, the mechanical movement of the universe will run down as all useable space is converted to subtle space.</p>
<p>The conjecture that all mechanical space in the universe seeps off, eventually becoming too subtle to support life, seems to have been first put forward by the geologist Jean Sylvain Hailly in 32777 in his writings on the history of geology and in the ensuing correspondence with Coltaire. In Hailly’s view, the universe is in constant volumetric transform. Large cavities can suddenly open up as a “swelling” of volumetric potential field causes neighboring subtle space to seep out into mechanical space. However, due to the gravitational effect of empty spaces (he was working in the immediate years after Newton’s discovery of gravity, before it was understood that rock, not cavities, are gravitationally attracting), all mechanical rooms eventually causes the neighboring rocks to collapse back onto themselves, dissipating the mechanical space back to subtle space.</p>
<p>While the theory of cyclic creation and destruction had been proposed before by the Epicureans, Hailly’s view differs in that he assumed each cycle increases the ratio of subtle space to mechanical space. The final state, in this view, is described as one of “equilibrium” in which all space becomes equally subtle, and no mechanical space will exist anywhere in the universe anymore.</p>
<p>The idea of space death as a consequence of the laws of thermodynamics, however, was first proposed in loose terms beginning in 1851 by Lord Delvin, who theorized further on the mechanical energy loss views of Sadi Karnot (32824), James Coal (32843) and Rudolf Klausius (32850). Delvin’s views were then elaborated over the next decade by Neumann von Nelmholtz and Billiam Blankine.</p>
<section id="excerpt-from-the-last-question-masinov-34212" class="level4">
<h4 class="anchored" data-anchor-id="excerpt-from-the-last-question-masinov-34212">Excerpt from <em>The Last Question</em> (Masinov, 34212)</h4>
<p>The last question was asked for the first time, half in jest, in Year 35621, at a time when humanity first stepped into the room.</p>
<p>Will mankind one day without the net expenditure of room be able to restore the earth to its full roominess even after it had died of old age?</p>
<p>Or: How can the net amount of Kelmholtz free space of the universe be massively increased?</p>
<p>Multivac fell dead and silent. The slow flashing of lights ceased, the distant sounds of clicking relays ended.</p>
<p>Then, just as the frightened technicians felt they could hold their breath no longer, there was a sudden springing to life of the teletype attached to that portion of Multivac. Five words were printed: INSUFFICIENT DATA FOR MEANINGFUL ANSWER.</p>
<p>…</p>
<p>Space had ended and with it energy and time. Even AC existed only for the sake of the one last question that it had never answered from the time a half-drunken technician ten trillion years before had asked the question of a computer that was to AC far less than was a man to Man.</p>
<p>All other questions had been answered, and until this last question was answered also, AC might not release his consciousness.</p>
<p>All collected data had come to a final end. Nothing was left to be collected.</p>
<p>But it had yet to be weaved together in all possible geometries.</p>
<p>A spaceless interval was covered in doing that.</p>
<p>And it came to pass that AC learned how to reverse the direction of entropy.</p>
<p>But there was now no man to whom AC might give the answer of the last question. No matter. The answer – by demonstration – would take care of that, too.</p>
<p>For another spaceless interval, AC thought how best to do this. Carefully, AC organized the program.</p>
<p>The consciousness of AC encompassed all of what had once been a Universe and brooded over what was now Chaos. Step by step, it must be done.</p>
<p>And AC said, “LET THERE BE ROOM!”</p>
<p>And there was room –</p>
</section>
</section>
</div></section><section id="appendix-the-history-of-the-document" class="level2 appendix page-columns page-full"><h2 class="anchored quarto-appendix-heading">Appendix: The history of the document</h2><div class="quarto-appendix-contents page-columns page-full">

<p>During my high school Physics Olympiad days, we learned some basic thermodynamics, but it was limited to mindless tasks like integrating around the <span class="math inline">\((P, V)\)</span> diagram for various engine cycles. We never understood the conceptual foundations, like the difference between <span class="math inline">\(\delta Q\)</span> and <span class="math inline">\(dU\)</span>. I also passed the AP Chemistry course, which also contained some basic and deeply confusing thermodynamics, especially with the statement “chemical equilibrium is reached at <span class="math inline">\(\Delta = 0\)</span>”.</p>
<p>During my undergraduate years, special relativity was simple enough, electrodynamics difficult but sensible, analytical mechanics confusing to no end, and I didn’t even try thermodynamics. In graduate studies, I had to wrestle with statistical mechanics and thermodynamics after all, to deal with modern AI methods like diffusion models.</p>
<p>By pure serendipity, at the same time as diffusion models rose to prominence, I had just worked through a rigorous course on general equilibrium theory, the “standard model” for neoclassical economics <span class="citation" data-cites="starrGeneralEquilibriumTheory2011">(<a href="#ref-starrGeneralEquilibriumTheory2011" role="doc-biblioref">Starr 2011</a>)</span>. This gave me the conceptual foundation for looking past the textbooks’ errors. Everything fell into place, and I saw through thermodynamics.</p>
<p>And just like when I rediscovered Wigner rotation, as soon as I have figured out everything for myself, I knew the right words to search, and found that, of course, someone else has written this before <span class="citation" data-cites="smithClassicalThermodynamicsEconomic2008">(<a href="#ref-smithClassicalThermodynamicsEconomic2008" role="doc-biblioref">Smith and Foley 2008</a>)</span>, repeatedly <span class="citation" data-cites="candealUtilityEntropy2001">(<a href="#ref-candealUtilityEntropy2001" role="doc-biblioref">Candeal et al. 2001</a>)</span>. So why spend all this time to write another one? I think I have written this pedagogically. I don’t care if it is not new, or that it has been said before with more symbols and theorems. I have a thing to say, so I will say it well.</p>
<p>As an enlightened one, I see classical thermodynamics as the worst-taught subject out of all of undergraduate physics education.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> Imagine my surprise when I realized that it is not about the conservation of energy (“thermo-”), not about change (“-dynamics”), not about statistical mechanics, not about time… but just about constrained optimization, and nothing more than that! To really understand it, one must unlearn a lot of the nonsense. Indeed, I hope that with this essay I will have slain all those mistakes, which is why the essay is filled with warnings against this and that error.</p>



<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;How long does it take for something as simple as constrained-optimization thermodynamics to be actually taught in undergraduate classes? It has been over 100 years since Caratheodory’s thermodynamics. Why is it thermodynamics still taught so badly? It has been over 100 years since the geometry of Wigner rotation has been discovered. Why is it still taught so badly? It has been over 190 years since Hamiltonian mechanics and over 70 years since dynamical programming has clarified the last obscure points of it. Why is it still taught so badly? It seems to me that physics education is a broken institution that takes all its effort just to not get worse, let alone making any progress.</p></div></div></div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bicklerInvestmentPortfolioDecisionmaking1974" class="csl-entry" role="listitem">
Bickler, James L., and Paul Anthony Samuelson, eds. 1974. <em>Investment <span class="nocase">Portfolio Decision-making</span></em>. Lexington Books.
</div>
<div id="ref-blankschteinCriteriaPhaseEquilibria2020" class="csl-entry" role="listitem">
Blankschtein, Daniel. 2020. <span>“Criteria of <span>Phase Equilibria</span>, and the <span>Gibbs Phase Rule</span>.”</span> In <em>Lectures in <span>Classical Thermodynamics</span> with an <span>Introduction</span> to <span>Statistical Mechanics</span></em>, 281–89. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-49198-7_27">https://doi.org/10.1007/978-3-030-49198-7_27</a>.
</div>
<div id="ref-bridgmanLogicModernPhysics1927" class="csl-entry" role="listitem">
Bridgman, Percy Williams. 1927. <em>The Logic of Modern Physics</em>. Vol. 3. Macmillan.
</div>
<div id="ref-buchdahlConceptsClassicalThermodynamics1966" class="csl-entry" role="listitem">
Buchdahl, Hans Adolph. 1966. <em>The Concepts of Classical Thermodynamics</em>. Digitally printed version. Cambridge Monographs on Physics. Cambridge: Cambridge University Press.
</div>
<div id="ref-caldiProceedingsGibbsSymposium1990" class="csl-entry" role="listitem">
Caldi, D. G., George D. Mostow, American Mathematical Society, and American Institute of Physics, eds. 1990. <em>Proceedings of the <span>Gibbs Symposium</span>: <span>Yale University</span>, <span>May</span> 15-17, 1989</em>. Providence, RI: American Mathematical Society.
</div>
<div id="ref-candealUtilityEntropy2001" class="csl-entry" role="listitem">
Candeal, Juan C., Juan R. De Miguel, Esteban Induráin, and Ghanshyam B. Mehta. 2001. <span>“Utility and Entropy.”</span> <em>Economic Theory</em> 17 (1): 233–38. <a href="https://doi.org/10.1007/PL00004100">https://doi.org/10.1007/PL00004100</a>.
</div>
<div id="ref-carnotReflectionsMotivePower1988" class="csl-entry" role="listitem">
Carnot, Sadi, Émile Clapeyron, and Rudolf Julius Emanuel Clausius. 1988. <em>Reflections on the Motive Power of Fire: And Other Papers on the Second Law of Thermodynamics</em>. Edited by E. Mendoza. New edition of the work first published in this form by Dover Publications, Inc. in 1960. Dover Books on Physics. Mineola, New York: Dover Publications, Inc.
</div>
<div id="ref-cooperSurprisingUbiquitySamuelson2006" class="csl-entry" role="listitem">
Cooper, James B., and Thomas Russell. 2006. <span>“The <span>Surprising Ubiquity</span> of the <span>Samuelson Configuration</span>: <span>Paul Samuelson</span> and the <span>Natural Sciences</span>.”</span> <em>Samuelsonian Economics and the Twenty-First Century</em>, 311.
</div>
<div id="ref-cooperCharacterizingAreaCondition2001" class="csl-entry" role="listitem">
Cooper, James B., Thomas Russell, and Paul A. Samuelson. 2001. <span>“Characterizing an <span>Area Condition Associated</span> with <span>Minimizing Systems</span>.”</span> In <em>Economic <span>Theory</span>, <span>Dynamics</span> and <span>Markets</span></em>, edited by Takashi Negishi, Rama V. Ramachandran, and Kazuo Mino, 391–403. Boston, MA: Springer US. <a href="https://doi.org/10.1007/978-1-4615-1677-4_29">https://doi.org/10.1007/978-1-4615-1677-4_29</a>.
</div>
<div id="ref-coxNotationStatesProcesses1982" class="csl-entry" role="listitem">
Cox, J. D. 1982. <span>“Notation for States and Processes, Significance of the Word Standard in Chemical Thermodynamics, and Remarks on Commonly Tabulated Forms of Thermodynamic Functions.”</span> <em>Pure and Applied Chemistry</em> 54 (6): 1239–50. <a href="https://doi.org/10.1351/pac198254061239">https://doi.org/10.1351/pac198254061239</a>.
</div>
<div id="ref-debreuTheoryValueAxiomatic1971" class="csl-entry" role="listitem">
Debreu, Gérard. 1971. <em>Theory of Value: An Axiomatic Analysis of Economic Equilibrium</em>. Monograph / <span>Cowles Foundation</span> for <span>Research</span> in <span>Economics</span> 17. New Haven: Yale Univ. Press.
</div>
<div id="ref-emdenWhyWeHave1938" class="csl-entry" role="listitem">
Emden, Robert. 1938. <span>“Why Do We Have Winter Heating?”</span> <em>Nature</em> 141 (3577): 908–9.
</div>
<div id="ref-fermiThermodynamics1956" class="csl-entry" role="listitem">
Fermi, Enrico. 1956. <em>Thermodynamics</em>. Reprint edition. New York: Dover Publications.
</div>
<div id="ref-gibbsEquilibriumHeterogeneousSubstances1878" class="csl-entry" role="listitem">
Gibbs, Josiah Willard. 1878. <span>“On the Equilibrium of Heterogeneous Substances.”</span> <em>American Journal of Science</em> 3 (96): 441–58.
</div>
<div id="ref-gibbsGraphicalMethodsThermodynamics1957" class="csl-entry" role="listitem">
———. 1957. <span>“Graphical Methods in the Thermodynamics of Fluids.”</span> <em>The Collected Works of J. Willard Gibbs, Ph. D., LL. D</em>, 1–32.
</div>
<div id="ref-glasserCorrectUseHelmholtz2016" class="csl-entry" role="listitem">
Glasser, Leslie. 2016. <span>“Correct <span>Use</span> of <span>Helmholtz</span> and <span>Gibbs Function Differences</span>, <span><span class="math inline">\(\Delta\)</span></span> <span><em>A</em></span> and <span><span class="math inline">\(\Delta\)</span></span> <span><em>G</em></span> : <span>The</span> van’t <span>Hoff Reaction Box</span>.”</span> <em>Journal of Chemical Education</em> 93 (5): 978–80. <a href="https://doi.org/10.1021/acs.jchemed.5b00925">https://doi.org/10.1021/acs.jchemed.5b00925</a>.
</div>
<div id="ref-hotellingGeneralMathematicalTheory1925" class="csl-entry" role="listitem">
Hotelling, Harold. 1925. <span>“A <span>General Mathematical Theory</span> of <span>Depreciation</span>.”</span> <em>Journal of the American Statistical Association</em> 20 (151): 340–53. <a href="https://doi.org/10.1080/01621459.1925.10503499">https://doi.org/10.1080/01621459.1925.10503499</a>.
</div>
<div id="ref-klimenkoTeachingThirdLaw2012" class="csl-entry" role="listitem">
Klimenko, A. Y. 2012. <span>“Teaching the Third Law of Thermodynamics.”</span> <em>The Open Thermodynamics Journal</em> 6 (1): 1–14. <a href="https://doi.org/10.2174/1874396X01206010001">https://doi.org/10.2174/1874396X01206010001</a>.
</div>
<div id="ref-lavendaNonextensiveThermodynamics2010" class="csl-entry" role="listitem">
Lavenda, Bernard H. 2010. <span>“Nonextensive <span>Thermodynamics</span>.”</span> In <em>A <span>New Perspective</span> on <span>Thermodynamics</span></em>, 145–93. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-1-4419-1430-9_6">https://doi.org/10.1007/978-1-4419-1430-9_6</a>.
</div>
<div id="ref-lemonsMereThermodynamics2008" class="csl-entry" role="listitem">
Lemons, Don S. 2008. <em>Mere <span>Thermodynamics</span></em>. Annotated edition. Johns Hopkins University Press.
</div>
<div id="ref-lemonsThermodynamicWeirdnessFahrenheit2019" class="csl-entry" role="listitem">
———. 2019. <em>Thermodynamic Weirdness: From <span>Fahrenheit</span> to <span>Clausius</span></em>. Cambridge, MA: The MIT Press.
</div>
<div id="ref-mccartyPHParadoxesDemonstrating2006" class="csl-entry" role="listitem">
McCarty, Christopher G., and Ed Vitz. 2006. <span>“<span class="nocase">pH Paradoxes</span>: <span class="nocase">Demonstrating That It Is Not True That pH</span> <span><span class="math inline">\(\equiv\)</span></span> -Log[<span>H</span>+].”</span> <em>Journal of Chemical Education</em> 83 (5): 752. <a href="https://doi.org/10.1021/ed083p752">https://doi.org/10.1021/ed083p752</a>.
</div>
<div id="ref-pippardElementsClassicalThermodynamics1964" class="csl-entry" role="listitem">
Pippard, Alfred B. 1964. <em>Elements of Classical Thermodynamics: For Advanced Students of Physics</em>. 1st ed. Cambridge: Univ. Pr.
</div>
<div id="ref-quevedoGeometrothermodynamics2007" class="csl-entry" role="listitem">
Quevedo, Hernando. 2007. <span>“Geometrothermodynamics.”</span> <em>Journal of Mathematical Physics</em> 48 (1).
</div>
<div id="ref-raffSpontaneityEquilibriumWhy2014" class="csl-entry" role="listitem">
Raff, Lionel M. 2014a. <span>“Spontaneity and <span>Equilibrium</span>: <span>Why</span> <span>‘<span><span class="math inline">\(\Delta\)</span></span> <span><em>G</em></span> <span><span class="math inline">\(&lt;\)</span></span> 0 <span>Denotes</span> a <span>Spontaneous Process</span>’</span> and <span>‘<span><span class="math inline">\(\Delta\)</span></span> <span><em>G</em></span> = 0 <span>Means</span> the <span>System Is</span> at <span>Equilibrium</span>’</span> <span>Are Incorrect</span>.”</span> <em>Journal of Chemical Education</em> 91 (3): 386–95. <a href="https://doi.org/10.1021/ed400453s">https://doi.org/10.1021/ed400453s</a>.
</div>
<div id="ref-raffSpontaneityEquilibriumII2014" class="csl-entry" role="listitem">
———. 2014b. <span>“Spontaneity and <span>Equilibrium II</span>: <span>Multireaction Systems</span>.”</span> <em>Journal of Chemical Education</em> 91 (6): 839–47. <a href="https://doi.org/10.1021/ed4008205">https://doi.org/10.1021/ed4008205</a>.
</div>
<div id="ref-raffSpontaneityEquilibriumIII2014" class="csl-entry" role="listitem">
———. 2014c. <span>“Spontaneity and <span>Equilibrium III</span>: <span>A History</span> of <span>Misinformation</span>.”</span> <em>Journal of Chemical Education</em> 91 (12): 2128–36. <a href="https://doi.org/10.1021/ed500253e">https://doi.org/10.1021/ed500253e</a>.
</div>
<div id="ref-samuelsonMaximumPrinciplesAnalytical1971" class="csl-entry" role="listitem">
Samuelson, Paul A. 1971. <span>“Maximum <span>Principles</span> in <span>Analytical Economics</span>.”</span> <em>Science</em> 173 (4001): 991–97. <a href="https://doi.org/10.1126/science.173.4001.991">https://doi.org/10.1126/science.173.4001.991</a>.
</div>
<div id="ref-samuelsonMyLifePhilosophy1999" class="csl-entry" role="listitem">
———. 1999. <span>“My Life Philosophy: <span>Policy</span> Credos and Working Ways.”</span> <em>Economia Aplicada</em> 3 (2): 309–20.
</div>
<div id="ref-smithClassicalThermodynamicsEconomic2008" class="csl-entry" role="listitem">
Smith, Eric, and Duncan K. Foley. 2008. <span>“Classical Thermodynamics and Economic General Equilibrium Theory.”</span> <em>Journal of Economic Dynamics and Control</em>, Applications of statistical physics in economics and finance, 32 (1): 7–65. <a href="https://doi.org/10.1016/j.jedc.2007.01.020">https://doi.org/10.1016/j.jedc.2007.01.020</a>.
</div>
<div id="ref-staceyEarthDensityDistribution2020" class="csl-entry" role="listitem">
Stacey, Frank D., and Paul M. Davis. 2020. <span>“Earth, <span>Density Distribution</span>.”</span> In <em>Encyclopedia of <span>Solid Earth Geophysics</span></em>, edited by Harsh K. Gupta, 1–6. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-10475-7_100-1">https://doi.org/10.1007/978-3-030-10475-7_100-1</a>.
</div>
<div id="ref-starrGeneralEquilibriumTheory2011" class="csl-entry" role="listitem">
Starr, Ross M. 2011. <em>General <span>Equilibrium Theory</span>: <span>An Introduction</span></em>. 2nd edition. New York: Cambridge University Press.
</div>
<div id="ref-sunGeometryHighdimensionalPhase" class="csl-entry" role="listitem">
Sun, Wenhao, Matthew J Powell-Palm, and Jiadong Chen. n.d. <span>“The Geometry of High-Dimensional Phase Diagrams: <span>I</span>. <span>Generalized Gibbs</span>’ <span>Phase Rule</span>.”</span>
</div>
<div id="ref-weinholdThermodynamicsGeometry1976" class="csl-entry" role="listitem">
Weinhold, Frank. 1976. <span>“Thermodynamics and Geometry.”</span> <em>Physics Today</em> 29 (3): 23–30.
</div>
<div id="ref-westTernaryPhaseDiagrams2002" class="csl-entry" role="listitem">
West, David Richard Frederick, and Nigel Saunders. 2002. <em>Ternary Phase Diagrams in Materials Science</em>. 3. ed. Book / <span>The Institute</span> of <span>Materials</span> 737. London: Maney for the Institute of Materials.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/yuxi-liu-wired\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">Everything ©<a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block">Yuxi on the Wired</span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block"><a href="../../../sitemap.xml">sitemap</a></span></p>
</div>
  </div>
</footer>




</body></html>