<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yuxi Liu">
<meta name="dcterms.date" content="2024-04-11">
<meta name="description" content=".">

<title>Yuxi on the Wired - Analytical mechanics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../img/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Yuxi on the Wired - Analytical mechanics">
<meta property="og:description" content=".">
<meta property="og:image" content="https://yuxi-liu-wired.github.io/blog/posts/art/img/blog icon.jpg">
<meta property="og:site_name" content="Yuxi on the Wired">
<meta name="twitter:title" content="Yuxi on the Wired - Analytical mechanics">
<meta name="twitter:description" content=".">
<meta name="twitter:image" content="https://yuxi-liu-wired.github.io/blog/posts/art/img/blog icon.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/favicon.ico" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Yuxi on the Wired</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about/index.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://bair.berkeley.edu/"> <i class="bi bi-folder-symlink" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yuxi.liu.1995@gmail.com"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Analytical mechanics</h1>
                  <div>
        <div class="description">
          .
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">math</div>
                <div class="quarto-category">physics</div>
                <div class="quarto-category">philosophy</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yuxi Liu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 11, 2024</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">April 11, 2024</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#how-i-got-here" id="toc-how-i-got-here" class="nav-link" data-scroll-target="#how-i-got-here">How I got here</a></li>
  </ul></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#conventions" id="toc-conventions" class="nav-link" data-scroll-target="#conventions">Conventions</a></li>
  </ul></li>
  <li><a href="#optimization-as-making-money" id="toc-optimization-as-making-money" class="nav-link" data-scroll-target="#optimization-as-making-money">Optimization as making money</a>
  <ul class="collapse">
  <li><a href="#the-shortest-line-problem" id="toc-the-shortest-line-problem" class="nav-link" data-scroll-target="#the-shortest-line-problem">The shortest line problem</a></li>
  <li><a href="#economic-interpretation" id="toc-economic-interpretation" class="nav-link" data-scroll-target="#economic-interpretation">Economic interpretation</a></li>
  <li><a href="#isoperimetric-problem" id="toc-isoperimetric-problem" class="nav-link" data-scroll-target="#isoperimetric-problem">Isoperimetric problem</a></li>
  </ul></li>
  <li><a href="#lagrangian-and-hamiltonian-mechanics" id="toc-lagrangian-and-hamiltonian-mechanics" class="nav-link" data-scroll-target="#lagrangian-and-hamiltonian-mechanics">Lagrangian and Hamiltonian mechanics</a>
  <ul class="collapse">
  <li><a href="#derivatives-of-h" id="toc-derivatives-of-h" class="nav-link" data-scroll-target="#derivatives-of-h">Derivatives of <span class="math inline">\(H\)</span></a></li>
  <li><a href="#hamiltonian-equations-of-motion" id="toc-hamiltonian-equations-of-motion" class="nav-link" data-scroll-target="#hamiltonian-equations-of-motion">Hamiltonian equations of motion</a></li>
  <li><a href="#eulerlagrange-equations-of-motion" id="toc-eulerlagrange-equations-of-motion" class="nav-link" data-scroll-target="#eulerlagrange-equations-of-motion">Euler–Lagrange equations of motion</a></li>
  <li><a href="#what-does-it-all-mean" id="toc-what-does-it-all-mean" class="nav-link" data-scroll-target="#what-does-it-all-mean">What does it all mean?</a></li>
  <li><a href="#cyclic-coordinates" id="toc-cyclic-coordinates" class="nav-link" data-scroll-target="#cyclic-coordinates">Cyclic coordinates</a></li>
  <li><a href="#bonus-routhian-mechanics" id="toc-bonus-routhian-mechanics" class="nav-link" data-scroll-target="#bonus-routhian-mechanics">Bonus: Routhian mechanics</a></li>
  </ul></li>
  <li><a href="#bonus-higher-order-lagrangians-and-hamiltonians" id="toc-bonus-higher-order-lagrangians-and-hamiltonians" class="nav-link" data-scroll-target="#bonus-higher-order-lagrangians-and-hamiltonians">Bonus: Higher-order Lagrangians and Hamiltonians</a>
  <ul class="collapse">
  <li><a href="#when-lagrangian-also-depends-on-acceleration" id="toc-when-lagrangian-also-depends-on-acceleration" class="nav-link" data-scroll-target="#when-lagrangian-also-depends-on-acceleration">When Lagrangian also depends on acceleration</a></li>
  <li><a href="#ostrogradsky-instability-and-the-anthropic-principle" id="toc-ostrogradsky-instability-and-the-anthropic-principle" class="nav-link" data-scroll-target="#ostrogradsky-instability-and-the-anthropic-principle">Ostrogradsky instability and the anthropic principle</a></li>
  <li><a href="#hamiltonian-equations" id="toc-hamiltonian-equations" class="nav-link" data-scroll-target="#hamiltonian-equations">Hamiltonian equations</a></li>
  <li><a href="#eulerlagrange-equations" id="toc-eulerlagrange-equations" class="nav-link" data-scroll-target="#eulerlagrange-equations">Euler–Lagrange equations</a></li>
  <li><a href="#an-unstable-higher-order-oscillator" id="toc-an-unstable-higher-order-oscillator" class="nav-link" data-scroll-target="#an-unstable-higher-order-oscillator">An unstable higher-order oscillator</a></li>
  </ul></li>
  <li><a href="#hamiltonjacobi-equation" id="toc-hamiltonjacobi-equation" class="nav-link" data-scroll-target="#hamiltonjacobi-equation">Hamilton–Jacobi equation</a>
  <ul class="collapse">
  <li><a href="#billiards-in-a-circular-board" id="toc-billiards-in-a-circular-board" class="nav-link" data-scroll-target="#billiards-in-a-circular-board">Billiards in a circular board</a></li>
  <li><a href="#hamiltons-principal-function" id="toc-hamiltons-principal-function" class="nav-link" data-scroll-target="#hamiltons-principal-function">Hamilton’s principal function</a></li>
  <li><a href="#hamiltonjacobi-equation-1" id="toc-hamiltonjacobi-equation-1" class="nav-link" data-scroll-target="#hamiltonjacobi-equation-1">Hamilton–Jacobi equation</a></li>
  <li><a href="#hamilton-characteristic-function" id="toc-hamilton-characteristic-function" class="nav-link" data-scroll-target="#hamilton-characteristic-function">Hamilton characteristic function</a></li>
  <li><a href="#more-proofs-of-hje" id="toc-more-proofs-of-hje" class="nav-link" data-scroll-target="#more-proofs-of-hje">More proofs of HJE</a></li>
  <li><a href="#bonus-noethers-theorem" id="toc-bonus-noethers-theorem" class="nav-link" data-scroll-target="#bonus-noethers-theorem">Bonus: Noether’s theorem</a></li>
  </ul></li>
  <li><a href="#the-particle-wave-duality" id="toc-the-particle-wave-duality" class="nav-link" data-scroll-target="#the-particle-wave-duality">The particle-wave duality</a>
  <ul class="collapse">
  <li><a href="#particle-in-free-space" id="toc-particle-in-free-space" class="nav-link" data-scroll-target="#particle-in-free-space">Particle in free space</a></li>
  <li><a href="#particle-wave-in-free-space" id="toc-particle-wave-in-free-space" class="nav-link" data-scroll-target="#particle-wave-in-free-space">Particle-wave in free space</a></li>
  <li><a href="#particle-in-a-potential-field" id="toc-particle-in-a-potential-field" class="nav-link" data-scroll-target="#particle-in-a-potential-field">Particle in a potential field</a></li>
  <li><a href="#deriving-the-time-independent-schrödinger-equation" id="toc-deriving-the-time-independent-schrödinger-equation" class="nav-link" data-scroll-target="#deriving-the-time-independent-schrödinger-equation">Deriving the time-independent Schrödinger equation</a></li>
  <li><a href="#relativistic-particle-in-free-space" id="toc-relativistic-particle-in-free-space" class="nav-link" data-scroll-target="#relativistic-particle-in-free-space">Relativistic particle in free space</a></li>
  <li><a href="#sec-geometric-optics" id="toc-sec-geometric-optics" class="nav-link" data-scroll-target="#sec-geometric-optics">Geometric optics</a></li>
  <li><a href="#anisotropic-optics" id="toc-anisotropic-optics" class="nav-link" data-scroll-target="#anisotropic-optics">Anisotropic optics</a></li>
  </ul></li>
  <li><a href="#periodic-motion" id="toc-periodic-motion" class="nav-link" data-scroll-target="#periodic-motion">Periodic motion</a>
  <ul class="collapse">
  <li><a href="#oscillator-on-a-line" id="toc-oscillator-on-a-line" class="nav-link" data-scroll-target="#oscillator-on-a-line">Oscillator on a line</a></li>
  <li><a href="#action-angle-variables" id="toc-action-angle-variables" class="nav-link" data-scroll-target="#action-angle-variables">Action-angle variables</a></li>
  <li><a href="#adiabaticity" id="toc-adiabaticity" class="nav-link" data-scroll-target="#adiabaticity">Adiabaticity</a></li>
  <li><a href="#old-quantum-mechanics" id="toc-old-quantum-mechanics" class="nav-link" data-scroll-target="#old-quantum-mechanics">Old quantum mechanics</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<section id="introduction" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>One overarching goal is to show that classical mechanics is bursting at the seams, and to unmask classical mechanics, revealing the quantum mechanics that is deep inside.</p>
<section id="how-i-got-here" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="how-i-got-here">How I got here</h3>
<p>Early 2023, I undertook a serious study of economics. When I was studying <a href="https://en.wikipedia.org/wiki/Ramsey%E2%80%93Cass%E2%80%93Koopmans_model">Ramsey’s theory of optimal saving</a>, I saw, to my great surprise, something they call a “Hamiltonian” <span class="citation" data-cites="campanteAdvancedMacroeconomicsEasy2021">(<a href="#ref-campanteAdvancedMacroeconomicsEasy2021" role="doc-biblioref">Campante, Sturzenegger, and Velasco 2021, chap. 3</a>)</span>. I was shocked, but after studying it carefully, and thinking it over, I realized that it was no mistake – the Hamiltonian really occurs in economics. Moreover, the Hamiltonian in physics really has an economic interpretation. At that moment, suddenly everything fell into place. Those enlightenment-era philosophers saying things like “God has chosen the best of all possible worlds.”<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, or “Nature always acts in the simplest possible manner to produce its effects.”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Leibniz, an originator of calculus and universal genius. In his [1710 book <em>Theodicy</em>], the phrase “best of all” appeared for no less than 13 times:</p>
<blockquote class="blockquote">
<p>It is thus one must think of the creation of the best of all possible universes, all the more since God not only decrees to create a universe, but decrees also to create the best of all.</p>
<p>… the City of God must be the most perfect of all possible states, since it was formed and is perpetually governed by the greatest and best of all Monarchs.</p>
</blockquote>
<p>Etc, etc. Reading a chapter of the book, I felt a hypnotic numbing effect on the brain.</p></div><div id="fn2"><p><sup>2</sup>&nbsp;Maupertuis proposed a version of the principle of least action in <a href="https://en.wikisource.org/wiki/Translation:Accord_between_different_laws_of_Nature_that_seemed_incompatible"><em>Mémoires de l’académie royale des sciences</em>, 1748, 417-426</a>. We will see him soon enough.</p></div></div></section>
</section>
<section id="overview" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<table class="table">
<caption>The economics-mechanics analogy.</caption>
<thead>
<tr class="header">
<th>Symbol</th>
<th>Physics</th>
<th>Economics</th>
<th>Control Theory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(L\)</span></td>
<td>Lagrangian</td>
<td>time-rate of cost</td>
<td>time-rate of cost</td>
</tr>
<tr class="even">
<td><span class="math inline">\(t\)</span></td>
<td>time</td>
<td>time</td>
<td>time</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(q\)</span></td>
<td>location/coordinate</td>
<td>commodity/capital</td>
<td>state variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\dot q\)</span></td>
<td>velocity</td>
<td>investment rate/saving rate/cash flow/etc</td>
<td>control variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(S = \int L(t, q, \dot q)dt\)</span></td>
<td>action</td>
<td>total cost</td>
<td>total cost</td>
</tr>
<tr class="even">
<td><span class="math inline">\(p\)</span></td>
<td>momentum</td>
<td>(shadow) price</td>
<td>co-state variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(H = \sum_i p_i\dot q_i - L\)</span></td>
<td>Hamiltonian</td>
<td>(market equivalent) cash flow<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></td>
<td>Hamiltonian</td>
</tr>
</tbody>
</table>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;also known as "<a href="https://en.wikipedia.org/wiki/Mark-to-market_accounting">mark to market</a> cash flow"</p></div></div><section id="conventions" class="level3">
<h3 class="anchored" data-anchor-id="conventions">Conventions</h3>
<p>We always assume all functions are analytic (that is, they have Taylor expansions).</p>
<p>We would often say "minimize cost" or "maximize revenue" or such, but we are actually merely "stationarizing" everything. For example, when we say “Let’s maximize <span class="math inline">\(f(x)\)</span>”, what we mean is “Let’s solve <span class="math inline">\(f'(x) = 0\)</span>”. We don’t need to check <span class="math inline">\(f''(x) &lt; 0\)</span>. This is not a problem for physics, where the principle of <em>stationary</em> action rules, but in optimal control and economics, we should check if the solution is actually a minimum/maximum.</p>
</section>
</section>
<section id="optimization-as-making-money" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="optimization-as-making-money">Optimization as making money</h2>
<section id="the-shortest-line-problem" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-shortest-line-problem">The shortest line problem</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this problem, the so-called “time” <span class="math inline">\(t\)</span> has units of length as well. So, please don’t panic when we see something like <span class="math inline">\(\sqrt{1 + \dot x^2}\)</span>. If it worries we, we can replace <span class="math inline">\(t\)</span> by <span class="math inline">\(v\tau\)</span>, where <span class="math inline">\(v\)</span> is a constant speed of one, and <span class="math inline">\(\tau\)</span> is time.</p>
</div>
</div>
<p>Start with the easiest problem: shortest path problem. What is the shortest path from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((A, B)\)</span>? We parametrize the path by a function <span class="math inline">\(t \mapsto (x(t), y(t))\)</span>, with <span class="math inline">\(t\in [0, 1]\)</span>. The problem is then</p>
<p><span class="math display">\[\begin{cases} \min \int_0^1 \sqrt{\dot x^2 + \dot y^2}dt \\ \int_0^1 \dot x dt = A \\ \int_0^1 \dot y dt = B \\ \end{cases}\]</span></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/shortest_path_problem.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">What is the shortest path from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((A, B)\)</span>?</figcaption>
</figure>
</div>
<p>This is a standard constraint-optimization problem, and could be solved by the Lagrangian multiplier method:</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>where <span class="math inline">\(p_x, p_y\)</span> are the Lagrangian multipliers, each responsible for enforcing one constraint.</p>
<p>Varying the path functions <span class="math inline">\(x, y\)</span> gives us</p>
<p><span class="math display">\[\delta \int_0^1 (\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y)dt = 0\]</span></p>
<p>Each of <span class="math inline">\(\dot x, \dot y\)</span> could be independently perturbed with a tiny concentrated "pulse", so for the integral to be stationary, the integrand must be zero with respect to derivatives of <span class="math inline">\(\dot x, \dot y\)</span>. That is, we have</p>
<p><span class="math display">\[\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0\\ \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}\]</span></p>
<p>and we are faced with the solution</p>
<p><span class="math display">\[(p_x, p_y) = \frac{1}{\sqrt{\dot x^2 + \dot y^2}}(\dot x, \dot y)\]</span></p>
<p>Since <span class="math inline">\(p_x, p_y\)</span> are independent of time, they are constants, and since we have from the above equation <span class="math inline">\(p_x^2 + p_y^2 = 1\)</span>, we find that <span class="math inline">\(p_x = \cos\theta, p_y = \sin\theta\)</span> for some <span class="math inline">\(\theta\)</span>. Thus, the curve is a straight line making an angle <span class="math inline">\(\theta\)</span> to the x-axis.</p>
</section>
<section id="economic-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="economic-interpretation">Economic interpretation</h3>
<p>Interpret <span class="math inline">\(x, y\)</span> as two goods that we can produce (let’s say, tons of steel and tons of copper).</p>
<p>We are a factory manager, and we are given a task: produce <span class="math inline">\(A\)</span> of <span class="math inline">\(x\)</span> (tons of steel), and <span class="math inline">\(B\)</span> of <span class="math inline">\(y\)</span> (tons of copper), in <span class="math inline">\([0, 1]\)</span> (one year). If we don’t do it, we will be sacked. Our problem is to accomplish the task at minimal cost.</p>
<p><span class="math inline">\(\dot x, \dot y\)</span> are the speed at which we produce the goods, which we can freely control. In control theory, we say <span class="math inline">\(x, y\)</span> are state variables, and <span class="math inline">\(\dot x, \dot y\)</span> are control variables.</p>
<p>The cost function is <span class="math inline">\(L(t, x, y, \dot x, \dot y) = \sqrt{\dot x^2 + \dot y^2}\)</span>. Its integral <span class="math inline">\(S = \int_0^1 L dt\)</span> is the total cost of production, which we must minimize.</p>
<p>We are also given a free market on which we are allowed to buy and sell the goods. If we cannot achieve the production target, we buy from the market. If we achieve more than the production target, we sell them off.</p>
<p>Then, the total cost is</p>
<p><span class="math display">\[\left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right)\]</span></p>
<p>where <span class="math inline">\(p_x, p_y\)</span> are the market prices which do not change with time.</p>
<p>If our production plan is optimal, then the plan must have stationary cost. That is, if we make a change in our production plan <span class="math inline">\((\dot x, \dot y)\)</span> by <span class="math inline">\(O(\delta)\)</span>, our production cost must not change by <span class="math inline">\(O(\delta)\)</span>, or else we could achieve lower cost. For example, if the plan <span class="math inline">\((\dot x + \delta \dot x, \dot y + \delta \dot y)\)</span> achieves higher cost, then <span class="math inline">\((\dot x - \delta \dot x, \dot y - \delta \dot y)\)</span> achieves lower cost.</p>
<p>Mathematically, it means the optimal production plan must satisfy</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>Now, the great thing about the market is that it is always there and we can trade with it, So, we have completely transformed the question into a problem of profit maximization – we’ll always sell to the market, and then buy back from the market right at the end.</p>
<p>Now we can perform profit maximization moment-by-moment: raise production until marginal profit reaches cost:</p>
<p><span class="math display">\[\begin{cases} \partial_{\dot x}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y )= 0\\ \partial_{\dot y}(\sqrt{\dot x^2 + \dot y^2} - p_x \dot x - p_y \dot y ) = 0 \end{cases}\]</span></p>
<p>which may be solved as before.</p>
<p>Now we can interpret <span class="math inline">\(p_x, p_y\)</span>. What are they? Suppose we perturb <span class="math inline">\(\dot x\)</span> by <span class="math inline">\(\delta \dot x\)</span>, then since the production plan is already optimal, we have</p>
<p><span class="math display">\[\delta \left(\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt + p_x \left( A - \int_0^1 \dot x dt\right) + p_y \left( B - \int_0^1 \dot y dt\right) \right) = 0\]</span></p>
<p>that is,</p>
<p><span class="math display">\[p_x \delta \int_0^1 \dot xd t = \delta\int_0^1 \sqrt{\dot x^2 + \dot y^2}dt\]</span></p>
<p>We have our interpretation <span class="math inline">\(p_x\)</span>: the marginal cost of producing one unit of <span class="math inline">\(A\)</span>, That is, if we want an extra <span class="math inline">\(\delta A\)</span>, we have to incur an extra cost <span class="math inline">\(p_x \delta A\)</span>.</p>
<p>We actually have <span class="math inline">\(p_x = \cos \theta, p_y = \sin\theta\)</span>, which means that when <span class="math inline">\(x, y\)</span> are perturbed by <span class="math inline">\(\delta x, \delta y\)</span>, the shortest length between them is perturbed by</p>
<p><span class="math display">\[p_x \delta x + p_y \delta y = \cos\theta \delta x + \sin\theta \delta y\]</span></p>
<p>which is clearly true by geometry.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="The market inside our head">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The market inside our head
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We actually don’t need an external market. We could have put up such a fictional market inside the factory, and simply read out its price <span class="math inline">\(p_x, p_y\)</span> without ever trading with it. Why? Because in this problem, a solution exists, and under some niceness assumptions, there exists a "fair" market price at which we are indifferent to trading with the market – we can sell <span class="math inline">\(\delta x\)</span> and buy <span class="math inline">\(\delta y\)</span>, but there is "no point to it" because it doesn’t change our eventual cost. Thus, although the market exists, we never actually trade with it, so the market might as well be a card-board cutout with a number display of the latest prices. As long as we don’t <em>actually</em> try to trade with it, we would be behaving exactly as if we are facing a real market with the same prices.</p>
<p>It is perhaps best to think of the markets as things inside the head, a system of mental accounting to assign the proper price of everything. If the market prices are truly efficient, then we don’t need a real market to trade with.</p>
<blockquote class="blockquote">
<p>When the producer is ready, the market appears.</p>
<p>When the producer is truly ready, the market disappears.</p>
</blockquote>
</div>
</div>
</div>
</section>
<section id="isoperimetric-problem" class="level3">
<h3 class="anchored" data-anchor-id="isoperimetric-problem">Isoperimetric problem</h3>
<p>If we have a rope of length <span class="math inline">\(S\)</span>, and wish to span it from <span class="math inline">\((0, 0)\)</span> to <span class="math inline">\((T, h)\)</span>, what shape should the rope have, in order to maximize the area under the rope? In formulas, we model the rope as a differentiable function <span class="math inline">\(x(t): [0, T] \to \mathbb R\)</span>, such that</p>
<p><span class="math display">\[\begin{cases}
\max \int_0^T xdt\\
\int_0^T \sqrt{1 + \dot x^2}dt = S \\
\int_0^T \dot x dt = h
\end{cases}\]</span></p>
<p>Here we have two constraints, but the solution is essentially the same. First, to take care of the two constraints, we open two markets <span class="math inline">\(p_h, p_S\)</span> – one for the price of height, and another for the price of rope. Then, solve for</p>
<p><span class="math display">\[\delta \int_0^T \left(x + p_h \left(\frac hT - \dot x\right) +  p_S\left(\frac ST - \sqrt{1+\dot x^2}\right)\right) dt = 0\]</span></p>
<p>The state variable is <span class="math inline">\(x\)</span>, and the control variable is <span class="math inline">\(\dot x\)</span>. Unlike the previous problem, here we need to maximize the integral of the state variable. Consequently, we consider it as a problem of "profit flows".</p>
<p>To make things more clear, let’s explicitly write <span class="math inline">\(v\)</span> as a control variable, and say that the control system satisfies:</p>
<p><span class="math display">\[\begin{cases}
v \text{ is a control variable}\\
x \text{ is a state variable}\\
\dot x = v
\end{cases}\]</span></p>
<p>Given that, how do we control the system? Again, it comes down to putting a price on everything, and maximizing at each instant. So, let’s open a market on commodity <span class="math inline">\(x\)</span>, such that the "fair" price is <span class="math inline">\(p(t)\)</span> at time <span class="math inline">\(t\)</span>. With that, we can write down the profit flow</p>
<p><span class="math display">\[H = x + p_h \left(\frac hT - v\right) +  p_S\left(\frac ST - \sqrt{1+v^2}\right) + p v\]</span></p>
<p>and maximizing profit over all time implies maximizing profit flow at every instant:</p>
<p><span class="math display">\[\partial_v H= 0\]</span></p>
<p>This gives us one equation, but we need one more equation. Namely, we need to know how <span class="math inline">\(p(t)\)</span>, the “fair” price of <span class="math inline">\(x\)</span>, changes with time.</p>
<p>The fundamental problem in pricing theory is this: how do we put a price on something? The fundamental reply from pricing theory is: no-arbitrage (no free money).</p>
<p>Here is how the no-arbitrage argument works. Suppose that we have been following our optimal production plan. Then at time <span class="math inline">\(t\)</span>, we suddenly decide to buy an extra <span class="math inline">\(\delta x\)</span> from the market, save it, then sell <span class="math inline">\(\delta x\)</span> at time <span class="math inline">\(t+ \delta t\)</span>.</p>
<p>Now, since <span class="math inline">\(\dot x = v\)</span>, this buying-and-selling plan does not change how much <span class="math inline">\(x\)</span> grows, so after time <span class="math inline">\(\delta t\)</span>, we have <span class="math inline">\(\delta x(t + \delta t) = \delta x(t)\)</span>. Thus, the no-arbitrage equation states:</p>
<p><span class="math display">\[p(t)\delta x(t) = p(t + \delta t)\delta x(t + \delta t)  + \delta x(t) \delta t \implies p(t+ \delta t) = p(t) - \delta t\]</span></p>
<p>and consequently, <span class="math inline">\(\dot p = -1\)</span>. This is the price dynamics. Intuitively, we see that the value of a standing stock of <span class="math inline">\(x\)</span> decreases as we run out of time to use it for producing.</p>
<p>To solve</p>
<p><span class="math display">\[\partial_v  H= 0\]</span></p>
<p>first expand it to</p>
<p><span class="math display">\[-p_h + p - p_S \frac{\dot x}{\sqrt{1 + \dot x^2}} =  0\]</span></p>
<p>then take derivative with respect to <span class="math inline">\(t\)</span>, to obtain</p>
<p><span class="math display">\[-\frac{\ddot x}{(1+\dot x^2)^{3/2}} = \frac{1}{p_S}\]</span></p>
<p>From elementary calculus, we know the item on the left is the curvature, so we find that the line <span class="math inline">\(x(t)\)</span> is a constant-curvature curve – circular arc. The radius of the circle is the inverse of curvature, which is exactly <span class="math inline">\(p_S\)</span>. Thus we find that, if we are given <span class="math inline">\(\delta S\)</span> more rope, we can encircle <span class="math inline">\(R\delta S\)</span> more area under the rope, where <span class="math inline">\(R\)</span> is the radius of curvature for the circular arc.</p>
<p>Notice that there we are not given the sign of <span class="math inline">\(p_S\)</span>. There are in general two solutions, one being a circular arc curving downwards, and the other curving upwards. If we use <span class="math inline">\(p_S &lt; 0\)</span>, then we get the one curving upwards, and so we get the solution that achieves <em>minimal</em> area under the rope. If we use <span class="math inline">\(p_S &gt; 0\)</span>, then we get the <em>maximal</em> solution. This is a general fact about such problems.</p>
</section>
</section>
<section id="lagrangian-and-hamiltonian-mechanics" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lagrangian-and-hamiltonian-mechanics">Lagrangian and Hamiltonian mechanics</h2>
<p>Generalizing from our experience above, we consider a generic function <span class="math inline">\(L(t, q, v)\)</span>, with finitely many state variables <span class="math inline">\(q_1, ..., q_N\)</span>. For each state variable <span class="math inline">\(q_i\)</span>, we regard its time-derivative as a control variable <span class="math inline">\(v_i\)</span>, which we are free to vary. Our goal is to design a production plan <span class="math inline">\(t \mapsto v(t)\)</span>, such that</p>
<p><span class="math display">\[\delta \int L(t, q(t), v(t)) dt = 0, \quad \dot q = v\]</span></p>
<p>To comply with general sign conventions, we interpret <span class="math inline">\(L\)</span> as cost-per-time, so we <em>say</em> we want to minimize it (even though we only want to stationarize it).</p>
<p>We can understand <span class="math inline">\(i\in\{1, 2,..., N\}\)</span> to denote a commodity, say timber and sugar (let’s say there is such a thing as "negative 1 ton timber" – that is, we can short-sell commodities). Let <span class="math inline">\(p_i\)</span> be the market price of commodity <span class="math inline">\(i\)</span>. Again, there is no need for real market to trade with if the prices are right, since at the right price (no-arbitrage price), we are indifferent between buying and selling, or producing and consuming. It is purely a "mental accounting" device.</p>
<p>With access to a market, our profit flow is:</p>
<p><span class="math display">\[H(t, q, p, v) := \underbrace{\sum_i p_i v_i}_{\text{revenue flow}} - \underbrace{L(t, q, v)}_{\text{cost flow}}\]</span></p>
<p>In words, <span class="math inline">\(H(t, q, p, v)\)</span> is the rate of profit at time <span class="math inline">\(t\)</span> if we hold a stock of commodity <span class="math inline">\(q\)</span>, is producing at rate <span class="math inline">\(v\)</span>, and the market price of commodities is <span class="math inline">\(p\)</span>. This is close to the Hamiltonian, but not yet. We still need to remove the dependence on <span class="math inline">\(v\)</span>.</p>
<p>Moment-by-moment profit-flow maximization is myopic, and could lead us into deadends. That is, it is not a sufficient condition for global profit-maximization. However, it is a necessary condition. That is, suppose we are given a profit-maximizing trajectory, then it must maximize profit flow at every moment, since otherwise we could improve it. In formula:</p>
<p><span class="math display">\[v = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)\]</span></p>
<p>So, define the "optimal controller" as</p>
<p><span class="math display">\[v^\ast (t, q, p) = \mathop{\mathrm{arg\,max}}_v \left(\sum_i p_i v_i - L(t, q, v)\right)\]</span></p>
<p>and define <span class="math inline">\(H\)</span> as the "maximal profit flow" function:</p>
<p><span class="math display">\[H(t, q, p) = \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) = \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))\]</span></p>
<p>By basic convex analysis, if <span class="math inline">\(L\)</span> is strictly convex with respect to <span class="math inline">\(v\)</span>, then <span class="math inline">\(v^*\)</span> is determined uniquely by <span class="math inline">\((t, q, p)\)</span>, and furthermore, it is a continuous function of <span class="math inline">\((t, q, p)\)</span>. Consequently, "profit maximization" allows us to model the system in <span class="math inline">\((t, q, p)\)</span> instead of <span class="math inline">\((t, q, v)\)</span> coordinates, and the dynamics of the system is equivalently specified by either <span class="math inline">\(H\)</span> or <span class="math inline">\(L\)</span>.</p>
<p>This is the mysterious "Legendre transform" that they whisper of. It is better called "convex dual". I also like to joke that the <em>real</em> reason that momentum is written as <span class="math inline">\(p\)</span> is because it secretly means "price"!</p>
<section id="derivatives-of-h" class="level3">
<h3 class="anchored" data-anchor-id="derivatives-of-h">Derivatives of <span class="math inline">\(H\)</span></h3>
<div id="thm-hotelling-lemma" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1 (Hotelling’s lemma)</strong></span> <span class="math inline">\(H(t, q, p)\)</span> is differentiable with respect to <span class="math inline">\(p\)</span>, and <span class="math display">\[
\begin{cases}
    \partial_t H(t, q, p) &amp;= -(\partial_t L)(t, q, v^\ast(t, q, p)) \\
    \nabla_p H(t, q, p) &amp;= v^\ast(t, q, p) \\
    \nabla_q H(t, q, p) &amp;= -(\nabla_q L)(t, q, v^\ast(t, q, p)) \\
\end{cases}
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We prove the first formula. The other two are proved in the same way.</p>
<p>The argument is by no-arbitrage. We can imagine what happens if we were to suffer a little price-shock <span class="math inline">\(\delta p\)</span>, adjust our production plan accordingly to <span class="math inline">\(v + \delta v\)</span>, then <em>hold</em> that production plan and suffer another little price-shock <span class="math inline">\(-\delta p\)</span>. Since we are back to the original price <span class="math inline">\(p\)</span> again, we should have no more than the maximal profit rate. That is, we should have</p>
<p><span class="math display">\[\underbrace{H(t, q, p)}_{\text{maximal rate before shock}} \geq \underbrace{H(t, q, p+\delta p)}_{\text{maximal rate after shock}} + \underbrace{\langle -\delta p, v^\ast(t, q, p+\delta p) \rangle}_{\text{undoing the shock, holding price steady}}\]</span></p>
<p>Since <span class="math inline">\(\delta p\)</span> is infinitesimal, this implies <span class="math inline">\(\left\langle-\delta p , \nabla_v H\right\rangle \geq \left\langle-\delta p , v^*(t, q, p)\right\rangle + O(\delta^2)\)</span> for all <span class="math inline">\(\delta p\)</span>, implying <span class="math inline">\(\nabla_v H = v^\ast(v^*(t, q, p))\)</span>.</p>
</div>
</div>
</div>
<p>Here, we explicitly put a bracket around <span class="math inline">\(\partial_t L\)</span> to emphasize that we mean</p>
<p><span class="math display">\[\lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon}\]</span></p>
<p>rather than</p>
<p><span class="math display">\[\lim_{\epsilon \to 0} \frac{L(t + \epsilon, q, v^\ast(t + \epsilon, q, p)) - L(t, q, v^\ast(t, q, p))}{\epsilon}\]</span></p>
<p>and similarly for <span class="math inline">\(\nabla_q L\)</span>.</p>
</section>
<section id="hamiltonian-equations-of-motion" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-equations-of-motion">Hamiltonian equations of motion</h3>
<p>We are given free control over <span class="math inline">\(\dot q\)</span>, and we saw that the cost-minimizing trajectory must maximize the profit flow moment-by-moment. That is,</p>
<p><span class="math display">\[\dot q(t) = v^\ast(t, q(t), p(t)) = (\nabla_p H)(t, q(t), p(t))\]</span></p>
<p>or more succinctly (you can see why we tend to be rather sloppy with notations!)</p>
<p><span class="math display">\[\dot q \underbrace{=}_{\text{optimality}} v^\ast \underbrace{=}_{\text{Hotelling's lemma}} \nabla_p H\]</span></p>
<p>More evocatively speaking, we have two opposing forces of greed and no-arbitrage, clashing together to give something interesting:</p>
<p><span class="math display">\[\dot q \underbrace{=}_{\text{we are greedy}} v^\ast \underbrace{=}_{\text{but the market gives us no free money}} \nabla_p H\]</span></p>
<p>It remains to derive <span class="math inline">\(\dot p\)</span> by the no-arbitrage condition: If we shock the system with some <span class="math inline">\(\delta q_i\)</span>, it does not matter if we sell it now, or carry it <span class="math inline">\(\delta t\)</span>, incurring additional cost, and sell it later. That is,</p>
<p><span class="math display">\[p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t \implies \dot p_i = \partial_{q_i} L(t, q, v)\]</span></p>
<div id="tip-higher-order-infinitesimal" class="callout callout-style-default callout-tip callout-titled" title="higher-order infinitesimal">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: higher-order infinitesimal
</div>
</div>
<div class="callout-body-container callout-body">
<p>The equality should be more precisely read as "up to a higher-order infinitesimal than <span class="math inline">\(\delta q_i\delta t\)</span>". That is, we should be writing:</p>
<p><span class="math display">\[
p_i(t) \delta q_i = p_i(t+\delta t) \delta q_i - \partial_{q_i} L(t, q, v) \delta q_i \delta t  + o(\delta q_i\delta t)
\]</span></p>
<p>This detail would come up later in our proof of the <a href="#thm-hje">Hamilton–Jacobi equation</a>.</p>
</div>
</div>
<p>Since we are only concerned with what happens on the optimal trajectory, we always choose <span class="math inline">\(v = v^\ast\)</span>, so</p>
<p><span class="math display">\[\dot p_i = (\partial_{q_i} L)(t, q, v^\ast(t, q, p)) \underbrace{=}_{\text{Hotelling's lemma}} -\partial_{q_i} H(t, q, p)\]</span></p>
<p>Thus, we obtain the two fundamental equations of Hamiltonian mechanics:</p>
<div id="thm-hem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 2 (Hamilton equations of motion)</strong></span> <span class="math display">\[\begin{cases}  
\partial_t H &amp;= -\partial_t L \\
\dot p = -\nabla_q H \\     
\dot q = \nabla_p H
\end{cases}\]</span></p>
</div>
</section>
<section id="eulerlagrange-equations-of-motion" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="eulerlagrange-equations-of-motion">Euler–Lagrange equations of motion</h3>
<p>By definition,</p>
<p><span class="math display">\[H(t, q, p) =  \max_{v} \left(\sum_i p_i v_i - L(t, q, v)\right) =  \sum_i p_i v_i^\ast(t, q, p) - L(t, q, v^\ast(t, q, p))\]</span></p>
<p>and since <span class="math inline">\(L\)</span> is strictly convex in <span class="math inline">\(v\)</span>, this can be inverted (this is called "<strong>convex duality</strong>") to give</p>
<p><span class="math display">\[L(t, q, v) =  \max_{p} \left(\sum_i p_i v_i - H(t, q, p)\right) =  \sum_i p^\ast_i v_i - H(t, q, p^\ast(t, q, p))\]</span></p>
<p>where <span class="math inline">\(p^\ast = \mathop{\mathrm{arg\,max}}_p \sum_i p_i v_i - H(t, q, p)\)</span>. It is a basic theorem in convex geometry that, if <span class="math inline">\(L\)</span> is strictly convex in <span class="math inline">\(v\)</span>, then <span class="math inline">\(H\)</span> is strictly convex in <span class="math inline">\(p\)</span>, so the inversion works.</p>
<p>By the same argument as in Hotelling’s lemma, we have</p>
<p><span class="math display">\[\nabla_v L(t, q, v) = p^\ast(t, q, v)\]</span></p>
<p>By definition of the convex dual, for any <span class="math inline">\(t, q, p, v\)</span>, we have</p>
<p><span class="math display">\[H(t, q, p) + L(t, q, v) \leq \sum_i p_i v_i\]</span></p>
<p>with equality reached iff both <span class="math inline">\(p = p^\ast(t, q, v)\)</span> and <span class="math inline">\(v = v^\ast(t, q, p)\)</span>. Thus, on any optimal trajectory, since <span class="math inline">\(v = v^\ast(t, q, p)\)</span>, we must also have <span class="math inline">\(p = p^\ast(t, q, v)\)</span>, and consequently,</p>
<p><span class="math display">\[\frac{d}{dt} \nabla_v L \underbrace{=}_{\text{Hotelling's lemma}} \dot p^\ast \underbrace{=}_{\text{optimality}} \dot p \underbrace{=}_{\text{no-arbitrage}} \nabla_q L\]</span></p>
<p>This is the famous</p>
<div id="thm-elem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 3 (Euler–Lagrange equations of motion)</strong></span> <span class="math display">\[
\frac{d}{dt} (\partial_{v_i} L) = (\nabla_{q_i} L) \quad \forall i \in \{1, 2, \dots, N\}
\]</span></p>
<p>or more succinctly,</p>
<p><span class="math display">\[
\frac{d}{dt} (\nabla_v L) = \nabla_q L
\]</span></p>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="explaining the notation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
explaining the notation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Physicists are often sloppy with notations, but the Euler–Lagrange equation is particularly egregious in this regard, so I will describe it carefully.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>The function <span class="math inline">\(L\)</span> is a function of type <span class="math inline">\(\underbrace{\mathbb{R}}_{\text{time}} \times \underbrace{\mathbb{R}^N}_{\text{state}} \times \underbrace{\mathbb{R}^N}_{\text{control}} \to \mathbb{R}\)</span>.</p>
<p>The function <span class="math inline">\(\partial_{v_i} L\)</span> is also a function of type <span class="math inline">\(\mathbb{R}\times \mathbb{R}^N \times \mathbb{R}^N \to \mathbb{R}\)</span>. It is obtained by taking derivative of <span class="math inline">\(L\)</span> over its <span class="math inline">\((1 + i)\)</span>-th input. Let’s write that as <span class="math inline">\(f_i\)</span> to make sure we are not confused by it. It is absolutely important to be clear about this! <span class="math inline">\(f_i\)</span> is <em>not</em> a function defined only along a trajectory, but over the entire space of <span class="math inline">\(\mathbb{R}\times \mathbb{R}^N \times \mathbb{R}^N\)</span>. We can similarly define <span class="math inline">\(f_{i + N}\)</span> to be <span class="math inline">\(\partial_{q_i} L\)</span>.</p>
<p>Now, suppose we are given a <em>purportedly optimal</em> trajectory <span class="math inline">\(q: \mathbb{R}\to \mathbb{R}^N\)</span>, then for any coordinate <span class="math inline">\(i \in \{1, 2, \dots, N\}\)</span>, we can define a function <span class="math inline">\(g_i\)</span>, of type <span class="math inline">\(\mathbb{R}\to \mathbb{R}\)</span> by</p>
<p><span class="math display">\[
g_i(t) = f_i(t, q(t), \dot q(t))
\]</span></p>
<p>and similarly, we can define <span class="math inline">\(g_{i + N} = f_{i + N}(t, q(t), \dot q(t))\)</span>.</p>
<p>The Euler–Lagrange equations say that, we need only check</p>
<p><span class="math display">\[
g_i'(t) = g_{i+N}(t) \quad \forall t \in [0, T], i \in 1:N
\]</span></p>
<p>to certify that the <em>purportedly</em> stationary trajectory <span class="math inline">\(q\)</span> is truly stationary.</p>
</div>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;I am okay with sloppy notation sometimes, but in this case, the sloppy notation often leads to calculational mistakes and conceptual confusions, as teachers of undergrad courses can testify.</p></div></div></section>
<section id="what-does-it-all-mean" class="level3">
<h3 class="anchored" data-anchor-id="what-does-it-all-mean">What does it all mean?</h3>
<p>In the Lagrangian formalism, we are given a system with <span class="math inline">\(q\)</span> coordinates, and allowed to manipulate <span class="math inline">\(\dot q\)</span> however we want, in order to minimize a "cost" function <span class="math inline">\(\int_0^T L(t, q, \dot q)dt\)</span>.</p>
<p>In the Hamiltonian formalism, we are also given a market to trade with. We attempt to maximize profit by varying production, buying, and selling. However, the market simultaneously adjusts its prices <span class="math inline">\(p\)</span> in just the right way so that we are always indifferent about the market (if we are ever not indifferent, the market is in serious trouble – it doesn’t actually carry any real commodity!), so we never actually make any trade. The market has been in our heads all along, but its effects are very real.</p>
<p>Assuming this kind of double optimization (we against the market, and the market against us), the trajectory is uniquely determined by several possible specifications. We may fix it by <span class="math inline">\((t_0, q_0, p_0)\)</span>, or by <span class="math inline">\((t_0, q_0), (t, q)\)</span>, or by <span class="math inline">\((t_0, q_0, v_0)\)</span>, or perhaps more exotic constraints that mix up <span class="math inline">\(t, q, p, v\)</span>.</p>
<p>Ironically, the Hamiltonian equations of motion flow out naturally in this economic interpretation, with no fuss whatsoever. The Euler–Lagrange equations are derived only as an after-thought. This is exactly backwards compared to the usual way of teaching, where the EL equations are derived first, and the Hamiltonian equations are derived by an unmotivated “Let us define <span class="math inline">\(H = \sum_i p_i q_i - L\)</span> …”, followed by some clumsy and unjustified derivations.</p>
<p>In classical control theory, the price vector <span class="math inline">\(p\)</span> is called "costate" since it is multiplied with the state <span class="math inline">\(q\)</span>, and <span class="math inline">\(\dot p= -\nabla_q H\)</span> is called the "costate equation". The above methods can be generalized to account for constraints, yielding Pontryagin’s maximum principle, among other results.</p>
</section>
<section id="cyclic-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="cyclic-coordinates">Cyclic coordinates</h3>
<p>Given a system defined by a Lagrangian function <span class="math inline">\(L(t, q, v)\)</span>, we say that it is <strong>cyclic</strong> in the coordinate <span class="math inline">\(q_i\)</span> if <span class="math inline">\(L\)</span> does not depend on <span class="math inline">\(q_i\)</span>. By definition of</p>
<p><span class="math display">\[H(t, q, p) = \max_v \left(\sum_i p_i v_i - L(t, q, v)\right)
\]</span></p>
<p>we see that if <span class="math inline">\(L\)</span> does not depend on <span class="math inline">\(q_i\)</span>, then <span class="math inline">\(H\)</span> also does not depend on <span class="math inline">\(q_i\)</span>. Consequently, any optimal trajectory satisfies <span class="math inline">\(\dot p_i = -\partial_{q_i} H = 0\)</span>. That is, <span class="math inline">\(p_i\)</span> is conserved – <strong>conservation of generalized momentum</strong>.</p>
</section>
<section id="bonus-routhian-mechanics" class="level3">
<h3 class="anchored" data-anchor-id="bonus-routhian-mechanics">Bonus: Routhian mechanics</h3>
<p>Suppose that the market does not contain all commodities, but only the last <span class="math inline">\(n\)</span> commodities. That is, let <span class="math inline">\(q_{1:N} = (q_{1:s}, q_{s+1:s+n})\)</span>, and only open markets on <span class="math inline">\(q_{s+1:s+n}\)</span>. The optimal cash flow equation then gives us the "Routhian":</p>
<p><span class="math display">\[
R(t, q, v_{1:s}, p_{s+1:N}) = \max_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)
\]</span></p>
<p>As before, the optimal control variables are <span class="math inline">\(v_{s+1:N}^\ast = \mathop{\mathrm{arg\,max}}_{v_{s+1:N}} \left(\sum_{i=s+1}^n p_i v_i - L(t, q, v)\right)\)</span>.</p>
<div id="thm-routhian" class="theorem">
<p><span class="theorem-title"><strong>Theorem 4 (Routhian equations of motion)</strong></span> <span class="math display">\[
\begin{cases}
    \partial_t R &amp;= -\partial_t L \\
    \frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s\\
    \begin{cases}
    \dot q_i = \partial_{p_i} R \\ \dot p_i = -\partial_{q_i} R
    \end{cases}\quad &amp; i\in s+1:N
\end{cases}
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>By the same argument as in Hotelling’s lemma, we have</p>
<p><span class="math display">\[
\begin{cases}
    \partial_t R = -\partial_t L \\
    \nabla_q R = -\nabla_q L \\
    \nabla_{v_{1:s}} R = -\nabla_{v_{1:s}} L \\
    \nabla_{p_{s+1 : N}} R = v^*_{s+1 : N}
\end{cases}
\]</span></p>
<p>Plugging the 2-th and 3-th equations into the original Euler–Lagrange equations, we obtain</p>
<p><span class="math display">\[\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s\]</span></p>
<p>The 4-th equation gives</p>
<p><span class="math display">\[\dot q_i =v_i^\ast = \partial_{p_i} R, \quad \forall i\in s+1:N\]</span></p>
<p>For <span class="math inline">\(i\in s+1:N\)</span>, we can obtain the price dynamic of the partial market by the no-arbitrage condition, giving</p>
<p><span class="math display">\[\dot p_i = \partial_{q_i} L = -\partial_{q_i} R\]</span></p>
</div>
</div>
</div>
<p>We see that the first <span class="math inline">\(s\)</span> equations look just like the EL equations, but the next <span class="math inline">\(2n\)</span> equations look just like the Hamiltonian equations. The Routhian equations make an awkward hybrid.</p>
<blockquote class="blockquote">
<p>… as a fundamental entity, the Routhian is a sterile hybrid, combining some of the features of both the Lagrangian and the Hamiltonian pictures. For the development of various formalisms of classical mechanics, the complete Hamiltonian formulation is more fruitful.</p>
<p><span class="citation" data-cites="goldsteinClassicalMechanics2008">(<a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008, sec. 8.3</a>)</span></p>
</blockquote>
<section id="application-to-cyclic-coordinates" class="level4">
<h4 class="anchored" data-anchor-id="application-to-cyclic-coordinates">Application to cyclic coordinates</h4>
<p>Though the Routhian equations are theoretically useless, they are useful for solving specific problems. For some worked examples of using the Routhian, see the <a href="https://en.wikipedia.org/wiki/Routhian_mechanics#Examples">Wikipedia page</a>.</p>
<p>While the Euler–Lagrangian equations are <span class="math inline">\(N\)</span> second-degree differential equations, the Hamiltonian equations are <span class="math inline">\(2N\)</span> first-degree differential equations. We are essentially trading derivatives for equation numbers.</p>
<p>Though the EL equations and the Hamiltonian equations are philosophically different, for solving particular problems, they often end up giving the same equations anyway. Specifically, if we are solving the Hamiltonian equations for a concrete example, by eliminating the variables <span class="math inline">\(p\)</span>, we often end up right back to the Euler–Lagrange equations. This would be quite the detour, and if there are cyclic coordinates, the Routhian could save us some trouble.</p>
<p>If we have a system that is cyclic in the last <span class="math inline">\(n\)</span> coordinates, then since <span class="math inline">\(\nabla_q R = -\nabla_q L\)</span>, its Routhian satisfies <span class="math inline">\(\partial_{q_i} R = 0\)</span> for the last <span class="math inline">\(n\)</span> coordinates too. Then we find that the Routhian equations become:</p>
<p><span class="math display">\[
\begin{cases}
\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad &amp; i \in 1:s\\
\begin{cases}
\dot q_i = \partial_{p_i} R \\  p_i = p_i(0)
\end{cases}\quad &amp; i\in s+1:N
\end{cases}
\]</span></p>
<p>giving us <span class="math inline">\(n\)</span> first-degree equations and <span class="math inline">\(N-n\)</span> second-degree equations. If we were to start with the Hamiltonian equations of motion, we would get</p>
<p><span class="math display">\[
\begin{cases}
\dot q_i = \partial_{p_i} H \\  p_i = p_i(0)
\end{cases}\quad i\in s+1:N
\]</span></p>
<p>by the same reasoning, and then laboriously eliminate the variables <span class="math inline">\(p_i\)</span> for <span class="math inline">\(i \in 1:s\)</span>, and end up with <span class="math inline">\(s\)</span> second-degree differential equations, often exactly the same as the first <span class="math inline">\(s\)</span> Routhian equations:</p>
<p><span class="math display">\[\frac{d}{dt} \partial_{v_i} R = \partial_{q_i}R \quad i \in 1:s\]</span></p>
<p>This is how the Routhian saves us some effort in practical calculations. It is useful in this way, and in this way only.</p>
</section>
</section>
</section>
<section id="bonus-higher-order-lagrangians-and-hamiltonians" class="level2">
<h2 class="anchored" data-anchor-id="bonus-higher-order-lagrangians-and-hamiltonians">Bonus: Higher-order Lagrangians and Hamiltonians</h2>
<p>What happens if we use a Lagrangian with higher-order derivatives? It turns out that even in this case, we can still use economic reasoning to derive its Hamiltonian and Euler–Lagrangian equations</p>
<div id="exr-higher-order-hamiltonian" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1</strong></span> Read the following sections, then generalize the derivation to <span class="math inline">\(n\)</span>-th-order derivatives.</p>
</div>
<p>This construction of Hamiltonians from higher-order Lagrangians is often called <strong>Ostrogradsky theorem</strong> or <strong>Ostrogradsky instability</strong>, because Ostrogradsky published it in 1850 <span class="citation" data-cites="ostrogradskyMemoiresEquationsDifferentielles1850">(<a href="#ref-ostrogradskyMemoiresEquationsDifferentielles1850" role="doc-biblioref">Ostrogradsky 1850</a>)</span> after seeing Hamilton’s paper of 1833 <span class="citation" data-cites="hamiltonGeneralMethodExpressing1833">(<a href="#ref-hamiltonGeneralMethodExpressing1833" role="doc-biblioref">Hamilton 1833</a>)</span>. He did not note its implications for instability, which was first noted by Pais and Uhlenbeck in 1950 <span class="citation" data-cites="paisFieldTheoriesNonLocalized1950">(<a href="#ref-paisFieldTheoriesNonLocalized1950" role="doc-biblioref">Pais and Uhlenbeck 1950</a>)</span>. For this reason, it’s also called the <strong>Pais–Uhlenbeck model</strong>.</p>
<section id="when-lagrangian-also-depends-on-acceleration" class="level3">
<h3 class="anchored" data-anchor-id="when-lagrangian-also-depends-on-acceleration">When Lagrangian also depends on acceleration</h3>
<p>When the Lagrangian depends not just on position and velocity, but also acceleration, the total cost to be optimized is:</p>
<p><span class="math display">\[S(q) := \int L(t, q^{(0)}, q^{(1)}, q^{(2)})dt\]</span></p>
<p>where <span class="math inline">\(q^{(n)}\)</span> is a symbol that <em>suggests</em> itself to be the <span class="math inline">\(n\)</span>-th time-derivative of the optimal trajectory <span class="math inline">\(q\)</span>, although it is actually defined for any tuple of real numbers, even when we don’t have <span class="math inline">\(q^{(1)}(t) = \frac{d}{dt}q^{(0)}(t)\)</span>.</p>
<p>Our previous method, which is to open a market on position <span class="math inline">\(q\)</span>, fails for two reasons:</p>
<ol type="1">
<li>The producer cannot optimize its velocity, because now velocity is no longer a control variable. Now, both position and velocity are state variables, and only acceleration is a control variable.</li>
<li>The producer cannot buy and sell velocity, so it has no price signal to optimize its acceleration (how fast it produces velocity).</li>
</ol>
<p>If the market fails, make it bigger: allow the market to buy and sell not just position, but also velocity.</p>
<p>We open a market of both positions and velocities. The price vector of positions is <span class="math inline">\(p^{(0)}\)</span> and the price vector of velocities is <span class="math inline">\(p^{(1)}\)</span>. Then, the maximal profit flow is</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \max_{ q^{(2)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>and the optimal production plan is</p>
<p><span class="math display">\[q^{(2)\ast} = \mathop{\mathrm{arg\,max}}_{ q^{(2)}}(\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - L)\]</span></p>
</section>
<section id="ostrogradsky-instability-and-the-anthropic-principle" class="level3">
<h3 class="anchored" data-anchor-id="ostrogradsky-instability-and-the-anthropic-principle">Ostrogradsky instability and the anthropic principle</h3>
<p>We will show that the quantity does deserve the name of “Hamiltonian”:</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>Assuming that, we have a serious problem. Consider an oscillator with higher-order derivatives. Since its Hamiltonian contains a term <span class="math inline">\(\langle p^{(0)} , q^{(1)}\rangle\)</span>, it is linear with respect to <span class="math inline">\(p^{(0)}\)</span> and <span class="math inline">\(q^{(1)}\)</span>. In other words, it can have arbitrarily <em>low</em> energy states.</p>
<p>Now, this could be alright if we live in a classical world, but we live in a world described by quantum field theory. In QFT, the world is a giant network of oscillators. If a quantum oscillator has higher-order derivatives, then its energy levels can go both infinitely high and low. If there is any coupling at all between its energy levels, it would instantly evaporates into infinitely many positive and negative energy particles, in a blaze of vacuum decay.</p>
<p>This is an anthropic explanation for “Why Newton’s laws?” Newton’s laws, because the Lagrangian depends on only up to velocity. Why? Because if it also depends on acceleration, the vacuum would decay <span class="citation" data-cites="swansonOstrogradskiInstabilityWhy2022">(<a href="#ref-swansonOstrogradskiInstabilityWhy2022" role="doc-biblioref">Swanson 2022</a>)</span>. We can similarly explain anthropically why space has 3 dimensions, and time has 1 dimension.</p>
<blockquote class="blockquote">
<p>With more or less than one time dimension, the partial differential equations of nature would lack the hyperbolicity property that enables observers to make predictions. In a space with more than three dimensions, there can be no traditional atoms and perhaps no stable structures. A space with less than three dimensions allows no gravitational force and may be too simple and barren to contain observers.</p>
<p><span class="citation" data-cites="tegmarkDimensionalitySpacetime1997">(<a href="#ref-tegmarkDimensionalitySpacetime1997" role="doc-biblioref">Tegmark 1997</a>)</span>.</p>
</blockquote>
</section>
<section id="hamiltonian-equations" class="level3">
<h3 class="anchored" data-anchor-id="hamiltonian-equations">Hamiltonian equations</h3>
<p>We can prove the Hotelling’s lemma for this Hamiltonian, using the same no-arbitrage argument as before:</p>
<p><span class="math display">\[\begin{cases}     
    \partial_t H = -\partial_t L \\  
    \nabla_{q^{(0)}} H = -\nabla_{q^{(0)}} L \\     
    \nabla_{q^{(1)}} H = p^{(0)}-\nabla_{q^{(1)}} L \\     
    \nabla_{p^{(0)}} H = q^{(1)} \\     
    \nabla_{p^{(1)}} H = q^{(2)\ast}
\end{cases}\]</span></p>
<p>Along an optimal trajectory, the producer always chooses <span class="math inline">\(\dot q^{(1)} = q^{(2)\ast}\)</span>, and has no choice in <span class="math inline">\(\dot q^{(0)} = q^{(1)}\)</span>, so we have two equations of motion:</p>
<p><span class="math display">\[\begin{cases}     
\dot q^{(1)} = q^{(2)\ast} = \nabla_{p^{(1)}} H\\    
\dot q^{(0)} = q^{(1)} = \nabla_{p^{(0)}} H
\end{cases}\]</span></p>
<p>The market must adjust its prices by the no-arbitrage condition, as before. If we inflict a position shock of <span class="math inline">\(\delta q^{(0)}\)</span>, then by no-arbitrage, selling it now or later is equally (up to order <span class="math inline">\(\delta^2\)</span>) profitable:</p>
<p><span class="math display">\[\langle p^{(0)} , \delta q^{(0)}\rangle = \langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(0)}\rangle - \langle \nabla_{q^{(0)}} L , \delta q^{(0)}\rangle \delta t\]</span></p>
<p>yielding <span class="math inline">\(\dot p^{(0)} = \nabla_{q^{(0)}} L = -\nabla_{q^{(0)}} H\)</span>.</p>
<p>For the last equation of motion, inflict a velocity shock of <span class="math inline">\(\delta q^{(1)}\)</span>. The effect of the shock include both its effect on <span class="math inline">\(q^{(0)}\)</span> and <span class="math inline">\(L\)</span>, thus the no-arbitrage equation states:</p>
<p><span class="math display">\[\underbrace{\langle p^{(1)} , \delta q^{(1)}\rangle}_{\text{selling now}} =  \underbrace{\langle p^{(1)} + \dot p^{(1)} \delta t , \delta q^{(1)}\rangle}_{\text{selling later}} + \underbrace{\langle p^{(0)} + \dot p^{(0)} \delta t , \delta q^{(1)}\delta t\rangle}_{\text{profit from extra }p^{(0)}} - \underbrace{\langle \nabla_{q^{(1)}} L , \delta q^{(1)}\rangle \delta t}_{\text{cost from holding extra }p^{(1)}}\]</span></p>
<p>which yields the last equation <span class="math inline">\(\dot p^{(1)} = \nabla_{q^{(1)}} L - p^{(0)} = -\nabla_{q^{(1)}} H\)</span>.</p>
<p>In summary, we have</p>
<div id="thm-higher-hem" class="theorem">
<p><span class="theorem-title"><strong>Theorem 5 (higher-order Hamiltonian equations of motion:)</strong></span> <span class="math display">\[
\begin{cases}     
    \dot q^{(1)} = \nabla_{p^{(1)}} H\\     
    \dot q^{(0)} = \nabla_{p^{(0)}} H \\     
    \dot p^{(0)} = -\nabla_{q^{(0)}} H \\     
    \dot p^{(1)} = -\nabla_{q^{(1)}} H  
\end{cases}
\]</span></p>
</div>
</section>
<section id="eulerlagrange-equations" class="level3">
<h3 class="anchored" data-anchor-id="eulerlagrange-equations">Euler–Lagrange equations</h3>
<p>In order to obtain the Euler–Lagrange equations of motion, we need to work backwards from the Hamiltonian equations of motion as before.</p>
<p>From the Hamiltonian, we can go back to the Lagrangian by inverting the convex transform:</p>
<p><span class="math display">\[L(t, q^{(0)}, q^{(1)}, q^{(2)})  = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(0)} , q^{(1)}\rangle + \langle p^{(1)} , q^{(2)}\rangle - H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}))\]</span></p>
<p>Here we are given a hint of the troubles ahead. Since <span class="math inline">\(H\)</span> is linear in <span class="math inline">\(p^{(1)}\)</span>:</p>
<p><span class="math display">\[H(t,  q^{(0)}, q^{(1)}, p^{(0)}, p^{(1)}) = \langle p^{(0)} , q^{(1)}\rangle + \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>there is no way to fix <span class="math inline">\(p^{(1)}\)</span> in the inverse transform! In detail, we plug the equation for <span class="math inline">\(H\)</span> into the equation for <span class="math inline">\(L\)</span>, to get</p>
<p><span class="math display">\[L(t, q^{(0)}, q^{(1)}, q^{(2)}) = \max_{p^{(0)} ,p^{(1)}} (\langle p^{(1)} , q^{(2)}\rangle - \max_{ q^{(2)}} (\langle p^{(1)} , q^{(2)}\rangle - L(t, q^{(0)}, q^{(1)}, q^{(2)}))\]</span></p>
<p>and we see that there is <em>no</em> optimality constraint on <span class="math inline">\(p^{(0)}\)</span>. This is a hint of instabilities ahead.</p>
<p>Differentiating <span class="math inline">\(L\)</span>, we get</p>
<p><span class="math display">\[\begin{cases}
\partial_t L = -\partial_t H\\
\nabla_{q^{(0)}}L = -\nabla_{q^{(0)}}H \\
\nabla_{q^{(1)}}L = p^{(0)} - \nabla_{q^{(1)}}H \\
\nabla_{q^{(2)}}L = p^{(1)\ast}  
\end{cases}\]</span></p>
<p>Now, along the optimal trajectory, we must have <span class="math inline">\(\nabla_{q^{(2)}}L = p^{(1)\ast}\)</span>, so taking its time-derivative, we get</p>
<p><span class="math display">\[\frac{d}{dt}\nabla_{q^{(2)}}L = \dot p^{(1)} = -\nabla_{q^{(1)}}H = \nabla_{q^{(1)}}L - p^{(0)}\]</span></p>
<p>Take another time-derivative, to obtain the Euler–Lagrange equations of motion:</p>
<p><span class="math display">\[\sum_{i=0}^2\left(-\frac{d}{d t}\right)^i (\nabla_{q^{(i)}} L ) =0\]</span></p>
<p>The generalization to <span class="math inline">\(L(t, q^{(0)}, ..., q^{(N-1)})\)</span> is immediate. It can be derived by a similar argument through the market economy.</p>
</section>
<section id="an-unstable-higher-order-oscillator" class="level3">
<h3 class="anchored" data-anchor-id="an-unstable-higher-order-oscillator">An unstable higher-order oscillator</h3>
<p>It is beyond our scope to discuss Ostrogradsky instability in quantum field theory, however, we can have a taste of it here. Consider the oscillator perturbed by <span class="math inline">\(\epsilon\)</span>:</p>
<p><span class="math display">\[L = \frac 12 m\dot x^2 - \frac 12 kx^2 - \frac 12 \epsilon \ddot x^2\]</span></p>
<p>Its EL equation is</p>
<p><span class="math display">\[\epsilon x^{(4)} + m\ddot x + kx = 0\]</span></p>
<p>a linear order-4 equation, so its solutions are of the form <span class="math inline">\(x = \sum_{i=1}^4 a_i e^{z_i t}\)</span>, where <span class="math inline">\(z_1, z_2, z_3, z_4\)</span> are its fundamental (complex) frequencies. Plug them in the equation and solve it simply:</p>
<p><span class="math display">\[z = \pm \sqrt{-\frac{1}{2\epsilon} (m \pm \sqrt{m^2 - 4\epsilon k})}\]</span></p>
<p>At small <span class="math inline">\(|\epsilon|\)</span> limit, we have</p>
<p><span class="math display">\[z \approx \pm i\sqrt{\frac km}, \pm\sqrt{-\frac m\epsilon}\]</span></p>
<p>and so if <span class="math inline">\(\epsilon &lt; 0\)</span>, one of the modes is exponentially growing at rate <span class="math inline">\(\sqrt{m/|\epsilon|}\)</span>.</p>
<p>If <span class="math inline">\(\epsilon &gt; 0\)</span>, then the oscillator survives, with two modes of oscillation of frequency <span class="math inline">\(\sqrt{\frac km}\)</span> and <span class="math inline">\(\sqrt{\frac{m}{\epsilon}}\)</span>. When there is viscous force, however, this delicate stability is destroyed. <span class="citation" data-cites="nesterenkoInstabilityClassicalDynamics2007">(<a href="#ref-nesterenkoInstabilityClassicalDynamics2007" role="doc-biblioref">Nesterenko 2007</a>)</span></p>
<p>The equation of motion in this case is</p>
<p><span class="math display">\[\epsilon x^{(4)} + m\ddot x + \gamma \dot x + kx = 0\]</span></p>
<p>The algebraic equation to solve is now <span class="math inline">\(\epsilon z^4 - mz^2 + i\gamma z + k = 0\)</span>.</p>
</section>
</section>
<section id="hamiltonjacobi-equation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="hamiltonjacobi-equation">Hamilton–Jacobi equation</h2>
<p>Consider again the integral of Lagrangian: <span class="math inline">\(\int L dt\)</span>. If we fix the starting point <span class="math inline">\((t_0, q_0)\)</span> and the ending point <span class="math inline">\((t, q)\)</span>, then in general there can be a countable number of paths that connect both points. This is a serious problem, but we are saved by the fact that these paths are separated, in the sense that around each path <span class="math inline">\(\gamma\)</span>, there is a small neighborhood, in which there exists no other path <span class="math inline">\(\gamma\)</span> that connects the two points <span class="math inline">\((t_0, q_0), (t, q)\)</span>.</p>
<p>As a prototype, consider a billiard ball in a circular table.</p>
<section id="billiards-in-a-circular-board" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="billiards-in-a-circular-board">Billiards in a circular board</h3>
<p>When both <span class="math inline">\(q_0, q\)</span> are the center of the billiard table, then there are <span class="math inline">\(S^1 \times \mathbb{N}\)</span> ways to go from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span> over the interval <span class="math inline">\([t_0,t]\)</span>. Here, <span class="math inline">\(S^1\)</span> denotes the circle of possible directions, and <span class="math inline">\(\mathbb{N}\)</span> denotes the discrete number of starting speeds: <span class="math inline">\(\frac{2R}{t-t_0}, \frac{4R}{t-t_0}, \dots\)</span>.</p>
<p>When not both of them are in the center, then there are only in general <span class="math inline">\(\mathbb{N}\)</span> ways to go from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span> over the interval <span class="math inline">\([t_0,t]\)</span>.</p>
<p>Consider a billiard ball in a circular (not elliptical) table. Let <span class="math inline">\(q, q_0\)</span> be any two points inside the table, not both on the center, and <span class="math inline">\(t_0 &lt; t\)</span> be two moments in time, then there are a countable infinity of possible trajectories that reach <span class="math inline">\((t, q)\)</span> from <span class="math inline">\((t_0, q_0)\)</span>.</p>
<p>There are two ways to see this visually, a particle way and a wave way.</p>
<p>For the particle way, define:</p>
<ul>
<li>the billiard’s starting angle is <span class="math inline">\(\theta\)</span>, with <span class="math inline">\(\theta\)</span> chosen such that when <span class="math inline">\(\theta = 0\)</span>, the billiard would move on a diameter of the table.</li>
<li><span class="math inline">\(l(\theta, n)\)</span> is the oriented line segment that starts at the point where the billiard’s hits the table for the <span class="math inline">\(n\)</span>-th time, and ends at the point where it hits for the <span class="math inline">\((n+1)\)</span>-th time.</li>
</ul>
<p>For any <span class="math inline">\(n = 1, 2, ...\)</span>, as <span class="math inline">\(\theta\)</span> moves from <span class="math inline">\(\theta = 0\)</span> to <span class="math inline">\(\theta = \pi\)</span>, the line <span class="math inline">\(l(\theta, n)\)</span> smoothly varies from the diameter in one direction to the diameter in the opposite direction. Now, if you take a diameter in the circle, and smoothly turn it around by <span class="math inline">\(180^\circ\)</span>, then no matter how much you shift the line around in the mean time, you are forced to sweep it over every point at least once.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Consequently, every point can be reached after <span class="math inline">\(n\)</span> reflections, for any positive integer <span class="math inline">\(n\)</span></p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;If you want a hands-on approach, imagine hammering in a nail at some point <span class="math inline">\(q\)</span> in the circle, and putting a long stick on the diameter. Now grab the stick and start turning it around. There is no way for you to turn it by <span class="math inline">\(180^\circ\)</span> without hitting the nail at some time.</p></div></div><p>For the wave way, imagine simultaneously shooting out a billiard in every direction with constant speed, and watch the "wavefront" of billiards evolve. The wavefront is reflected by the table edges and assumes increasingly complicated shapes, but it remains a closed curve (with possible self-intersections). As the closed curve reverberates across the table again and again, it sweeps across every point in the table again and again at discrete intervals.</p>
<p>However, there is no way to smoothly reach one trajectory from any other – you either have to make a very discrete jump in how hard you strike the billiard ball, or in which direction you strike. This contrasts with the case with both <span class="math inline">\(q, q_0\)</span> at the center, where you can smoothly vary your striking angle while keeping the same striking force.</p>
<p>Similarly, for a table with smooth boundary, for almost all point-pairs in the table, there are also a countable infinity of trajectories between them. We must say "almost all" to exclude singular cases such as the two focal points of an ellipse, where there is a whole continuum of trajectories between them.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Exactly counting the singular cases, and studying polygonal, or even non-convex tables, is an ongoing research program, with the name of "dynamical billiard flow".</p></div></div><p>What is the general lesson for defining <span class="math inline">\(S\)</span>? In general, we also need to fix a particular optimal path <span class="math inline">\(\tilde\gamma\)</span>, and only consider optimal paths that are in a small neighborhood of <span class="math inline">\(\tilde \gamma\)</span>. This is the same idea as selecting a branch cut when dealing with multi-valued functions like the complex logarithm.</p>
<p>Why are we so concerned with reflections? Read on!</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/waves_rays_circle_table.jpg" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">The two ways to find trajectories from <span class="math inline">\(q_0\)</span> to <span class="math inline">\(q\)</span>. The particle way involves sending out rays from <span class="math inline">\(q_0\)</span>, reflecting off the walls of the table, until a ray hits <span class="math inline">\(q\)</span>. The wave way involves sending out an expanding wavefront from <span class="math inline">\(q_0\)</span>, rippling through the table, passing over <span class="math inline">\(q\)</span> again and again. The rays are perpendicular to the wavefront in this case.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/square_billard.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Similarly, in a rectangular billiard table, there are infinitly many possible ways to go from one point to another, but one cannot go from one way to another continuously.</figcaption>
</figure>
</div>
</section>
<section id="hamiltons-principal-function" class="level3">
<h3 class="anchored" data-anchor-id="hamiltons-principal-function">Hamilton’s principal function</h3>
<p>Consider a problem in traveling: Given a starting spacetime <span class="math inline">\((t_0, q_0)\)</span> and an ending spacetime <span class="math inline">\((t, q)\)</span>, what is the lowest cost of traveling between them? We want to define it as:</p>
<p><span class="math display">\[
S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau
\]</span></p>
<p>where <span class="math inline">\(\gamma(\tau)\)</span> is the <em>unique</em> path from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>. However, as we saw in the case of circular billiards, we don’t have a unique path in general. Therefore, we should be a bit more careful.</p>
<p>First, we select a prototypical path <span class="math inline">\(\gamma_{prototype}\)</span>. Next, we smoothly vary <span class="math inline">\(\gamma_{prototype}\)</span> until it becomes some path <span class="math inline">\(\gamma\)</span> that goes from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>. Finally, define the Hamilton’s principal function using this particular <span class="math inline">\(\gamma\)</span>. The construction is a bit awkward, but it would allow us to avoid the non-uniqueness problem.</p>
<p>Thus, we define the <strong>Hamilton’s principal function</strong>:</p>
<p><span id="eq-hpf"><span class="math display">\[
S(t, q; t_0, q_0) = \int_{t_0}^t L(\tau, \gamma(\tau), \dot\gamma(\tau))d\tau
\tag{1}\]</span></span></p>
</section>
<section id="hamiltonjacobi-equation-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="hamiltonjacobi-equation-1">Hamilton–Jacobi equation</h3>
<p>For all nice enough Lagrangian <span class="math inline">\(L\)</span>, Hamilton’s principal function <span class="math inline">\(S\)</span> is differentiable with respect to <span class="math inline">\((t, q)\)</span>, so we will study its differential equation.</p>
<p>Let’s first consider the easy case: we simply let the trajectory "run a little longer". That is, we let the trajectory run from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, then let it keep running for <span class="math inline">\(\delta t\)</span>, reaching <span class="math inline">\((t+\delta t, q + \delta q)\)</span>. It’s clear that we have <span class="math inline">\(\delta q = \dot q(t) \delta t\)</span>, and</p>
<p><span class="math display">\[
S(t+\delta t, q + \delta q; t_0, q_0) - S(t, q; t_0, q_0) = \left(\sum_i p_i \dot q_i - H\right)\delta t
\]</span></p>
<p>so we have:</p>
<p><span id="eq-HJ0"><span class="math display">\[
\partial_t S + \sum_i \partial_{q_i}S \dot q_i = - H + \sum_i p_i \dot q_i
\tag{2}\]</span></span></p>
<p>which strongly suggests</p>
<div id="thm-hj" class="theorem">
<p><span class="theorem-title"><strong>Theorem 6</strong></span> <span id="eq-HJ"><span class="math display">\[
(-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p), \quad (-\partial_{t_0}, \nabla_{q_0})S(t, q; t_0, q_0) = (H_0, p_0)
\tag{3}\]</span></span></p>
</div>
<p>If <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a> is indeed true, then we have</p>
<div id="thm-hje" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7 (Hamilton–Jacobi equation)</strong></span> <span class="math display">\[\partial_t S + H(t, q, \nabla_q S) = 0\]</span></p>
</div>
<p>It suffices to prove <span class="math inline">\(\nabla_q S = p\)</span>, since then <span class="math inline">\(\partial_t S = -H\)</span> follows from <a href="#eq-HJ0" class="quarto-xref">Equation&nbsp;2</a>.</p>
<p>It suffices to prove <span class="math inline">\((-\partial_t, \nabla_q)S(t, q; t_0, q_0) = (H, p)\)</span>, since the other one is proved by the same argument, time-reversed.</p>
<p>Recall the economic construction of <span class="math inline">\(p\)</span>. It is a price vector designed specifically to destroy all arbitrage opportunities. Consequently, we can consider an entire family of paths shown in Figure (a, b).</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/HJ0-derivation.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Derivation of the Hamilton–Jacobi equation.</figcaption>
</figure>
</div>
<p>Here, <span class="math inline">\(\gamma\)</span> is the path from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, and <span class="math inline">\(\gamma + \delta \gamma\)</span> is the path to <span class="math inline">\((t, q+\delta q)\)</span>. We interpolate between them by a family of paths <span class="math inline">\(\{\gamma_\tau\}_{\tau}\)</span>, where <span class="math inline">\(\gamma_\tau\)</span> is the path obtained by first moving on <span class="math inline">\(\gamma\)</span> for time <span class="math inline">\(t\in [t_0, \tau]\)</span>, then making a "jump" by "purchasing from the market"<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> an infinitesimal bundle of commodities so that we fall onto the <span class="math inline">\(\gamma + \delta \gamma\)</span> path, then continue along that path.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;We are using the market <em>for real</em> now, so the marketeer had better had stocked up on those commodities!</p></div><div id="fn8"><p><sup>8</sup>&nbsp;More precisely, a higher-order infinitesimal than the area of the parallelogram. See <a href="#tip-higher-order-infinitesimal" class="quarto-xref">Tip&nbsp;1</a>.</p></div></div><p>Now consider two such jumped-paths, <span class="math inline">\(\gamma_{\tau}\)</span> and <span class="math inline">\(\gamma_{\tau + \delta \tau}\)</span>, where <span class="math inline">\(\delta \tau\)</span> is an infinitesimal, shown in Figure (c). The cost difference between them is that between two sides of the parallelogram. By the no-arbitrage construction, the difference is zero.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<p>Thus, we can smoothly "glide"<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> the path <span class="math inline">\(\gamma\)</span> to <span class="math inline">\(\gamma + \delta\gamma\)</span> by the family of jumped-paths <span class="math inline">\(\gamma_\tau\)</span>, with <span class="math inline">\(\tau\)</span> going from <span class="math inline">\(t\)</span> to <span class="math inline">\(t_0\)</span>, with no change in cost.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a> Thus, the only cost difference between <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\gamma + \delta\)</span> is the cost it takes to buy the bundle of commodities <span class="math inline">\(\delta q\)</span> at the very last instance:</p>
<div class="no-row-height column-margin column-container"><div id="fn9"><p><sup>9</sup>&nbsp;In the jargon of topology, this is a homotopy of paths.</p></div><div id="fn10"><p><sup>10</sup>&nbsp;More precisely, their difference in cost is a higher-order infinitesimal than the area of the curvy triangle between them. Since the curvy triangle is an infinitesimal of order <span class="math inline">\(\delta q\)</span>, the difference in cost is a higher-order infinitesimal than <span class="math inline">\(\delta q\)</span>.</p></div></div><p><span class="math display">\[S(t, q+\delta q; t_0, q_0) - S(t, q; t_0, q_0) = \sum_i p_i \delta q_i\]</span></p>
<p>finishing the proof.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="the usual proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
the usual proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The HJE has a standard proof, such as the one appearing in <span class="citation" data-cites="goldsteinClassicalMechanics2008">(<a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008, chap. 8</a>)</span>. It does not require reasoning with different orders of infinitesimals, but it is less geometrical.</p>
<p>Sketch of the proof:</p>
<ul>
<li>Start with the original system with configuration space <span class="math inline">\((t, q_{1:N}, \dot q_{1:N})\)</span>.</li>
<li>Move to the Hamiltonian equations on phase space <span class="math inline">\((t, q_{1:N}, p_{1:N})\)</span>.</li>
<li>Regard <em>that</em> as part of a larger system with configuration space <span class="math inline">\((t, q_{1:N}, p_{1:N}, \dot q_{1:N}, \dot q_{1:N}))\)</span></li>
<li>Write down the Euler–Lagrange equations for that larger system.</li>
</ul>
</div>
</div>
</div>
<div id="thm-poincare-cartan" class="theorem">
<p><span class="theorem-title"><strong>Theorem 8 (Poincaré–Cartan integral invariant <span class="citation" data-cites="arnoldMathematicalMethodsClassical2001">(<a href="#ref-arnoldMathematicalMethodsClassical2001" role="doc-biblioref">Arnol’d 2001, 237–38</a>)</span>)</strong></span> Draw an arbitrary closed cycle <span class="math inline">\(\alpha\)</span> in phase space-time. Let every point <span class="math inline">\(A \in \alpha\)</span> evolve for some time (not necessarily the same amount of time) to reach some other point <span class="math inline">\(A'\)</span>. Let <span class="math inline">\(\alpha'\)</span> be the cycle consisting of those points <span class="math inline">\(A'\)</span>. Then we have the <strong>Poincaré–Cartan integral invariant</strong></p>
<p><span class="math display">\[
\oint_\alpha \left\langle p, dq\right\rangle - Hdt = \oint_{\alpha'} \left\langle p, dq\right\rangle - Hdt
\]</span></p>
<p>As a special case, if both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\alpha'\)</span> consists of simultaneous points, then it reduces to the <strong>Poincaré relative integral invariant</strong></p>
<p><span class="math display">\[
\oint_\alpha \left\langle p, dq\right\rangle = \oint_{\alpha'} \left\langle p, dq\right\rangle
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Divide the tube into ribbons, like a barrel, then note that the integral around each barrel-plank is zero, as argued before. This is a case of the Stokes’ theorem.</p>
<p><img src="figure/poincare_cartan_invariant_proof_cropped.png" class="img-fluid"></p>
<p>In more detail, we can consider the four ends of a barrel-plank parallelogram. Label those points as <span class="math inline">\(A, B, A', B'\)</span> as shown. Though the points <span class="math inline">\(A, B, A', B'\)</span> exist in phase space-point, we can forget their momenta, thus projecting them to configuration space-time. Each phase space-time trajectory projects to a trajectory in configuration space-time, and we obtain <span class="math inline">\(S_{A \to B} = S(t_A, q_A; t_B, q_B)\)</span>, etc.</p>
<p>Now, by <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, we can shift <span class="math inline">\(S_{A \to B}\)</span> to <span class="math inline">\(S_{A \to B'}\)</span>, then to <span class="math inline">\(S_{A' \to B'}\)</span>:</p>
<p><span class="math display">\[
S_{A \to B} = S_{A \to B'}  -H_B \delta t_B + \left\langle p_B , \delta q_B\right\rangle = S_{A' \to B'} + H_A \delta t_A - \left\langle p_A , \delta q_A\right\rangle -H_B \delta t_B + \left\langle p_B , \delta q_B\right\rangle
\]</span></p>
<p>Now, if we shift around one entire cycle, we would get back the same <span class="math inline">\(S_{A \to B}\)</span>. Thus the two integrals are equal.</p>
<p>We will prove <a href="#thm-noether">Noether’s theorem</a> similarly.</p>
</div>
</div>
</div>
<div id="exr-zero-poincare-cartan" class="theorem exercise page-columns page-full">
<p><span class="theorem-title"><strong>Exercise 2</strong></span> A one-dimensional family of trajectories in phase space sweep out a curved surface. Prove that for any cycle <span class="math inline">\(\gamma\)</span> on the curved surface, <span class="math inline">\(\oint_\gamma \left\langle p, dq\right\rangle = 0\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/zero_poincare_cartan.jpg" class="img-fluid figure-img" style="width:40.0%"></p>
<figcaption class="margin-caption">Illustration for <span class="math inline">\(\oint_\gamma \left\langle p, dq\right\rangle = 0\)</span>.</figcaption>
</figure>
</div>
</div>
</section>
<section id="hamilton-characteristic-function" class="level3">
<h3 class="anchored" data-anchor-id="hamilton-characteristic-function">Hamilton characteristic function</h3>
<p>In most situations, the system is time-independent. In this case we can simplify the HJE to</p>
<p><span class="math display">\[\partial_t S = -H(q, \nabla_q S)\]</span></p>
<p>Since the left side depends on <span class="math inline">\(t\)</span>, but the right side does not explicitly, we can solve this by separation of variables.</p>
<p>Suppose there exists some function <span class="math inline">\(W\)</span>, called the <strong>Hamilton characteristic function</strong>, that satisfies</p>
<p><span id="eq-THJE"><span class="math display">\[
H(q, \nabla_q W(q)) = E
\tag{4}\]</span></span></p>
<p>for some <span class="math inline">\(E\in \mathbb{R}\)</span>, then <span class="math inline">\(S(t, q) = W(q) - Et\)</span> is a solution to the HJE.</p>
<p>We might naively think, by analogy with Fourier transform, that any solution to the HJE is a linear combination, of the form <span class="math inline">\(S(t, q) = \int (W_E(q) - Et)dE\)</span>, but this is not true, since the HJE is nonlinear. Nevertheless, solutions of the form <span class="math inline">\(S(t, q) = W(q) - Et\)</span> are often sufficient for applications.</p>
</section>
<section id="more-proofs-of-hje" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="more-proofs-of-hje">More proofs of HJE</h3>
<div class="callout callout-style-default callout-note callout-titled" title="proof by positional arbitrage">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
proof by positional arbitrage
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>We only need to prove <span class="math inline">\(p = \nabla S\)</span>, which is sufficient to prove <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, and thus the HJE.</p>
<p>Given a starting position <span class="math inline">\((t_0, q_0)\)</span> and a reference trajectory, there exists some <span class="math inline">\(S(t, q; t_0, q_0)\)</span>, the cost function of arriving at any point in configuration space-time in a neighborhood of the reference trajectory. For each trajectory <span class="math inline">\(\gamma\)</span> in the neighborhood that arrives at <span class="math inline">\((t, q)\)</span>, there exists a final market price <span class="math inline">\(q(t)\)</span>. We need to show that <span class="math inline">\(q = \nabla S\)</span>.</p>
<p>Suppose not, then we can perform positional arbitrage. First, we arrive at <span class="math inline">\(q + \delta q\)</span> by the efficient route, then sell off some <span class="math inline">\(\delta q\)</span>. This would cost us</p>
<p><span class="math display">\[S(t, q+\delta q; t_0, q_0) - \left\langle p, \delta q\right\rangle = S(t, q; t_0, q_0) + \left\langle\nabla S - p, \delta q\right\rangle\]</span></p>
<p>If <span class="math inline">\(\nabla S \neq p\)</span>, then we can take <span class="math inline">\(\delta q = -(\nabla S - p)\epsilon\)</span>, and thus magically make the journey cost less by a first-order infinitesimal. This means the market is inefficient, a contradiction.</p>
</div>
</div>
</div>
<p>Here is a proof in the spirit of wave mechanics and dynamical programming. Though I did not study his proof,<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> I believe this is how the inventor of dynamical programming, <a href="https://en.wikipedia.org/wiki/Richard_E._Bellman">Richard Bellman</a>, proved his extension, the <a href="https://en.wikipedia.org/wiki/Hamilton%E2%80%93Jacobi%E2%80%93Bellman_equation">Hamilton–Jacobi–Bellman equation</a>. The HJBE reduces to the HJE under certain conditions – they do not talk about the same thing, because while HJ is about stationary action, HJB is about maximal action.</p>
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;In his autobiography, he said,</p>
<blockquote class="blockquote">
<p>Problems of this type had been worked on before by many mathematicians, Euler, Hamilton, and Steiner, but the systematic study of problems of this type was done at RAND starting in 1948 under the inspiration of von Neumann. <span class="citation" data-cites="bellmanEyeHurricaneRichard1984">(<a href="#ref-bellmanEyeHurricaneRichard1984" role="doc-biblioref">Bellman 1984, 208</a>)</span></p>
<p>… one can use dynamic programming for the minimum principles of mathematical physics. For example, with dynamic programming one has a very simple derivation of the eikonal equation. In addition, the Hamilton-Jacobi equation of mechanics can easily be derived. <span class="citation" data-cites="bellmanEyeHurricaneRichard1984">(<a href="#ref-bellmanEyeHurricaneRichard1984" role="doc-biblioref">Bellman 1984, 289</a>)</span></p>
</blockquote>
</div></div><p>Suppose that we have found all points at which the action is equal to <span class="math inline">\(S\)</span>. Now we would like to expand that surface a little further, to the surface of action <span class="math inline">\(S + \delta S\)</span>. We do that in the spirit of economics (of course!) and traveling.</p>
<p>Interpret the action of a path as the cost of traveling along that path. The surfaces of constant action, then, become the <a href="https://en.wikipedia.org/wiki/Isochrone_map">isochrone maps</a>. The problem we face is then a matter of travel planning: Given that we can reach up to surface <span class="math inline">\(X_S\)</span> if we are willing to pay cost <span class="math inline">\(S\)</span>, how much further can we travel if we are willing to pay an additional <span class="math inline">\(\delta S\)</span>?</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/isochrone_map_america.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Isochrone maps of travel time in America, 1800 – 1930. <span class="citation" data-cites="paullinAtlasHistoricalGeography1932">(<a href="#ref-paullinAtlasHistoricalGeography1932" role="doc-biblioref">Paullin 1932</a>, plate 138, page 366)</span></figcaption>
</figure>
</div>
<p>Let us stand at a point <span class="math inline">\((t, q)\)</span> on the surface of action <span class="math inline">\(S\)</span>, and consider all the points we can reach by an additional action <span class="math inline">\(\delta S\)</span>. Suppose we go from <span class="math inline">\((t, q)\)</span> to <span class="math inline">\((t + \epsilon t, q + \epsilon q)\)</span>, then the cost of that is <span class="math inline">\(L\left(t, q, \frac{\epsilon q}{\epsilon q}\right)\epsilon t\)</span>. (We write <span class="math inline">\(\epsilon t\)</span> instead of <span class="math inline">\(\delta t\)</span>, because we have to use that symbol later.)</p>
<p>Therefore, the “wave” of action <span class="math inline">\(\delta S\)</span> coming out of the point <span class="math inline">\((t, q)\)</span> are those points <span class="math inline">\((t + \epsilon t, q + \epsilon q)\)</span> satisfying the equation</p>
<p><span class="math display">\[
L\left(t, q, \frac{\epsilon q}{\epsilon q}\right)\epsilon t = \delta S
\]</span></p>
<p>And the surface of action <span class="math inline">\(S + \delta S\)</span> is the envelope of all those little waves (“wavelets”). This is the wave perspective, but we still need to return to the particle perspective.</p>
<p>Suppose you are already at <span class="math inline">\((t, q)\)</span>, and you just want to reach the surface of <span class="math inline">\(S + \delta S\)</span>. It doesn’t matter where you end up on that surface – you just have to get to that surface <em>somewhere</em>. You also have exactly <span class="math inline">\(\delta S\)</span> to spend, so you have to plan optimally. Now, looking at that picture, you see that the only place you can possibly reach is a certain point <span class="math inline">\((t + \delta t, q + \delta q)\)</span> where the wavelet is tangent to the surface of <span class="math inline">\(S + \delta S\)</span>. At that point, the tangent surfaces of <span class="math inline">\(S\)</span> at <span class="math inline">\((t, q)\)</span> is parallel to the tangent surface of wavelet. That is,</p>
<p><span class="math display">\[
\begin{aligned}
d\left(L\left(t, q,-\frac{\epsilon q}{\epsilon t}\right) \epsilon t\right) |_{\epsilon t = \delta t, \epsilon q = \delta q} &amp;= \left\langle(\left(\nabla_q L\right) \underbrace{\delta t}_{\rightarrow 0}+\nabla_v L), d q\right\rangle +\left(L-\frac{\delta q}{\delta t} \nabla_v L\right) d t \\
&amp;\propto dS
\end{aligned}
\]</span></p>
<p>Thus, there exists some constant <span class="math inline">\(c &gt; 0\)</span> such that</p>
<p><span class="math display">\[
(\partial_t S, \nabla_q S) = c \left(\left\langle\nabla_v L, \frac{\delta q}{\delta t}\right\rangle - L , \nabla_v L\right) = (-cH, cp)
\]</span></p>
<p>Since we also have</p>
<p><span class="math display">\[
\partial_t S \delta t + \left\langle\nabla_q S, \delta q\right\rangle = \delta S = L \delta t
\]</span></p>
<p>we see <span class="math inline">\(c=1\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figure/hje_proof.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="convexity of the wavelet">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
convexity of the wavelet
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If the wavelet is convex, then the tangent point is unique, and there is only one way to proceed from <span class="math inline">\((t, q)\)</span>. However, if the wavelet is not, then there could exist <em>two</em> or more particle paths shooting out from <span class="math inline">\((t, q)\)</span>. It is similar to <a href="https://en.wikipedia.org/wiki/Birefringence">birefringence</a> and conical refraction <span class="citation" data-cites="lunneyInsOutsConical2006">(<a href="#ref-lunneyInsOutsConical2006" role="doc-biblioref">Lunney and Weaire 2006</a>)</span>.</p>
</div>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 3</strong></span> If you have studied, or intend to study, control theory, then prove the Hamilton–Jacobi–Bellman equation using the exact same picture. You can also prove the stochastic HJB equation in the same way, though you would need to insert the expectation <span class="math inline">\(\mathbb{E}\)</span> somewhere.</p>
</div>
</section>
<section id="bonus-noethers-theorem" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="bonus-noethers-theorem">Bonus: Noether’s theorem</h3>
<p>In Noether’s theorem, symmetries of the Lagrangian give us conserved quantities of motion.</p>
<ul>
<li><span class="math inline">\(\epsilon\)</span> is an infinitesimal number.</li>
<li>An <strong>infinitesimal transform</strong> is an infinitesimal deformation <span class="math inline">\((\delta t, \delta q)\)</span> of configuration space-time.
<ul>
<li><span class="math inline">\(\delta t = \epsilon T\)</span>, where <span class="math inline">\(T\)</span> a function of type <span class="math inline">\(\underbrace{\mathbb{R}}_{\text{time}} \times \underbrace{\mathcal C}_{\text{configuration space}} \to \mathbb{R}\)</span></li>
<li><span class="math inline">\(\delta q = \epsilon Q\)</span>, where <span class="math inline">\(Q\)</span> is a function of type <span class="math inline">\(\mathbb{R}\times \mathcal C \to \mathbb{R}^d\)</span>, where <span class="math inline">\(d\)</span> is the dimension of configuration space <span class="math inline">\(\mathcal C\)</span>.</li>
</ul></li>
<li>An infinitesimal transform is a <strong>symmetry of the Lagrangian</strong>, iff taking any path <span class="math inline">\(\gamma\)</span> (not necessarily physically real), and deforming it to <span class="math inline">\(\gamma'\)</span>, the action is conserved: <span class="math inline">\(\int_\gamma L dt = \int_{\gamma'} L dt\)</span>.</li>
<li>A <strong>conserved quantity of motion</strong> is a number depending on <span class="math inline">\(t, q, \dot q\)</span>, such that it is constant along any physically real path <span class="math inline">\(\gamma\)</span>.</li>
</ul>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4</strong></span> We defined “symmetry of the Lagrangian” by a condition on an integral: <span class="math inline">\(\int_\gamma L dt = \int_{\gamma'} L dt\)</span>. Reformulate this to a condition at a point, involving <span class="math inline">\(L, Q, T\)</span> and their derivatives.</p>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>A symmetry of the Lagrangian conserves <em>all</em> actions, even those of unphysical paths, but a conserved quantity of motion is only conserved along physical paths. We may call them “conserved quantity of <em>physical</em> motion” to emphasize the distinction.</p>
</div>
</div>
</div>
<p>Take a trajectory <span class="math inline">\(\gamma_{AA'}\)</span> from point <span class="math inline">\(A\)</span> to <span class="math inline">\(A'\)</span>. Now, shift it by <span class="math inline">\(\delta t, \delta q\)</span>, resulting in a trajectory <span class="math inline">\(\gamma_{BB'}\)</span> from point <span class="math inline">\(B\)</span> to <span class="math inline">\(B'\)</span>. Since <span class="math inline">\(L\)</span> is invariant under symmetry, any such shifting gives us <span class="math inline">\(S_{AA'} = S_{BB'}\)</span>. Now, suppose that <span class="math inline">\(\delta S \neq 0\)</span> in a neighborhood of the given trajectory <span class="math inline">\(\gamma_{AA'}\)</span>, then we can take this variation <span class="math inline">\(\delta \gamma\)</span>, and shift it by the symmetry, showing that <span class="math inline">\(\delta S \neq 0\)</span> in a neighborhood of <span class="math inline">\(\gamma_{BB'}\)</span> too.</p>
<p>Therefore, by Hamilton’s principle, the infinitesimal transform sends any physically real trajectory into another physically real trajectory.</p>
<div id="thm-noether" class="theorem">
<p><span class="theorem-title"><strong>Theorem 9 (Noether’s theorem)</strong></span> If <span class="math inline">\((t, q) \mapsto (t + \epsilon T, q + \epsilon Q)\)</span> is an infinitesimal symmetry of the Lagrangian, then</p>
<p><span class="math display">\[
H T - \left\langle p, \delta Q\right\rangle = (\left\langle\nabla_v L, \dot q\right\rangle - L)T - \left\langle\nabla_v L, Q\right\rangle
\]</span></p>
<p>is a conserved quantity of motion.</p>
</div>
<p>Technically speaking, we should not confuse the left side and the right side of</p>
<p><span class="math display">\[
H T - \left\langle p, \delta Q\right\rangle = (\left\langle\nabla_v L, \dot q\right\rangle - L)T - \left\langle\nabla_v L, Q\right\rangle
\]</span></p>
<p>The left side is defined on the phase space-time, while the right side is defined on the configuration space-time. They are equal only because we have soldered together the phase space and the configuration space.</p>
<p>Indeed, again and again we see that Lagrangian and Hamiltonian mechanics are different worlds, with their own dreams and phantasies, but always agreeing on the same reality.</p>
<p>If this were the case, then why do we bother creating two mechanics, since there are no physical experiment to distinguish them? It is because in quantum mechanics, virtual trajectories are just as real as the “real” trajectories. A particle can very well go around the earth once before it arrives at its destination, taking the long way around. In this case, what is virtually possible matters just as much as what is classically real, and if Lagrangian mechanics and Hamiltonian mechanics can entertain different kinds of dreams, we might be able to tell them apart.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/qed_2006_fig_24.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption"><span class="math inline">\(S\)</span> is a source of photons, and <span class="math inline">\(P\)</span> is a receiver. A photon can go from <span class="math inline">\(S\)</span> to <span class="math inline">\(P\)</span> by bouncing off the mirror below, along many paths. Each path has a certain amplitude, and the sum of all their amplitudes is the total amplitude. While the amplitude is dominated by the amplitudes near the classical path <span class="math inline">\(SGP\)</span>, it is not the only path, and all paths, even the “virtual” paths like <span class="math inline">\(SAP\)</span>, contributes to what we observe. <span class="citation" data-cites="feynmanQEDStrangeTheory2006">(<a href="#ref-feynmanQEDStrangeTheory2006" role="doc-biblioref">Feynman 2006, fig. 24</a>)</span></figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Given any physically real trajectory <span class="math inline">\(\gamma_{AA'}\)</span> from point <span class="math inline">\(A\)</span> to <span class="math inline">\(A'\)</span>, the infinitesimal transform sends it to another physically real <span class="math inline">\(\gamma_{BB'}\)</span>. By symmetry, both paths have the same action. Thus, we have</p>
<p><span class="math display">\[
S(A, A') = S(B, B')
\]</span></p>
<p>Now, consider an intermediate path <span class="math inline">\(\gamma_{A, B'}\)</span>. By <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>,</p>
<p><span class="math display">\[
S(A, B') = S(A, A') - H \delta t + \left\langle p, \delta q\right\rangle, \quad S(B, B') = S(A, B') + H_0 \delta t_0 - \left\langle p_0, \delta q_0\right\rangle
\]</span></p>
<p>Therefore, <span class="math inline">\(H T - \left\langle p, \delta Q\right\rangle\)</span> is a conserved quantity of motion.</p>
</div>
</div>
</div>
<p>The proof is similar to the proof of <a href="#thm-poincare-cartan" class="quarto-xref">Theorem&nbsp;8</a>, though they differ in that Noether’s theorem shows a quantity, defined at a single point, is conserved over a trajectory, while the Poincaré–Cartan invariant is not defined at a single point, but as an integral over an entire cycle.</p>
</section>
</section>
<section id="the-particle-wave-duality" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="the-particle-wave-duality">The particle-wave duality</h2>
<section id="particle-in-free-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="particle-in-free-space">Particle in free space</h3>
<p>Consider a particle of mass <span class="math inline">\(m\)</span> in free space <span class="math inline">\(\mathbb{R}^n\)</span>. Its Lagrangian is <span class="math inline">\(L(t, q, v) = \frac 12 m\|v\|^2\)</span>. By convex duality, we have</p>
<p><span class="math display">\[\begin{cases} L(t, q, v) = \frac 12 m\|v\|^2\\ H(t, q, p) = \frac{\|p\|^2}{2m} \end{cases}\quad  
\begin{cases} p^\ast(t, q, v) = mv\\ v^\ast(t, q, p) = \frac{p}{m} \end{cases}\]</span></p>
<p>For any <span class="math inline">\(t_0, q_0, t, q\)</span> with <span class="math inline">\(t_0\neq t\)</span>, we can directly solve for the trajectory from <span class="math inline">\((t_0, q_0)\)</span> to <span class="math inline">\((t, q)\)</span>, then find the action:</p>
<p><span class="math display">\[S_{t_0, q_0}(t, q) = \frac 12 m \frac{\|q-q_0\|^2}{t-t_0}\]</span></p>
<p>Each <span class="math inline">\(S\)</span> defines a paraboloid wavefront in spacetime, with apex <span class="math inline">\(t_0, q_0\)</span>. The wavefront is translation-symmetric, so we set both to zero, yielding the equation of the wavefront:</p>
<p><span class="math display">\[
t = \frac{\|q\|^2}{2S/m}
\]</span></p>
<p>The wavefront of <span class="math inline">\(S = 0\)</span> is just the positive <span class="math inline">\(t\)</span>-axis, and as <span class="math inline">\(S\)</span> increases, the wavefront widens out.</p>
<p>Now, we interpret this wave from the HJE point of view. Let’s say we have the wavefront at <span class="math inline">\(S=S_0\)</span>, and we want to construct the wavefront at <span class="math inline">\(S = S_0 + \delta S\)</span>. This we perform by rippling out a little wavelet at each point <span class="math inline">\((t', q')\)</span> on the wavefront. The little wavelet has shape <span class="math inline">\((t-t') = \frac{\|q - q'\|^2}{2\delta S/m}\)</span>, and as we move <span class="math inline">\(t', q'\)</span> around the parabola of wavefront <span class="math inline">\(S = S_0\)</span>, the envelope of these wavelets is the wavefront of <span class="math inline">\(S = S_0 + \delta S\)</span>.</p>
<p>This is the wave point of view. We can switch back to the particle point of view. What is the velocity of the particle passing the point <span class="math inline">\((t', q')\)</span>? We know that it must be traveling in the optimal direction, and the optimal direction allows it to go as far as possible. Therefore, we simply draw the wavelet of <span class="math inline">\(\delta S\)</span> at <span class="math inline">\((t', q')\)</span>, then find the intersection of the wavelet with the wavefront of <span class="math inline">\(S = S_0 + \delta S\)</span>.</p>
<p>The entire procedure is pictured below.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_point_source.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The two red curves are two wavefronts <span class="math inline">\(S = S_0\)</span> and <span class="math inline">\(S = S_0 + \delta S\)</span>. At select points on the first wavefront, we draw a wavelet of <span class="math inline">\(\delta S\)</span>, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.</figcaption>
</figure>
</div>
</section>
<section id="particle-wave-in-free-space" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="particle-wave-in-free-space">Particle-wave in free space</h3>
<p>The paraboloid-shaped solution for <span class="math inline">\(S\)</span> is interpretable in Newtonian mechanics, as the motion of a single particle moving from the origin. However, the HJE itself is merely a PDE with its own logic and meaning, and consequently, it may have different solutions that are hard to to interpret in Newtonian mechanics.</p>
<p>From our 21st-century perspective, we can say that the HJE is generally true, and Newtonian mechanics is only a special case. Some solutions to the HJE may not be interpretable in Newtonian mechanics, but they are nevertheless physically real, since Newtonian mechanics is incomplete. Given that, we simply try to solve HJE, then try to interpret it, even if not in Newtonian mechanics.</p>
<p>Because the Lagrangian is time-independent, so any <a href="#eq-THJE">time-independent solution</a>:</p>
<p><span class="math display">\[S(t, q) = W(q) - Et, \quad \| \nabla_q W \| = \sqrt{2mE}\]</span></p>
<p>for any constant <span class="math inline">\(E &gt; 0\)</span> also gives a solution to the HJE. This is just the <strong>eikonal equation</strong><a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> for a medium of constant wave speed! More on this in <a href="#sec-geometric-optics">the section on geometric optics</a>. One can of course solve the eikonal equation by putting it into a numerical package and let it grind out the solution. However, we can interpret it by the Huygens principle.</p>
<div class="no-row-height column-margin column-container"><div id="fn12"><p><sup>12</sup>&nbsp;From Greek εἰκών (<em>eikon</em>, "image"), from which the word “icon” derived.</p></div></div><p>Suppose you know a surface of constant <span class="math inline">\(W = W_0\)</span>, and you know that the arrows of <span class="math inline">\(\nabla_q W\)</span> point outwards, then since <span class="math inline">\(\nabla W\)</span> is perpendicular to the surface, and is of constant length <span class="math inline">\(\sqrt{2mE}\)</span>, you can step out a small distance <span class="math inline">\(ds\)</span> perpendicularly out of the whole surface <span class="math inline">\(W= W_0\)</span>, and arrive at the surface of <span class="math inline">\(W=W_0 + \sqrt{2mE} ds\)</span>. Alternatively, you can draw small spheres of radius <span class="math inline">\(ds\)</span>, and their outwards envelope is the <span class="math inline">\(W=W_0+ \sqrt{2mE} ds\)</span> surface. These procedures are equivalent, but in one, we constructed "rays" while the other we constructed "wave fronts".</p>
<p>For the free particle, the simplest solution is the plane wave:</p>
<p><span class="math display">\[W(q) = \sqrt{2mE} \langle \hat k, q \rangle\]</span></p>
<p>where <span class="math inline">\(\hat k\)</span> is any unit-vector, interpreted as the direction of wave propagation. Plugging it back to <a href="#eq-HJ" class="quarto-xref">Equation&nbsp;3</a>, we find that the "planar wave particle" has</p>
<p><span class="math display">\[(\partial_t S, \nabla S) = (-H, p) = (-E, \sqrt{2mE}\hat k)\]</span></p>
<p>where <span class="math inline">\(\hat k\)</span> is the direction of the group velocity of the wave. The group velocity of the wave is <span class="math inline">\(\frac{\partial_t S}{\nabla S} = \frac{E}{\sqrt{2mE}}\hat k\)</span>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_planar_wave.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The two red curves are two wavefronts <span class="math inline">\(S = S_0\)</span> and <span class="math inline">\(S = S_0 + \delta S\)</span>. At select points on the first wavefront, we draw a wavelet of <span class="math inline">\(\delta S\)</span>, which is tangent to the second wavefront. The particle trajectory connects the point and the tangent point of the wavelet with the second wavefront.</figcaption>
</figure>
</div>
<p>Taking the particle-wave analogy seriously, we say that:</p>
<ul>
<li>a planar wave is a particle with energy <span class="math inline">\(E\)</span> and momentum <span class="math inline">\(p \propto k \propto \sqrt{2mE} \hat k\)</span>.</li>
<li>a particle with energy <span class="math inline">\(E\)</span> and momentum <span class="math inline">\(p\)</span> is a planar wave traveling at group velocity <span class="math inline">\(E/p\)</span>.</li>
</ul>
<p>Typically, waves have a wavelength <span class="math inline">\(\lambda\)</span>, which is related to the wave vector <span class="math inline">\(k\)</span> by <span class="math inline">\(k \propto \lambda^{-1}\)</span>, we find that the particle has wavelength <span class="math inline">\(\lambda \propto \frac 1k \propto \frac 1p\)</span>. Thus, we arrived at de Broglie’s matter-wave hypothesis, which Schrödinger expanded into his equation. Both de Broglie and Schrödinger were inspired by Hamilton’s optics-mechanics analogy, so we are treading the same path as them a century ago.</p>
<p>In fact, we could start with an arbitrary wavefront in configuration-spacetime, and use Huygens’ principle to construct the wavefront in the next moment. In general, we can’t do Fourier analysis on such wavefronts – they are not decomposable into planar waves, because the HJE is a nonlinear equation. Fourier analysis only works on linear differential equations.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/free_particle_cubic_curve.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Given a wavefront in the shape of <span class="math inline">\(t = q^3\)</span>, we can construct the next wavefront as the envelope of the parabolic wavelets at every point on the wavefront.</figcaption>
</figure>
</div>
</section>
<section id="particle-in-a-potential-field" class="level3">
<h3 class="anchored" data-anchor-id="particle-in-a-potential-field">Particle in a potential field</h3>
<p>A particle in a time-dependent potential field <span class="math inline">\(V\)</span> has Lagrangian <span class="math inline">\(L(t, q, v) = \frac 12 m\|v\|^2 - V(t, q)\)</span>. By convex duality</p>
<p><span class="math display">\[\begin{cases}     
L(t, q, v) = \frac 12 m\|v\|^2 - V(t, q)\\     
H(t, q, p) = \frac{\|p\|^2}{2m} + V(t, q)
\end{cases} \quad
\begin{cases}     
p^\ast = mv \\     
v^\ast = \frac pm
\end{cases}\]</span></p>
<p>The HJE gives</p>
<p><span class="math display">\[\partial_t S + \frac 1{2m} \|\nabla_q S\|^2 = -V(t, q)\]</span></p>
<p>As before, if we interpret the equation as a wave equation, then the group velocity is <span class="math inline">\(\frac{\partial_t S}{\nabla S} = \frac{-E}{p} \hat k\)</span>, with magnitude <span class="math inline">\(v_g = \frac{E}{\sqrt{2m(E-V)}}\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="example: particle in free fall">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
example: particle in free fall
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We consider the classical problem of a body in free fall, thrown from the origin <span class="math inline">\((t, q) = (0, 0)\)</span>. Basic physics tells us that the position and velocity of the body are given by</p>
<p><span class="math display">\[q(t) = v_0 t - \frac{1}{2}gt^2, \quad v = v_0 - gt = \frac{q}{t} - \frac{1}{2}gt\]</span></p>
<p>Plugging these expressions into the Hamilton-Jacobi equation, we obtain a system of partial differential equations for the action function <span class="math inline">\(S\)</span>:</p>
<p><span class="math display">\[
\begin{cases}
\partial_t S &amp;= -H = -\frac{1}{2}m(\frac{q}{t} - \frac{gt}{2})^2 - mgq \\
\partial_q S &amp;= m(\frac{q}{t} - gt)
\end{cases}
\]</span></p>
<p>Solving this system, we find the unique solution for the action:</p>
<p><span class="math display">\[S = \frac{x^2}{y} - xy - \frac{y^3}{12}\]</span></p>
<p>where we have introduced convenience variables <span class="math inline">\(x = gq\)</span>, <span class="math inline">\(y = gt\)</span>, and <span class="math inline">\(s = \frac{2gS}{m}\)</span>.</p>
<p>The contour lines of the action function satisfy the equation:</p>
<p><span class="math display">\[
x = \frac{1}{2}y^2 \pm \sqrt{\frac{1}{3}y^4 + sy}
\]</span></p>
<p>To analyze the wavelet associated with this system, we start by writing down the Lagrangian:</p>
<p><span class="math display">\[L = T - V = \frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq\]</span></p>
<p>The wavelet equation is then given by:</p>
<p><span class="math display">\[\delta S = L \delta t = \left(\frac{1}{2}m(\frac{\delta q}{\delta t})^2 - mgq\right)\delta t\]</span></p>
<p>Simplifying this equation using our convenience variables, we get:</p>
<p><span class="math display">\[(\delta x)^2 = 2x(\delta y)^2 + \delta s \delta y\]</span></p>
<p>Solving for <span class="math inline">\(\delta y\)</span>, we obtain:</p>
<p><span class="math display">\[\delta y = \frac{-\delta s \pm \sqrt{(\delta s)^2 + 8x(\delta x)^2}}{4x}\]</span></p>
<p>This equation reveals the nature of the wavelet. When <span class="math inline">\(x &gt; 0\)</span>, the equation describes a hyperbola. For <span class="math inline">\(x &lt; 0\)</span>, it describes an ellipse. At the boundary <span class="math inline">\(x = 0\)</span>, the equation describes a parabola.</p>
<p><img src="figure/falling_particle_point_source.svg" class="img-fluid"></p>
<p>There is no planar wave solution, because a planar wave solution is both constant energy and unbounded, whereas if a particle can move infinitely far away, it must have infinite energy. If we attempt to force a planar wave solution, it would immediately break down:</p>
<p><img src="figure/falling_particle_planar_wave.svg" class="img-fluid"></p>
</div>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 5</strong></span> Solve the time-independent HJE for the particle in free fall. It should be <span class="math inline">\(S = W(q) - Et\)</span>, where <span class="math inline">\(E\)</span> is a constant, and <span class="math inline">\(W\)</span> is a <a href="https://en.wikipedia.org/wiki/Semicubical_parabola">semicubical parabola</a>.</p>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 6</strong></span> In the same way, analyze the simple harmonic oscillator – a particle in a potential well <span class="math inline">\(V = \frac 12 kq^2\)</span>. Similarly, it cannot have a planar wave solution. Plot the wavelets along each point on a planar wave, and see how it breaks down. Find two families of solutions: The case where we have a point source at <span class="math inline">\((0, 0)\)</span>, and the case of time-independent HJE.</p>
</div>
</section>
<section id="deriving-the-time-independent-schrödinger-equation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="deriving-the-time-independent-schrödinger-equation">Deriving the time-independent Schrödinger equation</h3>
<p>This section based on <span class="citation" data-cites="masoliverClassicalQuantumMechanics2009 derbesFeynmanDerivationSchrodinger1996 hamillStudentGuideLagrangians2013">(<a href="#ref-masoliverClassicalQuantumMechanics2009" role="doc-biblioref">Masoliver and Ros 2009</a>; <a href="#ref-derbesFeynmanDerivationSchrodinger1996" role="doc-biblioref">Derbes 1996</a>; <a href="#ref-hamillStudentGuideLagrangians2013" role="doc-biblioref">Hamill 2013, sec. 6.4</a>)</span>.</p>
<p>Assume that the potential is time-independent: <span class="math inline">\(V(t, q) = V(q)\)</span>. Assume that the physical system can be described by a function</p>
<p><span class="math display">\[
\Psi(t, q) = \Psi_0(r) e^{iS(t, q)/\hbar}
\]</span></p>
<p>where the function <span class="math inline">\(\Psi\)</span> is typically called the “wave function”.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a> We assume that the wave is a “standing wave”, so that all of space is oscillating in sync. Let <span class="math inline">\(S(t, q) = W(q) - Et\)</span>, so that the oscillation frequency is <span class="math inline">\(E/\hbar\)</span>.<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn13"><p><sup>13</sup>&nbsp;What is a wave function? It is just some abstract mathematical object, that somehow allows us to calculate everything we want to know about this system. We have no idea what it is, but it works. The same applies to the function <span class="math inline">\(S(t, q)\)</span>. We call it the “minimal cost” for arriving at <span class="math inline">\((t, q)\)</span>, but what really is a cost in physics? Particles do not really pay their paths with natural money. All this time, we have pretended that they pay some kind of cost and want to minimize the cost, but it is really just one big analogy. The same applies for the function <span class="math inline">\(\Psi\)</span>. We might call it a “wave function”, but it really is just one big analogy with the waves on an ocean. There is really no wave in quantum mechanics, only a function that we pretend is a wave, because it helps us calculate results that happen to be correct.</p></div><div id="fn14"><p><sup>14</sup>&nbsp;The most important experimental result from quantum mechanics is that energy levels are quantized. Now, a quantized energy level is something like <span class="math inline">\(E = h, 2h, 3h, \dots\)</span>. There is really just one kind of thing in classical mechanics that is quantized: standing waves! If you have a string, then its standing waves must have <span class="math inline">\(0, 1, 2, 3, \dots\)</span> nodes, i.e.&nbsp;quantized. Thus, it is natural to try out this “standing wave” assumption.</p></div></div><p>So, we can separate the variables to</p>
<p><span class="math display">\[
\Psi(t, q) = \underbrace{e^{-i\frac{E}{\hbar}t}}_{\text{oscillation in sync}} \underbrace{\psi(q)}_{\text{variation over space}}, \quad \psi(q) = \Psi_0(q) e^{i\frac{W(q)}{\hbar}t}
\]</span></p>
<p>Since <span class="math inline">\(\Psi\)</span> should be a wave, it has better follow the wave equations:</p>
<p><span class="math display">\[
(\partial_t^2 - v_g^2 \nabla^2)\Psi = 0
\]</span></p>
<p>where <span class="math inline">\(v_g\)</span> is the group velocity of the wave. As we saw previously, <span class="math inline">\(v_g = \frac{E}{\sqrt{2m(E-V)}}\)</span> for a particle in a potential. Then we have</p>
<p><span class="math display">\[
\begin{cases}
\Psi(t, q) &amp;= e^{-i\frac{E}{\hbar} t} \psi(q), \\
0 &amp;= (\partial_t^2 - v_g^2 \nabla^2)\Psi, \\
v_g &amp;= \frac{E}{\sqrt{2m(E-V)}},
\end{cases}\;\; \implies \frac{\hbar^2}{2 m} \nabla^2 \psi+(E-V) \psi = 0,
\]</span></p>
<p>which is the time-independent Schrödinger equation.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 7</strong></span> The time-dependent Schrödinger equation states that</p>
<p><span class="math display">\[
i\hbar\frac{\partial}{\partial t} \Psi(t, q) = \left [ - \frac{\hbar^2}{2m}\nabla^2 + V(t, q)\right ] \Psi(t, q).
\]</span></p>
<p>Plug <span class="math inline">\(\Psi(t, q) = \psi_0(t, q) e^{i S(t, q)/\hbar}\)</span> back to the time-dependent Schrödinger equation, and check that at the <span class="math inline">\(\hbar \to 0\)</span> limit, we recover the HJE for <span class="math inline">\(S(t, q)\)</span>. This is a simple example of the <a href="https://en.wikipedia.org/wiki/WKB_approximation">WKB approximation</a>.</p>
</div>
<p>If the above derivation looks mildly suspect, and leaves you with a feeling of seeing a magic trick, it is not an accident. The analogy between classical mechanics and quantum mechanics is not exact, so we cannot logically derive quantum mechanics from classical mechanics. The simple problem is that classical mechanics, even when formulated in the form of Hamilton–Jacobi wave equations, cannot reproduce interference or diffractions. Consider the simple case of a straight-edge diffraction. If you aim a light beam at a sharp edge, then on the other side, there would be alternating bright and dark bands fading into the shadow. However, if light is going by the shortest path, then there should be no such banding, and the brightness should just drop off to zero monotonically.</p>
<p>The solution is to admit that geometric optics is insufficient, that Huygens’ principle is insufficient, and we need a full theory of light wave in order to explain what happens on the very smallest scales – a diffraction theory. Similarly, classical mechanics is insufficient, and the HJE is insufficient, and we need a full theory of matter wave in order to explain what happens in the atomic world – quantum mechanics.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/no_classical_diffraction.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="margin-caption">In classical mechanics, the shadow of a hard edge has no diffractive stripes.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/optical-mechanical_analogy.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The optical-mechanical analogy at three levels. There is a question mark, because I’m not sure if that should be quantum field theory.</figcaption>
</figure>
</div>
<p>Deriving quantum mechanics from classical mechanics is necessarily fraught with danger and luck, because in going from quantum mechanics to classical mechanics, something is irrevocably lost (and other things are irrevocably earned). It is about as difficult as going from geometric optics to wave optics. Still, several people have tried and succeeded, especially Schrödinger.</p>
<blockquote class="blockquote">
<p>… the conception of rays is thoroughly well defined only in pure abstract geometrical optics. It is wholly incapable of being applied to the fine structure of real optical phenomena, i.e.&nbsp;to the phenomena of diffraction. Even in extending geometrical optics some what by adding the notion of Huygens’ principle one is not able to account for the most simple phenomena of diffraction without adding some further very strange rules concerning the circumstances under which Huygens’ envelope-surface is or is not physically significant. (I mean the construction of “Fresnel’s zones”.) These rules would be wholly incomprehensible to one versed in geometrical optics alone. Furthermore it may be observed that the notions which are fundamental to real physical optics, i.e.&nbsp;the wave-function itself (<span class="math inline">\(W\)</span> is merely the phase), the equation of wave-propagation, the wave length and frequency of the waves, do not enter at all into the above stated analogy.</p>
<p><span class="citation" data-cites="schrodingerUndulatoryTheoryMechanics1926">(<a href="#ref-schrodingerUndulatoryTheoryMechanics1926" role="doc-biblioref">Schrödinger 1926</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>… to establish a correspondence between waves and corpuscles such that the laws of mechanics correspond to the laws of geometrical optics. In the wave theory, however, as you will know, geometrical optics is only an approximation: this approximation has its limits of validity and particularly when interference and diffraction phenomena are involved, it is quite inadequate. This prompted the thought that classical mechanics is also only an approximation relative to a vaster wave mechanics. … A new mechanics must be developed which is to classical mechanics what wave optics is to geometrical optics. This new mechanics has since been developed, thanks mainly to the fine work done by Schrödinger.</p>
<p>Louis de Broglie’s Nobel Prize Lecture <span class="citation" data-cites="debroglieWaveNatureElectron1929">(<a href="#ref-debroglieWaveNatureElectron1929" role="doc-biblioref">De Broglie 1929</a>)</span></p>
</blockquote>
</section>
<section id="relativistic-particle-in-free-space" class="level3">
<h3 class="anchored" data-anchor-id="relativistic-particle-in-free-space">Relativistic particle in free space</h3>
<p>Since the HJE is fully general for any function <span class="math inline">\(L(t, q, v)\)</span> that is smooth and strictly convex in <span class="math inline">\(v\)</span>, we can simply write down the Lagrangian for relativistic particle in a field, and it would <em>just work</em>.</p>
<p>Let’s first consider particle in free space. In relativity, the one thing that is coordinate-independent is the proper time of a trajectory, so it is reasonable to <em>guess</em> that the action is the proper time, then deduce from it the Lagrangian. This is natural if we think of <span class="math inline">\(S\)</span> as the optimal cost of traveling.</p>
<p>Let <span class="math inline">\(t_0 = 0, q_0 = 0\)</span>, then by basic relativity, the proper time for the particle to arrive at <span class="math inline">\((t, q)\)</span> is</p>
<p><span class="math display">\[S(t, q) = \frac{\|q\|}{v\gamma} = \sqrt{t^2- \frac{\|q\|^2}{c^2}}\]</span></p>
<p>where <span class="math inline">\(\gamma = \frac{1}{\sqrt{1-v^2/c^2}}\)</span> is the well-known factor used everywhere in special relativity.</p>
<p>Taking <span class="math inline">\(\nabla_q\)</span>, and simplifying, we find the relativistic momentum to be...</p>
<p><span class="math display">\[p = \nabla_q S = -\frac{\gamma v}{c^2}\]</span></p>
<p>However, we were expecting <span class="math inline">\(p \to mv\)</span> when <span class="math inline">\(v \to 0\)</span>, so we fix this issue by multiplying the action with a constant factor <span class="math inline">\(-mc^2\)</span>. Multiplying a constant factor in action has no effect on the calculus of variations, so we are free to do this. Thus we find that the action of a path is the proper time of the path multiplied by <span class="math inline">\(-mc^2\)</span>:</p>
<p><span class="math display">\[S(\text{path}) = -mc^2 \int_{\text{path}}d\tau = -mc^2 \int_{\text{path}}\frac 1\gamma dt\]</span></p>
<p>With this, we can derive the familiar equations by the HJE and convex duality:</p>
<p><span class="math display">\[\begin{cases}
L(q, v) = -\frac{mc^2}{\gamma}\\     
H(q, p) = \sqrt{(\|p\|c)^2 + (mc^2)^2}
\end{cases} \quad
\begin{cases}     
p^\ast = \gamma mv \\     
v^\ast = \frac{pc}{\sqrt{\|p\|^2 + (mc)^2}}
\end{cases}\]</span></p>
<p>In particular, at low <span class="math inline">\(v\)</span>, we have <span class="math inline">\(L \approx -mc^2 + \frac 12 m\|v\|^2\)</span>. So somehow, by combining the <em>geometry</em> of spacetime with analytical mechanics, we have discovered the <span class="math inline">\(E = mc^2\)</span> formula, even though there seems like something we couldn’t have discovered from mere geometry.</p>
<p>The HJE then becomes</p>
<p><span class="math display">\[\frac 1{c^2} \left(\partial_t S \right)^2 - \|\nabla S \|^2 = m^2 c^2\]</span></p>
<p>In particular, the time-independent solutions are of the form</p>
<p><span class="math display">\[S = W(q)-Et, \quad \| \nabla W \| = \frac 1c \sqrt{E^2 - m^2 c^4 }\]</span></p>
<p>for any <span class="math inline">\(E &gt; mc^2\)</span>. In particular, if we plug in the usual relativistic energy <span class="math inline">\(E = \gamma mc^2\)</span>, we get</p>
<p><span class="math display">\[\| \nabla W \| = \gamma mv\]</span></p>
<p>which is similar to what we obtained for the free particle in classical mechanics, with <span class="math inline">\(\|\nabla W \| = \sqrt{2mE}\)</span>, just with classical momentum upgraded to relativistic momentum.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8</strong></span> Just as how the HJE of a classical particle can be derived as the <span class="math inline">\(\hbar \to 0\)</span> limit of the Schrödinger equation, one can derive the HJE of the non-quantum relativistic particle as the <span class="math inline">\(\hbar \to 0\)</span> limit limit of the Klein–Gordon equation. The Klein–Gordon equation is essentially the simplest possible way to combine special relativity with Schrödinger equation:</p>
<p><span class="math display">\[\left( \frac{1}{c^2} \frac{\partial^2}{\partial t^2} - \nabla^2 + \frac{m^2 c^2}{\hbar^2} \right) \psi(t, \mathbf{x}) = 0\]</span></p>
<p>Plug in <span class="math inline">\(\psi(t, q) = \psi_0(q, t) e^{i S(t, q) / \hbar}\)</span>, and check that at <span class="math inline">\(\hbar \to 0\)</span> limit, we recover the HJE.</p>
</div>
</section>
<section id="sec-geometric-optics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="sec-geometric-optics">Geometric optics</h3>
<p>We are going back to the roots, as geometric optics was what inspired Hamilton to develop his theory of Hamiltonian mechanics.</p>
<p>When Hamilton developed his Hamiltonian approach, it was to study geometric optics, which can be derived from Fermat’s principle: <em>light paths have stationary travel time</em>. In other words, the action of a path is</p>
<p><span class="math display">\[S(\text{path}) = \int_{\text{path}} dt\]</span></p>
<p>Thus, <span class="math inline">\(L = 1\)</span>...? Well, here we see the problem: in geometric optics, if you fix the starting and ending point as <span class="math inline">\((t_0, q_0), (t, q)\)</span>, then <em>any</em> path between them takes exactly <span class="math inline">\(t-t_0\)</span> time, and there is nothing to vary. Consequently, we need to remove time from consideration, so that there is something to vary.</p>
<p>Fermat’s principle, reformulated, states <em>light paths have stationary optical length</em>. Let the medium be isotropic (light speed does not depend on direction), then we have</p>
<p><span class="math display">\[S(\text{path}) = \int_{\text{path}} n(q) \|dq\|\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the refractive index. with <span class="math inline">\(L(q) = n(q)\)</span>. Here we encounter a brief difficulty: time flows in one direction only, but space flows in infinitely many possible directions!</p>
<p>The solution might seem like a joke, but it would work out well: select one direction<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>, say <span class="math inline">\(q_0\)</span>, and pretend that it is time. With this trick, all previous mathematical formalism immediately applies, and we have</p>
<div class="no-row-height column-margin column-container"><div id="fn15"><p><sup>15</sup>&nbsp;This direction is usually selected to be the direction of the <strong>principal optic axis</strong>. For example, the long-axis of a camera is a principal optic axis, and so is the barrel-axis of a telescope.</p></div></div><p><span class="math display">\[S(\text{path}) = \int_{\text{path}} n(q_0, q_1, q_2) \sqrt{1 + \left(\frac{dq_1}{dq_0}\right)^2 + \left(\frac{dq_2}{dq_0}\right)^2}dq_0\]</span></p>
<section id="derivation" class="level4">
<h4 class="anchored" data-anchor-id="derivation">Derivation</h4>
<p>Let’s make the notation cleaner, by rewriting <span class="math inline">\(q_0\)</span> as <span class="math inline">\(t\)</span>, <span class="math inline">\((q_1, q_2)\)</span> as <span class="math inline">\(q\)</span>, and using <span class="math inline">\(v\)</span> to mean <span class="math inline">\(\left(\frac{dq_1}{dq_0}, \frac{dq_2}{dq_0}\right)\)</span>. Then we have</p>
<p><span class="math display">\[L(t, q, v) = n(t, q) \sqrt{1 + \|v\|^2}\]</span></p>
<p>Routine calculation yields</p>
<p><span class="math display">\[\begin{cases}     
L(t, q, v) = n(t, q) \sqrt{1 + \|v\|^2}\\     
H(t, q, p) = -\sqrt{n^2 - \|p\|^2}
\end{cases} \quad
\begin{cases}     
p^\ast = \frac{nv}{\sqrt{1 + \|v\|^2}} \\     
v^\ast = \frac{p}{\sqrt{n^2 - \|p\|^2}}
\end{cases}\]</span></p>
<p>we continue with the HJE, which simplifies to:</p>
<p><span class="math display">\[(\partial_t S)^2 + \|\nabla_q S\|^2 = n^2\]</span></p>
<p>Reverting notation back to <span class="math inline">\((q_0, q_1, q_2)\)</span>, we find the eikonal equation:</p>
<p><span class="math display">\[\|\nabla_q S\| = n(q)\]</span></p>
<p>Why did the trick work? Well, if we look back to how we derived the Hamiltonian, we could see that what we called "time" is really just a special copy of <span class="math inline">\(\mathbb{R}\)</span>, along which we organized all other state and control variables. We don’t really need time to be anything more than the domain of functions, as in <span class="math inline">\(q_i: \mathbb{R}\to \mathbb{R}\)</span> and <span class="math inline">\(v_i : \mathbb{R}\to \mathbb{R}\)</span>. It most definitely does not need to "flow", or flow only from the past to the future, or have any psychological significance.</p>
</section>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<p>Starting with Fermat’s principle for light rays, we ended up with the eikonal equation for light waves. In general, we find the following duality between wave-field optics and particle-path optics.</p>
<table class="table">
<caption>The particle-wave duality.</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 36%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>perspective</th>
<th>particle-path</th>
<th>wave-field</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>action <span class="math inline">\(S\)</span></td>
<td>a function of particle path</td>
<td>a field on configuration-spacetime</td>
</tr>
<tr class="even">
<td>equation</td>
<td><span class="math inline">\(\|\nabla_q S\| = n(q)\)</span></td>
<td><span class="math inline">\(\partial_t S + H(t, q, \nabla_q S) = 0\)</span></td>
</tr>
<tr class="odd">
<td>in optics</td>
<td>light rays, Fermat’s principle</td>
<td>light waves, Huygens principle</td>
</tr>
<tr class="even">
<td>in mechanics</td>
<td>point particles</td>
<td>matter waves</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="anisotropic-optics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="anisotropic-optics">Anisotropic optics</h3>
<p>When the travel cost of light can depend on the direction of travel, we say that the medium is anisotropic. Now, you might expect</p>
<p><span class="math display">\[
S = \int n(\hat{\delta q}) \delta q
\]</span></p>
<p>but this is incorrect, not because there is anything necessarily wrong with the formalism, but because of how <span class="math inline">\(n\)</span> is defined by convention in anisotropic material. At this point, we must study the full particle-wave duality again.</p>
<p>For a moment, let’s pretend light is really a particle, and consider how it might appear to someone who believes light is a wave. We arrange an entire plane of photons, such that the plane is perpendicular to a unit vector <span class="math inline">\(\hat k\)</span>. Now, let them move optimally for time <span class="math inline">\(\delta\)</span>. Each of them would go in the same optimal direction <span class="math inline">\(v^*(\hat k)\)</span>, to push the wavefront as far-out as possible.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/planar_group_velocity.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="margin-caption">A plane of particles marching in sync at velocity <span class="math inline">\(v\)</span>, but the collective effect is that the plane moves with group velocity <span class="math inline">\(v_g\)</span>, which is different from the individual velocity <span class="math inline">\(v\)</span>.</figcaption>
</figure>
</div>
<p>Now, the wavefront does not move in the direction <span class="math inline">\(v^*\)</span>, but in the direction <span class="math inline">\(\hat k\)</span>. Therefore, the wavefront moves at <strong>group velocity</strong> <span class="math inline">\(v_g(\hat k) = \left\langle v^*(\hat k), \hat k\right\rangle \hat k\)</span>.</p>
<p>Since the photons are trying to push as far out as possible,</p>
<p><span class="math display">\[v^*(\hat k) = \mathop{\mathrm{argmax}}_{v \in K_{particle}} \left\langle\hat k, v\right\rangle\]</span></p>
<p>where we write <span class="math inline">\(K_{particle}\)</span> as the surface of all particle velocities in all directions. It is a sphere of radius <span class="math inline">\(c\)</span> in a vacuum, but in an anisotropic medium, we allow it to be any crazy shape.</p>
<p>Instead of studying the group velocity, we actually need to use its inverse – the wavevector <span class="math inline">\(k = \frac{\hat k}{v_g}\)</span>.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a> We thus have</p>
<div class="no-row-height column-margin column-container"><div id="fn16"><p><sup>16</sup>&nbsp;The typical definition is <span class="math inline">\(k_{usual} = \frac{2\pi}{\lambda}\hat k = \nabla \phi\)</span>, where <span class="math inline">\(\phi\)</span> is the phase of the light, and <span class="math inline">\(f\)</span> is its temporal frequency. Our definition, which makes it cleaner, but somewhat different from typical definition, is <span class="math inline">\(k_{ours} = \frac{\nabla \phi}{2\pi f} = \frac{\nabla \phi}{\omega}\)</span>.</p></div></div><p><span class="math display">\[k = \frac{\hat k}{\max_{v \in K_{particle} \left\langle v, \hat k\right\rangle}}\]</span></p>
<p>The reason we use this instead of the group velocity is that, a little simplification later, we have the beautifully simple relation</p>
<p><span class="math display">\[
\forall k \in K_{wave}, \quad \max_{v \in K_{particle}}\left\langle v, k\right\rangle = 1
\]</span></p>
<p>This is a very suggestive symmetry, which practically demands us to write it as a duality:</p>
<p><span class="math display">\[
\begin{cases}
v^*(k) = \mathop{\mathrm{argmax}}_{v \in K_{particle}}\left\langle v, k\right\rangle \\
k^*(v) = \mathop{\mathrm{argmax}}_{k \in K_{wave}}\left\langle v, k\right\rangle
\end{cases}, \quad
\begin{cases}
\left\langle v^*(k), k\right\rangle = 1\\
\left\langle v, k^*(v)\right\rangle = 1\\
\end{cases}
\]</span></p>
<p>This is the polar dual construction, often used in convex analysis.<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> <span class="citation" data-cites="hiriart-urrutyFundamentalsConvexAnalysis2001">(<a href="#ref-hiriart-urrutyFundamentalsConvexAnalysis2001" role="doc-biblioref">Hiriart-Urruty and Lemaréchal 2001, sec. C.3</a>)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="fn17"><p><sup>17</sup>&nbsp;What, just because we have not mentioned Legendre transform for a few pages, you would think that we’re done with convex analysis? Too bad! If nature is the great optimizer, then convex analysis is inescapable at every turn.</p></div></div><p>The best case is if <span class="math inline">\(K_{particle}\)</span> is convex. In this case, each <span class="math inline">\(k \in K_{wave}\)</span> defines a plane perpendicular to it, at a distance <span class="math inline">\(\|k\|^{=1}\)</span> from the origin, and the plane is tangent to <span class="math inline">\(K_{particle}\)</span> at precisely <span class="math inline">\(v^*(k)\)</span>, and conversely so. In other words, <span class="math inline">\(K_{particle}\)</span> is the envelope of polar lines to points in <span class="math inline">\(K_{wave}\)</span>, and conversely so.</p>
<p>Conversely, we can pretend that light is really a wave, and consider how it might appear to someone who believes light is a particle. We would then go through the above argument, and obtain the same result.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/polar_duals_convex.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption">A pair of polar duals. Both surfaces are convex.</figcaption>
</figure>
</div>
<p>However, we want to deal with more general cases than this, so we need to resolve two issues.</p>
<p>First issue: <span class="math inline">\(K_{particle}\)</span> might be non-convex. Second issue: it might be double-sheeted, or even many-sheeted. For example, in crystal, light polarized in two different orientations can move at two different velocities even in the same direction. Thus, its <span class="math inline">\(K_{wave}\)</span> has two sheets, and so its polar dual, <span class="math inline">\(K_{particle}\)</span>, also has two sheets.</p>
<p>Both issues are solved by extending the definition of polar duality: replace the maximum with a stationarity. We can still construct <span class="math inline">\(K_{particle}\)</span> from <span class="math inline">\(K_{wave}\)</span> by taking a tangent plane for each <span class="math inline">\(k \in K_{wave}\)</span>, but now instead of the intersection of the half-planes, we use their envelope. A picture shows what we mean:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/polar_duals_generic.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption class="margin-caption">A pair of polar duals. The surfaces are no longer convex. Notice how the double tangent on the left becomes a double crossing point on the right.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/trefoil_dual.svg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The curve on the right is a trefoil curve defined by <span class="math inline">\(z = 0.3 e^{i\phi} + e^{-2i \phi}\)</span>, shifted to make the image clearer. The curve on the left is the polar dual of the trefoil curve. It is the envelope of the polar dual lines of each point on the trefoil curve.</figcaption>
</figure>
</div>
<p>We still have a duality between points on the two surfaces, defined by stationarity, not optimality. For example, for any wavevector <span class="math inline">\(k \in K_{wave}\)</span>, its corresponding dual point <span class="math inline">\(v^*(k)\)</span> satisfies <span class="math inline">\(\left\langle v^*(k) + \delta v, k\right\rangle = 0\)</span> for any <span class="math inline">\(\delta v\)</span> in the tangent space of <span class="math inline">\(K_{particle}\)</span> at <span class="math inline">\(v^*(k)\)</span>.</p>
<p>The first application of Hamiltonian mechanics was done by Hamilton, who predicted theoretically that if light enters a biaxial crystal in just the right way, it will not just refract in one direction, but in an entire <em>cone</em> of directions – which he termed <a href="https://en.wikipedia.org/wiki/Conical_refraction">internal conical refraction</a>. The theory of this is rather fascinating, but we will only give the barest description.</p>
<p>Simply put, it turns out that in a biaxial crystal, both <span class="math inline">\(K_{particle}\)</span> and <span class="math inline">\(K_{wave}\)</span> have the same shape of a large blob containing a smaller blob, touching each other at 4 cone-shaped points. Now, let <span class="math inline">\(k_c \in K_{wave}\)</span> be one of the cone-shaped points, then it corresponds to a tangent plane to <span class="math inline">\(K_{particle}\)</span>. Each tangent point <span class="math inline">\(v \in K_{particle}\)</span>, conversely, corresponds to a tangent plane to <span class="math inline">\(k_c\)</span>.</p>
<p>Since <span class="math inline">\(k_c\)</span> is a conical point, however, there are a whole <em>circle</em> of tangent planes to <span class="math inline">\(K_{wave}\)</span> at <span class="math inline">\(k_c\)</span>. Consequently, the tangent plane to <span class="math inline">\(K_{particle}\)</span> is tangent to it on one entire circle. It is as if we throw a tire on the floor – it will touch the floor not just at three points, but an entire circle of points. Now, suppose that we have a planar wave moving in the direction of <span class="math inline">\(k_c\)</span> inside the crystal, then each light-particle would have to move in a direction <span class="math inline">\(\mathop{\mathrm{argmax}}_{v \in K_{particle}}\left\langle v, k_c\right\rangle\)</span>. But since there is an entire circle of such directions, we would have an entire circle of possible <span class="math inline">\(v\)</span>, and thus, we obtain a hollow cone of light.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/conical_refraction_tangent_velocity.jpg" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption class="margin-caption">When a planar wave travels in a crystal, such that <span class="math inline">\(K_{particle}\)</span> is tangent to the plane of the wave at an entire circle, then instead of choosing one among the entire circle of velocities, the particles simply take every single possible direction on the circle, resulting in conical refraction.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/schaefer_1949_fig_128.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The shape of the <span class="math inline">\(K_{wave}\)</span> surface. The <span class="math inline">\(K_{particle}\)</span> surface is topologically the same, and can be obtained from <span class="math inline">\(K_{wave}\)</span> by squashing it <em>just right</em>. Figure from <span class="citation" data-cites="schaeferBandTeilElektrodynamik1949">(<a href="#ref-schaeferBandTeilElektrodynamik1949" role="doc-biblioref">Schaefer 1949, 485</a>, figure 128)</span></figcaption>
</figure>
</div>
</section>
</section>
<section id="periodic-motion" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="periodic-motion">Periodic motion</h2>
<section id="oscillator-on-a-line" class="level3">
<h3 class="anchored" data-anchor-id="oscillator-on-a-line">Oscillator on a line</h3>
<p>Consider a simple harmonic oscillator (SHO), with Hamiltonian <span class="math inline">\(H\)</span> in the <span class="math inline">\((q, p)\)</span> coordinates:</p>
<p><span class="math display">\[H(t, q, p) = \frac{p^2}{2m} + \frac 12 kq^2\]</span></p>
<p>The motion of the system is very simple: a circular motion around <span class="math inline">\((q, p) = (0, 0)\)</span>:</p>
<p><span class="math display">\[\begin{cases}
\dot q = p/m \\
\dot p = - kq
\end{cases}\quad  
\begin{cases}
(q, p) = (q_0 \cos(\omega t), -m\omega q_0 \sin(\omega t)) \\
\omega = \sqrt{k/m}
\end{cases}\]</span></p>
<p>Now consider the action of an entire cycle:</p>
<p><span class="math display">\[S = \oint Ldt = \oint (pdq - Hdt)\]</span></p>
<p>The <span class="math inline">\(\oint pdq\)</span> term is the area enclosed by the ellipse, so it is <span class="math inline">\(\pi p_0 q_0\)</span>, and the <span class="math inline">\(\oint Hdt\)</span> term is just <span class="math inline">\(HT = \frac{2\pi}{\omega} \frac 12 kq_0^2\)</span>, since the system conserves energy. Now direct computation shows</p>
<p><span class="math display">\[\oint pdq = HT\]</span></p>
<p>In particular, since <span class="math inline">\(T\)</span> does not depend on the energy of the oscillation, we can take derivative against energy, obtaining</p>
<p><span class="math display">\[
\frac{d}{dE}\oint_{\gamma_E} pdq = T
\]</span></p>
<p>where <span class="math inline">\(\gamma_E\)</span> is the path traced out by the oscillator with energy <span class="math inline">\(E\)</span>. We show that this is generally true for 1D oscillators.</p>
<div id="thm-1d-oscillator-period" class="theorem">
<p><span class="theorem-title"><strong>Theorem 10</strong></span> Given any 1D oscillator,</p>
<p><span class="math display">\[
\frac{d}{dE}\oint_{\gamma_E} pdq = T(E)
\]</span></p>
<p>where <span class="math inline">\(\gamma_E\)</span> is the path traced out by the oscillator when it has energy <span class="math inline">\(E\)</span>, and <span class="math inline">\(T(E)\)</span> is the period.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Consider the phase space plot of a generic 1D oscillator. Every point in its phase space must go in a cycle, returning to the start again. Thus, its phase space is like an ugly onion: It is split into cycles, which are not generally circular in shape, and generally each cycle has a different cycling period.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figure/1doscillator.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Take a particular cycle as shown, starting and ending at <span class="math inline">\(q_0 = q_1\)</span>. Now consider this variation that fixes <span class="math inline">\((t_0, q_0), (t_1, q_1)\)</span>: move from point 0 to point 1, then go around the larger cycle to point 1, then return to point 0. The action of the varied cycle consists of three parts: <span class="math inline">\(0\to 1, 1 \to 1, 1 \to 0\)</span>. By (modified) Hamilton’s principle, the variation of action is zero.</p>
<p>Now, let <span class="math inline">\(T(E) = t_1 - t_0\)</span> be the cycle period for the cycle with energy <span class="math inline">\(E\)</span>, then from our above argument, we have</p>
<p><span class="math display">\[\oint_E pdq - E T(E) = \oint_{E + \delta E} pdq - (E + \delta E) T(E) + O(\delta E^2)\]</span></p>
<p>where the <span class="math inline">\(O(\delta E^2)\)</span> term deals with the <span class="math inline">\(0\to 1, 1\to 0\)</span> parts of <span class="math inline">\(\int -Hdt\)</span>. Thus we obtain</p>
<p><span class="math display">\[\frac{d}{dE} \oint_E pdq = T(E)\]</span></p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Worked example: pendulum in gravity">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worked example: pendulum in gravity
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The 1D pendulum in gravity, with length <span class="math inline">\(l\)</span> and mass <span class="math inline">\(m\)</span>, has Lagrangian <span class="math inline">\(L = \frac 12 m(l\dot q)^2 + mgl\cos q\)</span>, momentum <span class="math inline">\(p = ml^2 \dot q\)</span>, and Hamiltonian</p>
<p><span class="math display">\[H = \frac{p^2}{2ml^2} - mgl \cos(q)\]</span></p>
<p>We know that the pendulum is not a SHO. Indeed, the cycle period <span class="math inline">\(T(E)\)</span> strictly increases with energy <span class="math inline">\(E\)</span> of the cycle, and it diverges as the pendulum swing approaches the highest point: <span class="math inline">\(\lim_{E \to mgl} T(E) = +\infty\)</span>.</p>
<p>Consider the cycle with maximum swing angle <span class="math inline">\(\theta\)</span>. The cycle encloses an oval-shaped region in phase space, with equation <span class="math inline">\(p^2 = 2m^2 gl^3(\cos q - \cos\theta)\)</span>. Consequently, we have the somewhat mysterious result:</p>
<p><span class="math display">\[\int_0^{E(\theta)} T(E) dE = 4\sqrt{2m^2 gl^3} \int_0^\theta \sqrt{\cos q - \cos\theta} dq\]</span></p>
<p>where <span class="math inline">\(E(\theta) = -mgl \cos\theta\)</span> is the energy of the system when it has maximum swing angle <span class="math inline">\(\theta\)</span>.</p>
<p>When <span class="math inline">\(\theta\)</span> is small, the integral is approximately</p>
<p><span class="math display">\[\int_0^\theta \sqrt{\frac 12 (\theta^2 - q^2)}dq = \frac{\pi\theta^2}{4\sqrt 2}\]</span></p>
<p>which does correspond to <span class="math inline">\(T(E) \approx 2\pi\sqrt{\frac lg}\)</span>, and <span class="math inline">\(\delta E = mgl(1 - \cos(\theta)) \approx \frac 12 mgl \theta^2\)</span>.</p>
<p>When <span class="math inline">\(\theta = \pi\)</span>, the integral can be exactly evaluated:</p>
<p><span class="math display">\[\int_0^{mgl} T(E) dE = 16\sqrt{m^2 gl^3}\]</span></p>
<p>We are unable to interpret this strange but satisfying equality.</p>
<p>Taking <span class="math inline">\(\partial_\theta\)</span> under the integral sign, we get</p>
<p><span class="math display">\[T(E) = \sqrt{\frac{8l}g} \int_0^\theta \frac{dq}{\sqrt{\cos q - \cos \theta}}\]</span></p>
<p>which may be directly verified.</p>
</div>
</div>
</div>
</section>
<section id="action-angle-variables" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="action-angle-variables">Action-angle variables</h3>
<p>Now, it would be great if we could "unwind" the rotatory dynamics by a time-independent canonical transform to some <span class="math inline">\((Q, P)\)</span>, by where <span class="math inline">\(P\)</span> is constant along the cycles, and <span class="math inline">\(Q\)</span> is increasing. That is, we want <span class="math inline">\(P\)</span> to be the analog of "amplitude", and <span class="math inline">\(Q\)</span> to be the analog of "phase angle".</p>
<p>Since the transform is time-independent and canonical, the Hamiltonian <span class="math inline">\(H\)</span> is unmodified, so <span class="math inline">\(H\)</span> is a function of <span class="math inline">\(P\)</span> only, not <span class="math inline">\(Q\)</span> (since <span class="math inline">\(H\)</span> is a conserved quantity of motion). Then, since the transform is canonical, Hamilton’s equations of motion read <span class="math inline">\(\dot Q = \partial_P H(P)\)</span>. Consequently, the Hamiltonian equations of motion would become</p>
<p><span class="math display">\[\begin{cases} P(t) = P(0) \\ Q(t) = Q(0) + H'(P) t \end{cases}\]</span></p>
<p>as simple as it could be! It remains to find such a canonical transform.</p>
<p>We are already mostly there: we know that <span class="math inline">\(P\)</span> is constant along the cycles, and <span class="math inline">\(Q\)</span> increasing along the cycles. It remains to find the right scaling, so that the transform is canonical, that is, the coordinates preserve area: <span class="math inline">\(dP \wedge dQ = dp \wedge dq\)</span>.</p>
<p>Define <span class="math inline">\(P = \frac{1}{2\pi} \oint pdq\)</span>. Here the <span class="math inline">\(2\pi\)</span> factor is not essential, since we could always do a point transform, scale down <span class="math inline">\(Q\)</span> by <span class="math inline">\(2\pi\)</span>, and scale up <span class="math inline">\(P\)</span> by <span class="math inline">\(2\pi\)</span>. However, the factor will make many formulas look cleaner.</p>
<p>From the proof of <a href="#thm-1d-oscillator-period" class="quarto-xref">Theorem&nbsp;10</a>, we know that increasing the energy of the cycle by <span class="math inline">\(\delta H\)</span> would increase the cycle area by <span class="math inline">\(T(H)\delta H\)</span>, and the cycle area is <span class="math inline">\(2\pi P\)</span>, thus</p>
<p><span class="math display">\[\delta(2\pi P) = T(H) \delta H \implies \frac{2\pi}{T(H)} = H'(P)\]</span></p>
<p>so we find that the equations of motion are:</p>
<p><span class="math display">\[\begin{cases} P(t) = P(0) \\ Q(t) = Q(0) + 2\pi \frac{t}{T(H)} \end{cases}\]</span></p>
<p>This allows us to graphically construct the <span class="math inline">\((Q, P)\)</span> coordinates on phase space:</p>
<ol type="1">
<li>Draw the cycles in phase space.</li>
<li>Select a "line of longitude" arbitrarily as <span class="math inline">\(Q = 0\)</span> line.</li>
<li>Follow the trajectory of each point on the line of longitude, and mark down a new line of longitude at equal phases-angles. So for example, if you are on the cycle of energy <span class="math inline">\(E\)</span>, you would start the ride, and after <span class="math inline">\(T(E)/3\)</span> has passed, note down its phase-angle as <span class="math inline">\(2\pi/3\)</span>. The set of all such points at every cycle is the line of longitude with <span class="math inline">\(Q = 2\pi/3\)</span>.</li>
</ol>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/1doscillator-canonical.jpg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Constructing a canonical coordinate system over the phase space of the 1D oscillator.</figcaption>
</figure>
</div>
<p>Now, we can graphically see that this construction really preserves areas:</p>
<ol type="1">
<li>Take an infinitesimal parallelogram at <span class="math inline">\((Q, P)\)</span> with sides <span class="math inline">\(\delta Q, \delta P\)</span>, such that <span class="math inline">\(\delta Q = \frac{2\pi}{N}\)</span> for some infinite integer <span class="math inline">\(N\)</span>.</li>
<li>Evolve the system in discrete steps of <span class="math inline">\(\frac{T(P)}{N}\)</span>, and follow the parallelogram along.</li>
<li>Note that the parallelogram would tile the thin ring between <span class="math inline">\(P\)</span> and <span class="math inline">\(P+ \delta P\)</span>. The thin ring has area <span class="math inline">\(\delta \oint pdq = 2\pi \delta P\)</span>, so each parallelogram has area <span class="math inline">\(2\pi \delta P/N = \delta P \delta Q\)</span>.</li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is not as trivial as it seems. The idea of “area” in phase space was defined by <span class="math inline">\(\oint pdq\)</span>, so it is not obvious that <span class="math inline">\(\delta P \delta Q\)</span> would be the area of the parallelogram, <em>especially</em> considering that the sides of a parallelogram might not even be perpendicular to each other!</p>
</div>
</div>
<p>The entire construction of <span class="math inline">\((Q, P)\)</span> from <span class="math inline">\((q, p)\)</span> is often done in one divinely-inspired move by a generating function.</p>
</section>
<section id="adiabaticity" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="adiabaticity">Adiabaticity</h3>
<p>This section based on <span class="citation" data-cites="duncanConstructingQuantumMechanics2019 deoliveiraParametricInvariance2022">(<a href="#ref-duncanConstructingQuantumMechanics2019" role="doc-biblioref">Duncan and Janssen 2019, chap. 5</a>; <a href="#ref-deoliveiraParametricInvariance2022" role="doc-biblioref">de Oliveira 2022</a>)</span>.</p>
<p>The Lorentz pendulum is a famous example that connects the classical and the quantum world. In the early 1900s, as physicists were trying to explain various phenomena, such as the black body radiation spectrum, the atomic spectra, and such, they came to the <strong>quantum hypothesis</strong>. Consider a classical system undergoing periodic motion – such as the electrons cycling around a proton in the hydrogen atom. Whereas classically, its <span class="math inline">\(\oint pdq\)</span> may be of any value, the quantum hypothesis states that it can only take values in</p>
<p><span class="math display">\[
\oint pdq = nh, \quad n = 1, 2, 3, \dots
\]</span></p>
<p>for a certain constant of nature <span class="math inline">\(h\)</span> – later given the name of <strong>Planck’s constant</strong>. For example, if we have a simple harmonic oscillator, then we have</p>
<p><span class="math display">\[
E\nu = n h
\]</span></p>
<p>where <span class="math inline">\(\nu = 1/T\)</span> is the frequency of the oscillator.</p>
<p>At the 1911 Solvay Conference, where the great physicists grappled with the new quantum phenomena,<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a> Einstein gave a presentation on the quantum hypothesis. At the end of the presentation, Lorentz asked a question about the pendulum. The conversation went as follows:</p>
<div class="no-row-height column-margin column-container"><div id="fn18"><p><sup>18</sup>&nbsp;The entire conference is summarized in <span class="citation" data-cites="straumannFirstSolvayCongress2011">(<a href="#ref-straumannFirstSolvayCongress2011" role="doc-biblioref">Straumann 2011</a>)</span>.</p></div></div><blockquote class="blockquote">
<p>Mr.&nbsp;Lorentz recalls a conversation he had with Mr.&nbsp;Einstein some time ago, in which they discussed a simple pendulum that could be shortened by holding the string between two fingers and sliding them downwards. Suppose that initially, the pendulum has exactly one energy element corresponding to the frequency of its oscillations. It then seems that at the end of the experiment, its energy will be less than the element corresponding to the new frequency.</p>
<p>Mr.&nbsp;Einstein – If the length of the pendulum is changed infinitely slowly, the energy of the oscillation remains equal to <span class="math inline">\(h\nu\)</span>, if it was initially equal to <span class="math inline">\(h\nu\)</span> ; it varies proportionally to the frequency. The same is true for a resistance-free oscillating electrical circuit, and also for free radiation.</p>
<p>Mr.&nbsp;Lorentz – This result is very curious and removes the difficulty. In general, the hypothesis of energy elements gives rise to interesting problems in all cases where one can change the frequency of vibrations at will.</p>
<p><span class="citation" data-cites="institutssolvayTheorieRayonnementQuanta1912">(<a href="#ref-institutssolvayTheorieRayonnementQuanta1912" role="doc-biblioref">Instituts Solvay et al. 1912, 450</a>)</span></p>
</blockquote>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/adiabatic-pendulum.png" class="img-fluid figure-img" style="width:20.0%"></p>
<figcaption class="margin-caption">The adiabatic pendulum of Lorentz.</figcaption>
</figure>
</div>
<p>Why is this interesting? The quantum hypothesis states that for quantum oscillators, <span class="math inline">\(E/\nu = nh\)</span>, where <span class="math inline">\(n\)</span> can only take values in the natural numbers. The Lorentz pendulum seems to show that the quantity <span class="math inline">\(E/\nu\)</span> can change continuously. Thus, for example, we might start at a quantized value of <span class="math inline">\(E/\nu = 100h\)</span>, and end up at <span class="math inline">\(100.5h\)</span>, invalidating the quantum hypothesis for macroscopic systems. And if macroscopic systems do not follow the quantum hypothesis, then as the macroscopic system becomes microscopic, it seems the quantum hypothesis would be invalidated as well.</p>
<p>Einstein replied that <span class="math inline">\(E/\nu\)</span> of the oscillator <em>is conserved</em> if the length of the pendulum is changed infinitely slowly. Surprising, but it saves the quantum hypothesis.</p>
<section id="the-adiabatic-theorem" class="level4">
<h4 class="anchored" data-anchor-id="the-adiabatic-theorem">The adiabatic theorem</h4>
<p>Consider a pendulum with a string length <span class="math inline">\(\lambda\)</span> that is slowly changed over time. How slow? Slow enough that the system completes many cycles before <span class="math inline">\(\lambda\)</span> makes any appreciable change. That is,</p>
<p><span class="math display">\[\dot \lambda \ll \frac{\lambda}{T(\lambda)}\]</span></p>
<div class="callout callout-style-default callout-warning callout-titled" title="parametric resonance">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
parametric resonance
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is vitally important that the pulling on the pendulum is not only slow, but also “smeared”, meaning that <span class="math inline">\(\dot\lambda\)</span> is equal over the entirety of a single oscillation. If it is not smeared, then we can break the theory. Consider for example a (spherical) child on a (frictionless) swing (in a vacuum). It is well-known that the child can, by swinging the legs in sync with the swing, get as high as possible. This is called parametric resonance.</p>
<p>Compared to adiabatic change, parametric resonance differs in that it is discriminating about the states. When you adiabatically pull on the string of a pendulum, your rate of pulling is the same over the entire cycle of a pendulum swing. When you resonantly pull on the string of a pendulum, your rate of pulling differs over the cycle of a pendulum swing. In the language of thermodynamics, adiabaticity means treating all microstates equally, without discrimination.</p>
</div>
</div>
<p>Let the angular frequency of oscillation be <span class="math inline">\(\omega = \sqrt{\frac g\lambda}\)</span>, then <span class="math inline">\(E/\omega\)</span> is constant over time.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By basic physics, the force in the string is</p>
<p><span class="math display">\[
F = mg \cos \theta + m\dot \theta^2 / \lambda \approx mg - \underbrace{\frac 12 mg \theta^2}_{\text{$V/\lambda$}} + \underbrace{m\lambda \dot\theta^2}_{\text{$2T/\lambda$}}
\]</span></p>
<p>Because the system is undergoing simple harmonic oscillation, the time-average of <span class="math inline">\(V\)</span> and <span class="math inline">\(T\)</span> are both <span class="math inline">\(\frac 12 E\)</span>, where <span class="math inline">\(E\)</span> is the oscillation energy. Therefore, the time-average force is <span class="math inline">\(\bar F = mg + \frac 12 E/\lambda\)</span>.</p>
<p>Thus, if we shorten the string by <span class="math inline">\(\delta \lambda\)</span>, we would inject an energy of <span class="math inline">\(\delta E = \bar F (-\delta\lambda) -( mg\delta\lambda)\)</span> (we subtract away the gravitational energy at the lowest point, as it is irrelevant). This gives us</p>
<p><span class="math display">\[
\delta E + E \delta\lambda / 2\lambda = 0 \implies E\lambda^{1/2} = Const
\]</span></p>
<p>Since the angular frequency of oscillation is <span class="math inline">\(\omega = \sqrt{\frac g\lambda}\)</span>, we have the result.</p>
</div>
</div>
</div>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 9</strong></span> Perform the same analysis on a vibrating string. The string is fixed at both ends, and the length of the string is slowly changed. The string is in a standing wave pattern, and the length of the string is changed so slowly that the string completes many cycles before the length changes appreciably. What is the adiabatic invariant in this case? The answer is in <span class="citation" data-cites="rayleighXXXIVPressureVibrations1902">(<a href="#ref-rayleighXXXIVPressureVibrations1902" role="doc-biblioref">Rayleigh 1902</a>)</span>.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Adiabatic invariance to all orders">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Adiabatic invariance to all orders
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>The adiabatic invariance is actually much stronger than what we have shown. It is not just that the enclosed action <span class="math inline">\(I\)</span> is conserved up to <span class="math inline">\(O(\dot\lambda)\)</span>, but that it is conserved to all orders in <span class="math inline">\(O(\dot \lambda^n)\)</span> <span class="citation" data-cites="lenardAdiabaticInvarianceAll1959">(<a href="#ref-lenardAdiabaticInvarianceAll1959" role="doc-biblioref">Lenard 1959</a>)</span>. Under stronger restrictions, it is even conserved to order <span class="math inline">\(O(e^{c/\dot \lambda})\)</span>. See <span class="citation" data-cites="henrardAdiabaticInvariantClassical1993">(<a href="#ref-henrardAdiabaticInvariantClassical1993" role="doc-biblioref">Henrard 1993, sec. 4</a>)</span> for more theorems in this style.</p>
</div>
</div>
</div>
<p>Generalizing from this experience, for an arbitrary 1D oscillator with Hamiltonian <span class="math inline">\(H(q, p; \lambda)\)</span>, the phase space trajectory is a closed wobbly cycle. As we vary <span class="math inline">\(\lambda\)</span> adiabatically by external force, the cycle changes shape, both because the system has received energy from the external force, and because the Hamiltonian of the system has changed. Nevertheless, the area enclosed within should remain constant.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Proof">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Proof
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Let</p>
</div>
</div>
</div>
<div id="multidimensional-adiabatic-theorem" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a multidimensional oscillating system, we have three possibilities.</p>
<p>If the dimensions separate, like an <span class="math inline">\(n\)</span>-dimensional oscillator <span class="math inline">\(H = \frac{p_1^2 + \dots + p_n^2}{2m} + \frac 12 k (q_1^2 + \dots + q_n^2)\)</span>. In this case, the adiabatic theorem still applies along each dimension, with one adiabatic invariant per dimension.</p>
<p>If all dimensions mix together, like a tank of hot entangled gas. In this case, the adiabatic theorem states that if we start with the microcanonical ensemble, then the phase space volume enclosed by the surface of <span class="math inline">\(H = E\)</span> remains constant as we adiabatically vary <span class="math inline">\(\lambda\)</span>. The volume is named the Gibbs invariant.<span class="citation" data-cites="deoliveiraParametricInvariance2022">(<a href="#ref-deoliveiraParametricInvariance2022" role="doc-biblioref">de Oliveira 2022</a>)</span></p>
<p>If the dimensions neither separate nor mix together, but have some kind of complicated dynamics, then what adiabaticity means in that case is still a current area of research.</p>
</div>
</div>
</section>
<section id="connection-to-thermodynamics" class="level4">
<h4 class="anchored" data-anchor-id="connection-to-thermodynamics">Connection to thermodynamics</h4>
<p>A simpler example is when we put one ball moving in a piston. We hold one wall of the piston constant, and slowly move the other. The phase space diagram of the ball is then a rectangle. Let the ball have speed <span class="math inline">\(v\)</span>, and the walls of the piston have separation <span class="math inline">\(L\)</span>. The action enclosed by one cycle of the system is <span class="math inline">\(I = 2mvL\)</span>. If we slowly move the wall of the piston, then the action is conserved, giving us</p>
<p><span class="math display">\[
2mv_0 L_0 = 2mvL \implies v = \frac{L_0}{L} v_0
\]</span></p>
<p>We can formulate this into the language of thermodynamics. First, expand our system to three dimensions – from a piston to a box. Since the motion of the ball in the <span class="math inline">\(x, y, z\)</span> directions are independent, we can treat them separately. We also assume equipartition of energies, that is, the energy of the ball is equally distributed among the three dimensions, so <span class="math inline">\(v_{x, 0} = v_{y, 0} = v_{z, 0}\)</span>. The conservation of action then states that</p>
<p><span class="math display">\[
v_i = \frac{L_{i, 0}}{L_i} v_{i, 0} \quad \text{for } i = x, y, z
\]</span></p>
<p>Imagine the ball is a gas molecule, and the piston is a wall of a container. Let <span class="math inline">\(E = \sum_{i = x, y, z} \frac 12 mv_i^2\)</span> be the energy of the gas molecule, and <span class="math inline">\(V = \prod_{i = x, y, z}L_i\)</span> be the volume of the gas. We then have</p>
<p><span class="math display">\[
V = V_0 \prod_i \frac{L_i}{L_{i, 0}} \approx V_0 \left(1 + \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right), \quad
\begin{aligned}
E &amp;= \frac 12 m \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 v_{i, 0}^2\\
&amp;= \frac 32 m v_0^2 \frac 13 \sum_i \left(\frac{L_{i,0}}{L_i}\right)^2 \\
&amp;\approx E_0 \left(1 - \frac 23 \sum_i \frac{\delta L_{i}}{L_{i, 0}}\right)
\end{aligned}
\]</span></p>
<p>These imply that <span class="math inline">\(E^{3/2}V \approx E_0^{3/2}V_0\)</span>. Now, this is precisely what happens if you compress an ideal gas adiabatically. This is one connection between the concept of “adiabatic” in classical mechanics and thermodynamics.</p>
<div id="exr-0" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 10</strong></span> Prove that <span class="math inline">\(I\)</span> is conserved: calculate the average force <span class="math inline">\(\bar F\)</span> on the piston, then calculate the work done by the piston.</p>
</div>
</section>
<section id="more-examples" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="more-examples">More examples</h4>
<p>Given a Lorentz pendulum and a schedule for varying its arm length, we can plot the angle <span class="math inline">\(x\)</span> as a function of time, and see directly that <span class="math inline">\(I = T (\frac 12 m \dot x_{max}^2)\)</span> is conserved over many swings of the pendulum.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/sanchez-soto_fig_1_annotated.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">A Lorentz pendulum with length increasing linearly with time. As its length increases, <span class="math inline">\(\dot x_{max}\)</span> decreases while <span class="math inline">\(T\)</span> increases, keeping <span class="math inline">\(I\)</span> conserved. Annotated from <span class="citation" data-cites="sanchez-sotoVariationsAdiabaticInvariance2013">(<a href="#ref-sanchez-sotoVariationsAdiabaticInvariance2013" role="doc-biblioref">Sánchez-Soto and Zoido 2013, fig. 1</a>)</span></figcaption>
</figure>
</div>
<p>For a more rigorous proof of adiabatic invariance at the level of first-year graduate student, see <span class="citation" data-cites="wellsAdiabaticInvarianceAction2007">(<a href="#ref-wellsAdiabaticInvarianceAction2007" role="doc-biblioref">Wells and Siklos 2007</a>)</span>. <span class="citation" data-cites="henrardAdiabaticInvariantClassical1993">(<a href="#ref-henrardAdiabaticInvariantClassical1993" role="doc-biblioref">Henrard 1993</a>)</span> is a good comprehensive review of adiabatic invariance in classical mechanics, and points to the literature on a lot of applications in celestial mechanics, magnetism, and the geometry of phase space plots. In textbooks on classical statistical mechanics, the adiabatic invariance theorem is used to derive many results. <span class="citation" data-cites="fernandez-pinedaAdiabaticInvariancePhase1982">(<a href="#ref-fernandez-pinedaAdiabaticInvariancePhase1982" role="doc-biblioref">Fernandez-Pineda, Diez de los Rios, and Mengual 1982</a>)</span> gives some worked-out examples, such as the ideal gas and the photon gas.</p>
</section>
</section>
<section id="old-quantum-mechanics" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="old-quantum-mechanics">Old quantum mechanics</h3>
<blockquote class="blockquote">
<p>Sommerfeld, in the new edition of his book [Atombau und Spektrallinien], has introduced the adiabatic hypothesis through a couple of very elegant changes and footnotes, in such a way that my participation in that can rather appear reduced to — a plagiarism. Lorentz and Einstein have founded the subject, I have given it a name and Burgers has put everything in order. I was first <strong>very, very</strong> depressed. I know that I have never discovered anything, and <strong>quite surely never will discover anything</strong>, that I can love so fervently as this line of thought which I found out with so large joy.</p>
<p>Ehrenfest’s letter to Bohr, 8 May 1922. Emphasis in original. Quoted in <span class="citation" data-cites="navarroPaulEhrenfestGenesis2006">(<a href="#ref-navarroPaulEhrenfestGenesis2006" role="doc-biblioref">Navarro and Pérez 2006</a>)</span></p>
</blockquote>
<section id="the-adiabatic-hypothesis" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-adiabatic-hypothesis">The adiabatic hypothesis</h4>
<p>There are two ways to interpret the word “adiabatic”. In thermodynamics, “adiabatic” means “no exchange of heat”. In mechanics, “adiabatic” means “gradual”.<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a> It is a winding story of how one word “adiabatic” came to mean two things that fortuitously are connected after all, the details of which are given in <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966 laidlerMeaningAdiabatic1994">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, chap. 3</a>; <a href="#ref-laidlerMeaningAdiabatic1994" role="doc-biblioref">Laidler 1994</a>)</span>. The story is almost as interesting as that of the word “entropy”, which also has two meanings that are fortuitously connected after all.</p>
<div class="no-row-height column-margin column-container"><div id="fn19"><p><sup>19</sup>&nbsp;Because “adiabatic” has two meanings in English, in Chinese, it also has two different translations based on the two meanings. There is 绝热, which means “no exchange of heat”, and 浸渐, which means “gradually, like moisture soaking into something”.</p></div></div><p>Rankine first coined the term “adiabatic” in 1858, to denote a process in which no heat is exchanged with the surroundings. Later, Boltzmann and Clausius tried to explain the second law of thermodynamics mechanically, by using purely mechanical models of the microscopic world. In this sense, they defined an “adiabatic” mechanical process to be one where a certain variable is slowly changed (for example, if we have a box of little bouncing balls, and we very slowly move its walls), because an adiabatic thermodynamic process in their view is actually an adiabatic mechanical process.</p>
<p>“Adiabatic motion” in mechanics was introduced by Helmholtz and Hertz, to denote mechanical processes where external forces act upon a system, but only on a few parameters, with no action on the underlying details. For example, think back to the case of bouncing balls in a box. The external force only moves the walls of the box <em>on average</em>, with no attempt to move the walls to manipulate the precise location of the ball. They used the thermodynamic terminology, because the work done on the system during an adiabatic motion results exclusively in changes in its energy. <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, chap. 3</a>)</span></p>
<p>In 1900, Pyotr Lebedev experimentally proved that radiation pressure exists, and follows Maxwell’s theory of electromagnetism. Inspired by this, Lord Rayleigh <span class="citation" data-cites="rayleighXXXIVPressureVibrations1902">(<a href="#ref-rayleighXXXIVPressureVibrations1902" role="doc-biblioref">Rayleigh 1902</a>)</span> generalized the concept of radiation pressure to all kinds of vibrations, starting with the humble pendulum. Since his goal was to understand what happens when you adiabatically compress a photon gas, that is, <a href="https://en.wikipedia.org/wiki/Wien's_displacement_law#Discovery">Wien’s displacement law</a>,<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> he studied the effect of adiabatic motion on some simple mechanical systems undergoing wave motion, such as the Lorentz pendulum, a vibrating cord, a piston of gas with a standing acoustic ave, etc.</p>
<div class="no-row-height column-margin column-container"><div id="fn20"><p><sup>20</sup>&nbsp;Since he didn’t actually know what a photon was, it might be better to say that he was studying what would happen when you compress a hot chamber of light. Though Wien’s displacement law is nowadays proved straight from quantum mechanics, back when ien discovered it in 1893, he used a thermodynamic argument using the adiabatic compression of a photon gas. For a brief presentation of how Rayleigh did it, see <span class="citation" data-cites="terhaarAdiabaticInvarianceAdiabatic1966">(<a href="#ref-terhaarAdiabaticInvarianceAdiabatic1966" role="doc-biblioref">Ter Haar 1966</a>)</span>.</p></div></div><p>Like Lord Kelvin, Paul Ehrenfest was also trying to explain Wien’s displacement law. He was puzzled by the fact that while Wien’s displacement law was derived without the quantum hypothesis, yet somehow, it remains true. Suppose we start with a box of light, then it follows a certain black body radiation, which can only be derived by the quantum hypothesis. Now suppose we adiabatically compress the box of light. Though the compression process is studied classically, without the quantum hypothesis, the final state of the light is still the black body radiation. So, it seems that if we start with a system following the quantum hypothesis, then any adiabatic <em>classical</em> process would give us a system that still follows the quantum hypothesis. This is his <strong>adiabatic hypothesis</strong>, for which he is famous.</p>
<p>During the 1910s, Ehrenfest published a series of papers to subsume the many ad-hoc quantum rules under the framework of the adiabatic hypothesis. His idea is as follows: If, in a periodic system described by classical mechanics (such as an electron orbiting a proton), a certain quantity <span class="math inline">\(I\)</span> has units of joule-second, and is conserved as it undergoes adiabatic motion, then this quantity <em>should</em> be quantized, and only this quantity <em>can</em> be quantized. Only <span class="math inline">\(I\)</span> <em>can</em> be quantized, for the reason discussed by Lorentz and Einstein at the Solvay conference.</p>
<p>Further, <span class="math inline">\(I\)</span> <em>should</em> be quantized, because otherwise, why else should <span class="math inline">\(I\)</span> be adiabatically conserved? The adiabaticity of <span class="math inline">\(I\)</span> in the classical world, on the surface, is a shadow of the discreteness of <span class="math inline">\(I\)</span> in the quantum world, deep down. Because <span class="math inline">\(I\)</span> is quantized, if we vary the system slowly enough, the system would have no reason to make a big jump from <span class="math inline">\(I = nh\)</span> to <span class="math inline">\(I = (n+1)h\)</span>. This discretenesss in the quantum world traps <span class="math inline">\(I\)</span> in its starting position, and this is why <span class="math inline">\(I\)</span> appears adiabatic in the classical world.</p>
<p>Thus, quantized quantities are precisely adiabatic invariants. We can write down <span class="math inline">\(I = nh\)</span>, where <span class="math inline">\(n \in \mathbb{N}\)</span>, and proceed to calculate the properties of the system, such as its energy levels, its absorption and emission spectra, etc.</p>
<p>In short, this is Ehrenfest’s recipe for doing “old quantum mechanics”:</p>
<ul>
<li>Find a system that has a conserved quantity <span class="math inline">\(I\)</span> under adiabatic motion.
<ul>
<li>You can do this by solving the equations of motion, then integrate <span class="math inline">\(\oint pdq\)</span>.</li>
<li>Alternatively, you can start with a harmonic oscillator, and adiabatically deform the system until it becomes the system you want. Ehrenfest called such systems “adiabatically related to the harmonic oscillator” <span class="citation" data-cites="jammerConceptualDevelopmentQuantum1966">(<a href="#ref-jammerConceptualDevelopmentQuantum1966" role="doc-biblioref">Jammer 1966, 99</a>)</span>.</li>
</ul></li>
<li>Proclaim that <span class="math inline">\(I = nh\)</span> for some constant <span class="math inline">\(h\)</span>.</li>
<li>Calculate the properties of the system.</li>
</ul>
</section>
<section id="the-bohrsommerfeld-model" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-bohrsommerfeld-model">The Bohr–Sommerfeld model</h4>
<p>As an example, consider the pinnacle of old quantum theory, the <a href="https://en.wikipedia.org/wiki/Bohr%E2%80%93Sommerfeld_model">Bohr–Sommerfeld model</a> of the hydrogen atom. First, treat the hydrogen atom as if it is a relativisitic solar system, with the electron as a planet, moving at relativistic speeds<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a> under the inverse-square force <span class="math inline">\(F \propto \frac{1}{r^2}\)</span>. Next, assume that the adiabatic invariant is quantized:</p>
<div class="no-row-height column-margin column-container"><div id="fn21"><p><sup>21</sup>&nbsp;Because the electron moves faster closer to the atom than further away, it has more mass close to the atom than further away. This allows the orbit to precess in a way that is not predicted by Newtonian mechanics. Generally, any perturbation of the inverse-square force will cause the orbit to precess. Even special relativity would predict some precession for the perihelion of Mercury, though it predicts a value of <span class="math inline">\(7''/\text{year}\)</span> only <span class="math inline">\(1/6\)</span> of the correct value <span class="citation" data-cites="mcdonaldSpecialRelativityPrecession2023 goldsteinClassicalMechanics2008">(<a href="#ref-mcdonaldSpecialRelativityPrecession2023" role="doc-biblioref">McDonald 2023</a>; <a href="#ref-goldsteinClassicalMechanics2008" role="doc-biblioref">Goldstein, Poole, and Safko 2008</a>, exercise 7.27, page 332)</span>. Only general relativity predicts the correct value. Assuming that only special relativity contributes, the perihelion of Mercury would take <span class="math inline">\(7.5e7\)</span> Mercury-years to go around the sun once.</p>
<p>As the electron moves a lot faster than Mercury, it takes much shorter time, but still it takes <span class="math inline">\(4e4\)</span> electron-years to go around the nucleus once, as noted in Bohr’s Nobel lecture <span class="citation" data-cites="bohrStructureAtom1923">(<a href="#ref-bohrStructureAtom1923" role="doc-biblioref">Bohr 1923</a>)</span>.</p></div></div><p><span class="math display">\[\int_0^T p_r \,dq_r = n' h\]</span></p>
<p>where <span class="math inline">\(q_r\)</span> is the radial position of the electron, <span class="math inline">\(p_r\)</span> is the momentum conjugate to it, <span class="math inline">\(n'\)</span> is the “auxiliary quantum number”, and <span class="math inline">\(T\)</span> is the period of the electron’s orbit. This, when combined with the hypothesis of quantized angular momentum <span class="math inline">\(mvr = nh\)</span> (here, <span class="math inline">\(n\)</span> is the “principal quantum number”), would predict the emission spectrum of the hydrogen atom.<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a></p>
<div class="no-row-height column-margin column-container"><div id="fn22"><p><sup>22</sup>&nbsp;Because the equation of motion for the electron separates into a radial component <span class="math inline">\(q_r, p_r\)</span> and an angular component <span class="math inline">\(q_\theta, p_\theta\)</span>, we can apply the <a href="#multidimensional-adiabatic-theorem">multidimensional adiabatic theorem</a> and find that both <span class="math inline">\(\int_0^T p_r \,dq_r\)</span> and <span class="math inline">\(\int_0^T p_\theta \,dq_\theta\)</span> are adiabatic invariants.</p></div></div><p>Sommerfeld went further, piling epicycles upon epicycles, to explain the fine structure of atomic spectra. All those has been swept away by the new quantum theory like how the new astronomy of Kepler swept away the epicycles of Ptolemy. But the adiabatic hypothesis remains to this day a fruitful meeting point between the classical, the quantum, and the thermodynamic world.</p>
<p>Have some cool pictures, because I like cool pictures.</p>
<div id="fig-atombau" class="quarto-layout-panel page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-atombau-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Selections from <span class="citation" data-cites="sommerfeldAtomicStructureSpectral1923">(<a href="#ref-sommerfeldAtomicStructureSpectral1923" role="doc-biblioref">Sommerfeld 1923</a>)</span>.</p>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_197.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Quantization of the adiabatic invariant. Page 197.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_199.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">This looks familiar… it looks just like the phase space plot of a ball bouncing in a piston. Page 199.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_240.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="margin-caption">Orbits of the hydrogen atom with the same principal quantum number <span class="math inline">\(n\)</span>, but different auxiliary quantum number <span class="math inline">\(n'\)</span>. Page 240.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atombau_en_p_502.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="margin-caption">5 electrons with the same principal and auxiliary quantum numbers, interacting by the pentagonal dance. Page 502.</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-atombau-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
<div id="fig-kramers" class="quarto-layout-panel page-columns page-full">
<figure class="quarto-float quarto-float-fig figure page-columns page-full">
<div aria-describedby="fig-kramers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: flex-start;">
<p>Selections from <span class="citation" data-cites="kramersAtomBohrTheory1923">(<a href="#ref-kramersAtomBohrTheory1923" role="doc-biblioref">Kramers 1923</a>)</span>.</p>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/fig_27_Kramer_Holst_1923.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="margin-caption">Orbits of the Bohr–Sommerfeld model of the hydrogen atom, labelled by their principal quantum numbers and auxiliary quantum numbers. The jumps from 3<sub>1</sub>, 3<sub>2</sub>, 3<sub>3</sub> to 2<sub>2</sub> all create the Balmer spectral line H<sub>α</sub>, but they differ at the fine structure. Figure 27.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/structure_of_the_radium_figure_Kramer_Holst_1923.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">Orbits of the Bohr–Sommerfeld model of the Radium atom. First end plate. I find its fonts very classy.</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row page-full">
<div class="quarto-layout-cell page-columns page-full" style="flex-basis: 100.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/atomteori_vectorized_bohr_atoms.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">A modern redrawing. <span class="citation" data-cites="holtebekkAtomAtomteori2023">(<a href="#ref-holtebekkAtomAtomteori2023" role="doc-biblioref">Holtebekk and Linder 2023</a>)</span></figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig quarto-uncaptioned margin-caption" id="fig-kramers-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>What we are nowadays hearing of the language of spectra is a true “ music of the spheres ” within the atom, chords of integral relationships, an order and harmony that becomes ever more perfect in spite of the manifold variety. The theory of spectral lines will bear the name of Bohr for all time. But yet another name will be permanently associated with it, that of Planck. All integral laws of spectral lines and of atomic theory spring originally from the quantum theory. It is the mysterious organon on which Nature plays her music of the spectra, and according to the rhythm of which she regulates the structure of the atoms and nuclei.</p>
<p>Preface to the first edition of <em>Atomic structure and spectral lines</em>, Arnold Sommerfeld, 1919. <span class="citation" data-cites="sommerfeldAtomicStructureSpectral1923">(<a href="#ref-sommerfeldAtomicStructureSpectral1923" role="doc-biblioref">Sommerfeld 1923</a>)</span></p>
</blockquote>
</section>
<section id="the-einsteinbrillouinkeller-quantization" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="the-einsteinbrillouinkeller-quantization">The Einstein—Brillouin–Keller quantization</h4>
<p>This topic is quite obscure and hard to find a simple reference on, yet I found that it is absolutely necessary to treat this correctly, if only to soothe my mathematical conscience. I wrote it based on <span class="citation" data-cites="stoneEinsteinUnknownInsight2005 duncanConstructingQuantumMechanics2019">(<a href="#ref-stoneEinsteinUnknownInsight2005" role="doc-biblioref">Stone 2005</a>; <a href="#ref-duncanConstructingQuantumMechanics2019" role="doc-biblioref">Duncan and Janssen 2019, chap. 5</a>)</span>.</p>
<p>Let’s take a more careful look at the Bohr–Sommerfeld model of a hydrogen atom. The electron orbits a proton, and the equation of motion is spherically symmetric. Therefore, we can write it in spherical coordinates <span class="math inline">\((r, \theta, \psi)\)</span>, where <span class="math inline">\(r\)</span> is the radius, <span class="math inline">\(\theta\)</span> is the co-latitude, and <span class="math inline">\(\psi\)</span> is the longitude. The Bohr–Sommerfeld quantization then states that</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \oint p_r d r = n_r h \\
&amp; \oint p_{\theta} d \theta=n_\theta h, \\
&amp; \oint p_\psi d \psi=n_\psi h .
\end{aligned}
\]</span></p>
<p>for some positive integers <span class="math inline">\(n_r, n_\theta, n_\psi\)</span>. However, we notice something deeply unsatisfying: How does the atom “know” which way is the sphere pointing? To define the spherical coordinates, we need to define the direction of the north and south pole. The Bohr–Sommerfeld quantization condition is thus creating an artificial direction in space where none should exist. Worse, if we solve the equations, we would find that this artificial direction has physically measurable consequences.</p>
<p>Sommerfeld evaded the difficulty by arguing that there never is a zero field anywhere in space. As long as there is the weakest magnetic field <span class="math inline">\(B\)</span> pointing in some direction <span class="math inline">\(\hat z\)</span>, that direction can be picked to be the north pole direction.</p>
<p>We see the difficulty inherent in old quantum theory. Suppose we have a hydrogen atom suspended in free space, then the tiniest change in the external magnetic field would create a large (for the atom, at least) change in its north-pole direction. The <a href="https://en.wikipedia.org/wiki/Stern%E2%80%93Gerlach_experiment">Stern–Gerlach experiment</a>, performed in 1922, experimentally showed that the external field can determine the direction of <span class="math inline">\(\hat z\)</span>, and thus the quantization of angular momentum. To see something in classical mechanics so jumpy is disconcerting, and certainly disturbed me greatly when I first understood the Stern–Gerlach experiment. In 4 years, Schrödinger would have proposed his equation, Heisenberg his matrix mechanics, and old quantum theory washed away by the new quantum mechanics.</p>
<p>Einstein, in his only paper on the old quantum mechanics,<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a> elegantly resolved the problem by using the <a href="@thm-poincare-cartan">Poincaré–Cartan integral invariant</a> to construct quantization equations that do not depend on our arbitrary choices of coordinate systems.</p>
<div class="no-row-height column-margin column-container"><div id="fn23"><p><sup>23</sup>&nbsp;<span class="citation" data-cites="einsteinQuantensatzSommerfeldUnd1917">(<a href="#ref-einsteinQuantensatzSommerfeldUnd1917" role="doc-biblioref">Einstein 1917</a>)</span>, reprinted and translated in <span class="citation" data-cites="einsteinCollectedPapersAlbert1997">(<a href="#ref-einsteinCollectedPapersAlbert1997" role="doc-biblioref">Einstein 1997, vol. 6</a>, pages 434–444)</span>.</p></div><div id="fn24"><p><sup>24</sup>&nbsp;In the jargon of topology, this is a linear function on <span class="math inline">\(T^d\)</span>, <a href="https://en.wikipedia.org/wiki/Homology_(mathematics)">the homology group of the torus</a>. Here, <span class="math inline">\(d\)</span> is the dimension of the torus.</p></div></div><p>As we saw with <a href="#exr-zero-poincare-cartan" class="quarto-xref">Exercise&nbsp;2</a>, a contractable loop on the torus integrates to zero. Thus, we can attach and detach contractible loops at will, deform the cycle arbitrarily, and still get the same number. That is, the integral is determined by the topology of the cycle, not the exact shape of the cycle.<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a> This gives us the Einstein quantization:</p>
<p><span class="math display">\[
\oint_{\gamma_i} \left\langle p, dq\right\rangle = n_i h
\]</span></p>
<p>where <span class="math inline">\(\gamma_1, \dots, \gamma_d\)</span> range over the <span class="math inline">\(d\)</span> topologically distinct loops around the <span class="math inline">\(n\)</span>-dimensional torus in phase space, and <span class="math inline">\(n_1, \dots, n_d\)</span> are positive integers. This was later modified by Brillouin and Keller to take account of singularities in the trajectory, such as a hard wall reflector, giving us the <a href="https://en.wikipedia.org/wiki/Einstein%E2%80%93Brillouin%E2%80%93Keller_method">EBK quantization</a>.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/EBK_quantization.jpg" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">A particle moving in a central potential. Its angular momentum <span class="math inline">\(p_\theta\)</span> is conserved, so we do not plot it. Plotting its other three phase-space variables <span class="math inline">\((r, \theta, p_r)\)</span>, we see that its orbit makes a spiralling and rotating pattern on a torus. There are two fundamental ways to cycle around the torus, and each has a corresponding Poincaré–Cartan integral that is independent of the precise shape of the cycle. The two integrals are quantized according to the EBK quantization.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The EBK quantization resembles the Bohr–Sommerfeld quantization condition, but it is quite different. In the Bohr–Sommerfeld quantization condition, the integral <span class="math inline">\(\oint p_i dq_i\)</span> integrates over a cycle of <em>physically real</em> trajectory in phase space. In EBK quantization, the integral <span class="math inline">\(\oint_{\gamma_i} \left\langle p, dq\right\rangle\)</span> integrates over a <em>geometric</em> cycle in phase space with <em>no physical reality at all</em>.</p>
<p>Both conditions happen to be the same when we have a 1D oscillator, but that is because the only way to <em>physically</em> go around the torus is the only way to <em>geometrically</em> go around the torus. It is a misleading coincidence.</p>
<p>In general, the physically real trajectories look like a braiding on the torus, and are not even closed cycles. They definitely do <em>not</em> go around the torus exactly once in exactly one direction.</p>
</div>
</div>
<p>There is only one problem left: What happens when we don’t have a torus? It is all well and good when we can construct a torus in phase space with as many dimensions as possible. However, when we have a classically chaotic system, such as the three body problem, we cannot have something this simple.</p>
<p>Consider the simplest case of three body problem: We put two suns in a circular orbit around each other, and a speck of dust orbiting them. The two suns’ orbit is perfectly predictable, so we consider only the trajectory of the dust. We also assume the dust only moves in the plane of the suns. Thus, the system has only 2 dimensions of configuration, or 4 dimensions of phase.</p>
<p>As the energy of the system is conserved, the motion of the dust is restricted to the constant energy surface <span class="math inline">\(H(q_1, q_2, p_1 p_2) = E\)</span>, which is a 3-dimensional blob within the 4-dimensional phase space. However, in general, this is all we can say about it. The motion of the dust is chaotic, and would densely criss-cross over a 3-dimensional subset of the blob.</p>
<p>Without a torus in phase space, we cannot find trajectories around the torus, and so the integral <span class="math inline">\(\oint_{\gamma}\lra{p, dq\)</span> is undefined. Einstein presciently pointed this out in his 1916 paper:</p>
<blockquote class="blockquote">
<p>If there exist fewer than <span class="math inline">\(d\)</span> [constants of motion], as is the case, for example, according to Poincaré in the three-body problem, then the <span class="math inline">\(p_i\)</span> are not expressible by the <span class="math inline">\(q_i\)</span> and the quantum condition of Sommerfeld-Epstein fails also in the slightly generalized form that has been given here.</p>
</blockquote>
<p>This failure of the EBK quantization on classically chaotic systems was forgotten for many years, but eventually rediscovered <span class="citation" data-cites="stoneEinsteinUnknownInsight2005">(<a href="#ref-stoneEinsteinUnknownInsight2005" role="doc-biblioref">Stone 2005</a>)</span>. When it did, it became a seed of quantum chaos, which I hope to explain clearly some day. In the mean time, I leave you with a beautiful picture of quantum chaos instead:</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/chaotic_integrable_quantum_billiard.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">The nonchaotic quantum circular billiard and the chaotic quantum cardioid billiard. Figure from <span class="citation" data-cites="backerQuantumChaosBilliards2007">(<a href="#ref-backerQuantumChaosBilliards2007" role="doc-biblioref">Backer 2007</a>)</span></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figure/king_2009_quantum_scars.png" class="img-fluid figure-img"></p>
<figcaption class="margin-caption">In a chaotic quantum “stadium” billiard, the standing wave functions look dark along certain lines. You can think of them as taking a classical billiard table, and using a knife to cut along the classical trajectories. The scars left behind are the <a href="https://en.wikipedia.org/wiki/Quantum_scar">quantum scars</a> of departed classicality. Figure from <span class="citation" data-cites="kingExploringQuantumClassical2014">(<a href="#ref-kingExploringQuantumClassical2014" role="doc-biblioref">King 2014</a>)</span></figcaption>
</figure>
</div>



</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-arnoldMathematicalMethodsClassical2001" class="csl-entry" role="listitem">
Arnol’d, V. I. 2001. <em>Mathematical Methods of Classical Mechanics</em>. 2. ed., [7. korr. Nachdr.]. Graduate Texts in Mathematics 60. New York: Springer.
</div>
<div id="ref-backerQuantumChaosBilliards2007" class="csl-entry" role="listitem">
Backer, Arnd. 2007. <span>“Quantum <span>Chaos</span> in <span>Billiards</span>.”</span> <em>Computing in Science &amp; Engineering</em> 9 (3): 60–64. <a href="https://doi.org/10.1109/MCSE.2007.61">https://doi.org/10.1109/MCSE.2007.61</a>.
</div>
<div id="ref-bellmanEyeHurricaneRichard1984" class="csl-entry" role="listitem">
Bellman, Richard. 1984. <em>Eye of the Hurricane: <span>Richard Bellman</span> ; <span>An</span> Autobiography</em>. Singapore: World Scientific.
</div>
<div id="ref-bohrStructureAtom1923" class="csl-entry" role="listitem">
Bohr, N. 1923. <span>“The <span>Structure</span> of the <span>Atom</span>.”</span> <em>Nature</em> 112 (2801): 29–44. <a href="https://doi.org/10.1038/112029a0">https://doi.org/10.1038/112029a0</a>.
</div>
<div id="ref-campanteAdvancedMacroeconomicsEasy2021" class="csl-entry" role="listitem">
Campante, Filipe, Federico Sturzenegger, and Andrés Velasco. 2021. <em>Advanced <span>Macroeconomics</span>: <span>An Easy Guide</span></em>. London: Ubiquity Press.
</div>
<div id="ref-debroglieWaveNatureElectron1929" class="csl-entry" role="listitem">
De Broglie, Louis. 1929. <span>“The Wave Nature of the Electron.”</span> <em>Nobel Lecture</em> 12: 244–56.
</div>
<div id="ref-deoliveiraParametricInvariance2022" class="csl-entry" role="listitem">
de Oliveira, Mário J. 2022. <span>“Parametric <span>Invariance</span>.”</span> <em>Brazilian Journal of Physics</em> 52 (3): 67. <a href="https://doi.org/10.1007/s13538-022-01067-x">https://doi.org/10.1007/s13538-022-01067-x</a>.
</div>
<div id="ref-derbesFeynmanDerivationSchrodinger1996" class="csl-entry" role="listitem">
Derbes, David. 1996. <span>“Feynman’s Derivation of the <span class="nocase">Schr<span class="nocase">ö</span>dinger</span> Equation.”</span> <em>American Journal of Physics</em> 64 (7): 881–84.
</div>
<div id="ref-duncanConstructingQuantumMechanics2019" class="csl-entry" role="listitem">
Duncan, Anthony, and Michel Janssen. 2019. <em>Constructing Quantum Mechanics. <span>Volume</span> 1: <span>The</span> Scaffold 1900-1923</em>. First edition. Oxford, United Kingdom ; New York, NY: Oxford University Press.
</div>
<div id="ref-einsteinQuantensatzSommerfeldUnd1917" class="csl-entry" role="listitem">
Einstein, Albert. 1917. <span>“Zum Quantensatz von <span>Sommerfeld</span> Und <span>Epstein</span>.”</span> <em>Verh. D. D. Physik. Ges</em>, 82–92.
</div>
<div id="ref-einsteinCollectedPapersAlbert1997" class="csl-entry" role="listitem">
———. 1997. <em>The Collected Papers of <span>Albert Einstein</span>: Writings, 1914-1917</em>. Edited by Alfred Engel and Engelbert Schucking. English translation of selected texts. Princeton: Princeton university press.
</div>
<div id="ref-fernandez-pinedaAdiabaticInvariancePhase1982" class="csl-entry" role="listitem">
Fernandez-Pineda, C., A. Diez de los Rios, and J. I. Mengual. 1982. <span>“Adiabatic Invariance of Phase Volume in Some Easy Cases.”</span> <em>American Journal of Physics</em> 50 (3): 262–67. <a href="https://doi.org/10.1119/1.12863">https://doi.org/10.1119/1.12863</a>.
</div>
<div id="ref-feynmanQEDStrangeTheory2006" class="csl-entry" role="listitem">
Feynman, Richard P. 2006. <em><span>QED</span>: The Strange Theory of Light and Matter</em>. Expanded ed. Princeton Science Library. Princeton, NJ: Princeton Univ. Press.
</div>
<div id="ref-goldsteinClassicalMechanics2008" class="csl-entry" role="listitem">
Goldstein, Herbert, Charles P. Poole, and John L. Safko. 2008. <em>Classical Mechanics</em>. 3. ed., [Nachdr.]. San Francisco Munich: Addison Wesley.
</div>
<div id="ref-hamillStudentGuideLagrangians2013" class="csl-entry" role="listitem">
Hamill, Patrick. 2013. <em>A <span>Student</span>’s <span>Guide</span> to <span>Lagrangians</span> and <span>Hamiltonians</span></em>. 1st edition. New York: Cambridge University Press.
</div>
<div id="ref-hamiltonGeneralMethodExpressing1833" class="csl-entry" role="listitem">
Hamilton, Sir William Rowan. 1833. <em>On a <span>General Method</span> of <span>Expressing</span> the <span>Paths</span> of <span>Light</span>, &amp; of the <span>Planets</span>, by the <span>Coefficients</span> of a <span>Characteristic Function</span></em>. P.D. Hardy.
</div>
<div id="ref-henrardAdiabaticInvariantClassical1993" class="csl-entry" role="listitem">
Henrard, J. 1993. <span>“The <span>Adiabatic Invariant</span> in <span>Classical Mechanics</span>.”</span> In <em>Dynamics <span>Reported</span>: <span>Expositions</span> in <span>Dynamical Systems</span></em>, edited by C. K. R. T. Jones, U. Kirchgraber, and H. O. Walther, 117–235. Berlin, Heidelberg: Springer. <a href="https://doi.org/10.1007/978-3-642-61232-9_4">https://doi.org/10.1007/978-3-642-61232-9_4</a>.
</div>
<div id="ref-hiriart-urrutyFundamentalsConvexAnalysis2001" class="csl-entry" role="listitem">
Hiriart-Urruty, Jean-Baptiste, and Claude Lemaréchal. 2001. <em>Fundamentals of Convex Analysis</em>. Grundlehren Text Editions. Berlin ; New York: Springer.
</div>
<div id="ref-holtebekkAtomAtomteori2023" class="csl-entry" role="listitem">
Holtebekk, Trygve, and Jacob Linder. 2023. <span>“<span>atom – atomteori</span>.”</span> <em>Store norske leksikon</em>, August.
</div>
<div id="ref-institutssolvayTheorieRayonnementQuanta1912" class="csl-entry" role="listitem">
Instituts Solvay, Brussels Institut international de physique Conseil de physique, Ernest Solvay, Paul Langevin, Maurice de Broglie, and Albert Einstein. 1912. <em><span>La th<span>é</span>orie du rayonnement et les quanta</span></em>. Paris : Gauthier-Villars.
</div>
<div id="ref-jammerConceptualDevelopmentQuantum1966" class="csl-entry" role="listitem">
Jammer, Max. 1966. <em>The <span>Conceptual Development</span> of <span>Quantum Mechanics</span></em>. First Edition. McGraw-Hill.
</div>
<div id="ref-kingExploringQuantumClassical2014" class="csl-entry" role="listitem">
King, Chris C. 2014. <span>“Exploring <span>Quantum</span>, <span>Classical</span> and <span>Semi-Classical Chaos</span> in the <span>Stadium Billiard</span>.”</span> <em>Quanta</em> 3 (1): 16. <a href="https://doi.org/10.12743/quanta.v3i1.23">https://doi.org/10.12743/quanta.v3i1.23</a>.
</div>
<div id="ref-kramersAtomBohrTheory1923" class="csl-entry" role="listitem">
Kramers, Hendrik Anthony. 1923. <em>The Atom and the <span>Bohr</span> Theory of Its Structure : An Elementary Presentation</em>. New York : A.A. Knopf.
</div>
<div id="ref-laidlerMeaningAdiabatic1994" class="csl-entry" role="listitem">
Laidler, Keith J. 1994. <span>“The Meaning of "Adiabatic".”</span> <em>Canadian Journal of Chemistry</em> 72 (3): 936–38. <a href="https://doi.org/10.1139/v94-121">https://doi.org/10.1139/v94-121</a>.
</div>
<div id="ref-lenardAdiabaticInvarianceAll1959" class="csl-entry" role="listitem">
Lenard, Andrew. 1959. <span>“Adiabatic Invariance to All Orders.”</span> <em>Annals of Physics</em> 6 (3): 261–76. <a href="https://doi.org/10.1016/0003-4916(59)90082-X">https://doi.org/10.1016/0003-4916(59)90082-X</a>.
</div>
<div id="ref-lunneyInsOutsConical2006" class="csl-entry" role="listitem">
Lunney, James G., and Denis Weaire. 2006. <span>“The Ins and Outs of Conical Refraction.”</span> <em>Europhysics News</em> 37 (3): 26–29.
</div>
<div id="ref-masoliverClassicalQuantumMechanics2009" class="csl-entry" role="listitem">
Masoliver, Jaume, and Ana Ros. 2009. <span>“From Classical to Quantum Mechanics Through Optics.”</span> <em>European Journal of Physics</em> 31 (1): 171.
</div>
<div id="ref-mcdonaldSpecialRelativityPrecession2023" class="csl-entry" role="listitem">
McDonald, Kirk T. 2023. <span>“Special <span>Relativity</span> and the <span>Precession</span> of the <span>Perihelion</span>.”</span> <em>JH Lab., Princeton University</em>.
</div>
<div id="ref-navarroPaulEhrenfestGenesis2006" class="csl-entry" role="listitem">
Navarro, Luis, and Enric Pérez. 2006. <span>“Paul <span>Ehrenfest</span>: <span>The Genesis</span> of the <span>Adiabatic Hypothesis</span>, 1911–1914.”</span> <em>Archive for History of Exact Sciences</em> 60 (2): 209–67. <a href="https://doi.org/10.1007/s00407-005-0105-1">https://doi.org/10.1007/s00407-005-0105-1</a>.
</div>
<div id="ref-nesterenkoInstabilityClassicalDynamics2007" class="csl-entry" role="listitem">
Nesterenko, V. V. 2007. <span>“Instability of Classical Dynamics in Theories with Higher Derivatives.”</span> <em>Physical Review D</em> 75 (8): 087703. <a href="https://doi.org/10.1103/PhysRevD.75.087703">https://doi.org/10.1103/PhysRevD.75.087703</a>.
</div>
<div id="ref-ostrogradskyMemoiresEquationsDifferentielles1850" class="csl-entry" role="listitem">
Ostrogradsky, M. 1850. <span>“M<span>é</span>moires Sur Les <span>É</span>quations Diff<span>é</span>rentielles, Relatives Au Probl<span>è</span>me Des Isop<span>é</span>rim<span>è</span>tres.”</span> In.
</div>
<div id="ref-paisFieldTheoriesNonLocalized1950" class="csl-entry" role="listitem">
Pais, A., and G. E. Uhlenbeck. 1950. <span>“On <span>Field Theories</span> with <span>Non-Localized Action</span>.”</span> <em>Physical Review</em> 79 (1): 145–65. <a href="https://doi.org/10.1103/PhysRev.79.145">https://doi.org/10.1103/PhysRev.79.145</a>.
</div>
<div id="ref-paullinAtlasHistoricalGeography1932" class="csl-entry" role="listitem">
Paullin, Charles Oscar. 1932. <em>Atlas of the Historical Geography of the <span>United States</span></em>. <span>[Washington] : published jointly by Carnegie Institution of Washington and the American Geographicl Society of New York</span>.
</div>
<div id="ref-rayleighXXXIVPressureVibrations1902" class="csl-entry" role="listitem">
Rayleigh, Lord. 1902. <span>“<span>XXXIV</span>. <span><em>On</em></span><span> <em>the Pressure of Vibrations</em></span>.”</span> <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 3 (15): 338–46. <a href="https://doi.org/10.1080/14786440209462769">https://doi.org/10.1080/14786440209462769</a>.
</div>
<div id="ref-sanchez-sotoVariationsAdiabaticInvariance2013" class="csl-entry" role="listitem">
Sánchez-Soto, Luis L., and Jesús Zoido. 2013. <span>“Variations on the Adiabatic Invariance: <span>The Lorentz</span> Pendulum.”</span> <em>American Journal of Physics</em> 81 (1): 57–62. <a href="https://doi.org/10.1119/1.4763746">https://doi.org/10.1119/1.4763746</a>.
</div>
<div id="ref-schaeferBandTeilElektrodynamik1949" class="csl-entry" role="listitem">
Schaefer, Clemens. 1949. <span>“<span>Band 3, Teil 1 Elektrodynamik und Optik</span>.”</span> In <em><span>Band 3, Teil 1 Elektrodynamik und Optik</span></em>. De Gruyter. <a href="https://doi.org/10.1515/9783111421698">https://doi.org/10.1515/9783111421698</a>.
</div>
<div id="ref-schrodingerUndulatoryTheoryMechanics1926" class="csl-entry" role="listitem">
Schrödinger, E. 1926. <span>“An <span>Undulatory Theory</span> of the <span>Mechanics</span> of <span>Atoms</span> and <span>Molecules</span>.”</span> <em>Physical Review</em> 28 (6): 1049–70. <a href="https://doi.org/10.1103/PhysRev.28.1049">https://doi.org/10.1103/PhysRev.28.1049</a>.
</div>
<div id="ref-sommerfeldAtomicStructureSpectral1923" class="csl-entry" role="listitem">
Sommerfeld, Arnold. 1923. <em>Atomic Structure and Spectral Lines</em>. New York, Dutton.
</div>
<div id="ref-stoneEinsteinUnknownInsight2005" class="csl-entry" role="listitem">
Stone, A. Douglas. 2005. <span>“Einstein’s Unknown Insight and the Problem of Quantizing Chaos.”</span> <em>Physics Today</em> 58 (8): 37.
</div>
<div id="ref-straumannFirstSolvayCongress2011" class="csl-entry" role="listitem">
Straumann, Norbert. 2011. <span>“On the First <span>Solvay Congress</span> in 1911.”</span> <em>The European Physical Journal H</em> 36 (3): 379–99. <a href="https://doi.org/10.1140/epjh/e2011-20043-9">https://doi.org/10.1140/epjh/e2011-20043-9</a>.
</div>
<div id="ref-swansonOstrogradskiInstabilityWhy2022" class="csl-entry" role="listitem">
Swanson, Noel. 2022. <span>“On the <span>Ostrogradski Instability</span>; or, <span>Why Physics Really Uses Second Derivatives</span>.”</span> <em>The British Journal for the Philosophy of Science</em> 73 (1): 23–46. <a href="https://doi.org/10.1093/bjps/axz042">https://doi.org/10.1093/bjps/axz042</a>.
</div>
<div id="ref-tegmarkDimensionalitySpacetime1997" class="csl-entry" role="listitem">
Tegmark, Max. 1997. <span>“On the Dimensionality of Spacetime.”</span> <em>Classical and Quantum Gravity</em> 14 (4): L69.
</div>
<div id="ref-terhaarAdiabaticInvarianceAdiabatic1966" class="csl-entry" role="listitem">
Ter Haar, D. 1966. <span>“Adiabatic Invariance and Adiabatic Invariants.”</span> <em>Contemporary Physics</em> 7 (6): 447–58. <a href="https://doi.org/10.1080/00107516608205487">https://doi.org/10.1080/00107516608205487</a>.
</div>
<div id="ref-wellsAdiabaticInvarianceAction2007" class="csl-entry" role="listitem">
Wells, Clive G, and Stephen T C Siklos. 2007. <span>“The Adiabatic Invariance of the Action Variable in Classical Dynamics.”</span> <em>European Journal of Physics</em> 28 (1): 105–12. <a href="https://doi.org/10.1088/0143-0807/28/1/011">https://doi.org/10.1088/0143-0807/28/1/011</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/yuxi-liu-wired\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">Everything ©<a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block">Yuxi on the Wired</span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block"><a href="../../../sitemap.xml">sitemap</a></span></p>
</div>
  </div>
</footer>




</body></html>